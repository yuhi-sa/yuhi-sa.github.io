<!DOCTYPE html>
<html lang="en"
  dir="ltr">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<meta name="robots" content="index,follow">


<meta property="og:title" content="Reparameterization trick | tomato blog">
<meta property="og:description" content="勉強したことなどをメモしています">
<meta property="og:image" content="https://yuhi-sa.github.io/ogp.jpeg">
<meta property="og:url" content="http://localhost:1313/en/posts/20220206_repa/1/">
<meta name="twitter:card" content="summary_large_image">

<title>Reparameterization trick | tomato blog</title>


<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">



  <link rel="stylesheet" href="/css/main.css">

  <link rel="stylesheet" href="/css/syntax.css">


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.min.js"></script>


<script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\(', '\)']]
    }
  };
</script>


<script src="/js/copy-code.js"></script>

</head>

<body>
  <header>
    <div class="container">
  
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
      <div class="navbar-brand" style="padding-left: 10px;">tomato blog</div>
      <button class="navbar-toggler ml-auto" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">  
        <ul class="navbar-nav ml-auto">
  <li class="nav-item">
    <a ZgotmplZ href="http://localhost:1313/" class="nav-link"> Blog </a>
  </li>
  <li class="nav-item">
    <a ZgotmplZ href="http://localhost:1313/tags" class="nav-link"> Tags </a>
  </li>
  <li class="nav-item">
    <a ZgotmplZ href="http://localhost:1313/posts/about" class="nav-link"> About </a>
  </li>
  <li class="nav-item">
    <a ZgotmplZ href="http://localhost:1313/posts/privacy_policy" class="nav-link"> Privacy policy </a>
  </li>
        </ul>
      </div>
    </nav>

</div>

  
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-LN6QP6VVM3"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-LN6QP6VVM3');
  </script>



  
  <script data-ad-client="ca-pub-9558545098866170" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>



  </header>
  <main>
    
<div style="max-width: 80%; margin: 0 auto;">
  
  
  <h1 id="reparameterization-trick">Reparameterization trick</h1>
<p>When variables are sampled from a probability distribution, they become random variables, and differentiation cannot be performed, making it impossible to perform calculations using backpropagation. To solve this problem, Kingma et al. introduced the technique called the reparameterization trick.</p>
<p>The reparameterization trick performs the same sampling by partitioning and combining the random numbers that are independent of the parameters and the parameters of the probability distribution from which they are sampled. For example, let $z$ be a variable sampled from a normal distribution $\mathcal{N}$ with mean $\mu$ and variance $\sigma$ as parameters:</p>
<p>$$z \sim \mathcal{N}(\mu, \sigma^2)$$</p>
<p>It can be transformed using random noise $\epsilon$ as follows:</p>
<p>$$z = \mu + \sigma \odot \epsilon$$</p>
<p>$$\epsilon \sim \mathcal{N}(0,1) $$</p>
<p>This makes $z$ a deterministic value with respect to $\mu$ and $\sigma$, making it differentiable.</p>
<h2 id="sampling-using-the-reparameterization-trick-in-pytorch">Sampling using the Reparameterization Trick in PyTorch</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">m = Normal(*params)
</span></span><span class="line"><span class="cl">z = m.rsample()
</span></span></code></pre></div><p>The probability distributions that can use sampling using the reparameterization trick are those that have the value True for:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">m.has_rsample
</span></span></code></pre></div><h2 id="references">References</h2>
<ul>
<li><a href="https://arxiv.org/abs/1312.6114">D. P. Kingma and M. Welling, “Auto-encoding variational bayes”, 2013.</a></li>
<li><a href="https://www.renom.jp/ja/notebooks/tutorial/generative-model/VAE/notebook.html">ReNom, 変分オートエンコーダ</a></li>
</ul>
</div>

  <div>
    <div>Tags:</div>
    <ul>
        <li><a href="/en/tags/machinelearning/">MachineLearning</a></li>
    </ul>
  </div>

<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
      <li class="breadcrumb-item"><a href="/en/">Home</a></li>
      
        
        
        <li class="breadcrumb-item active" aria-current="page">Reparameterization trick</li>
      
    </ol>
  </nav>
  

  </main>
  <footer>
    <div class="container" style="text-align: center;">
  <p>Copyright © 2025. All rights reserved.</p>
</div>

  </footer>
  
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">



  <link rel="stylesheet" href="/css/main.css">

  <link rel="stylesheet" href="/css/syntax.css">

  
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.min.js"></script>


<script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\(', '\)']]
    }
  };
</script>


<script src="/js/copy-code.js"></script>
</body>

</html>
