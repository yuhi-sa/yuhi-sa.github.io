<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>Reparameterization trick | tomato blog</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM"
      crossorigin="anonymous" rel="stylesheet">



  <link rel="stylesheet" href="/css/main.min.27c458cc04c39baa2c5494bd8658476214e123dabef2ece2efc840640fe0fc49.css" integrity="sha256-J8RYzATDm6osVJS9hlhHYhThI9q&#43;8uzi78hAZA/g/Ek=" crossorigin="anonymous">

  <link rel="stylesheet" href="/css/syntax.min.aa0332253f313dc48905008b4ab314155e5a13302588d25bcf4949f7c1abdde0.css" integrity="sha256-qgMyJT8xPcSJBQCLSrMUFV5aEzAliNJbz0lJ98Gr3eA=" crossorigin="anonymous">


<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">


<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>


<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>


<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>


<script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']]
    }
  };
</script>


</head>
<body>
  <header>
    
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        
        <div class="navbar-brand">tomato blog</div>
        
        <ul class="navbar-nav ml-auto">
      <li class="nav-item">
        <a ZgotmplZ href="https://yuhi-sa.github.io/" class="nav-link"> Blog </a>
      </li>
      <li class="nav-item">
        <a ZgotmplZ href="https://yuhi-sa.github.io/tags" class="nav-link"> Tags </a>
      </li>
      <li class="nav-item">
        <a ZgotmplZ href="https://yuhi-sa.github.io/posts/about" class="nav-link"> About </a>
      </li>
      <li class="nav-item">
        <a ZgotmplZ href="https://yuhi-sa.github.io/posts/privacy_policy" class="nav-link"> privacy policy </a>
      </li>
        </ul>
      </div>
    </nav>


  
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-LN6QP6VVM3"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-LN6QP6VVM3');
  </script>


<script data-ad-client="ca-pub-9558545098866170" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


  </header>
  <main>
    
  <h1>Reparameterization trick</h1>

  
  
  <time datetime="2022-02-06T15:00:23&#43;09:00">February 6, 2022</time>

  <h1 id="reparameterization-trick">Reparameterization trick</h1>
<p>When variables are sampled from a probability distribution, they become random variables, and differentiation cannot be performed, making it impossible to perform calculations using backpropagation. To solve this problem, Kingma et al. introduced the technique called the reparameterization trick.</p>
<p>The reparameterization trick performs the same sampling by partitioning and combining the random numbers that are independent of the parameters and the parameters of the probability distribution from which they are sampled. For example, let $z$ be a variable sampled from a normal distribution $\mathcal{N}$ with mean $\mu$ and variance $\sigma$ as parameters:</p>
<p>$$z \sim \mathcal{N}(\mu, \sigma^2)$$</p>
<p>It can be transformed using random noise $\epsilon$ as follows:</p>
<p>$$z = \mu + \sigma \odot \epsilon$$</p>
<p>$$\epsilon \sim \mathcal{N}(0,1) $$</p>
<p>This makes $z$ a deterministic value with respect to $\mu$ and $\sigma$, making it differentiable.</p>
<h1 id="sampling-using-the-reparameterization-trick-in-pytorch">Sampling using the Reparameterization Trick in PyTorch</h1>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">m = Normal(*params)
</span></span><span class="line"><span class="cl">z = m.rsample()
</span></span></code></pre></div><p>The probability distributions that can use sampling using the reparameterization trick are those that have the value True for:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">m.has_rsample
</span></span></code></pre></div><h1 id="references">References</h1>
<ul>
<li><a href="https://arxiv.org/abs/1312.6114">D. P. Kingma and M. Welling, “Auto-encoding variational bayes”, 2013.</a></li>
<li><a href="https://www.renom.jp/ja/notebooks/tutorial/generative-model/VAE/notebook.html">ReNom, 変分オートエンコーダ</a></li>
</ul>
  
  <div>
    <div>Tags:</div>
    <ul>
        <li><a href="/en/tags/machine-learning/">Machine Learning</a></li>
    </ul>
  </div>


  </main>
  <footer>
    <p>Copyright 2023. All rights reserved.</p>

  </footer>
</body>
</html>
