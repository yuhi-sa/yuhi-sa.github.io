<!doctype html><html lang=en dir=ltr data-theme=light><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=theme-color content="#e74c3c"><meta name=format-detection content="telephone=no"><meta name=robots content="index,follow"><meta name=description content="A comprehensive guide to window functions for FFT analysis and Power Spectral Density estimation using Welch's method, with full Python implementations."><meta name=keywords content="window function,power spectral density,PSD,spectral leakage,Welch method,FFT,Python,Hann window,Hamming window,signal processing"><meta name=author content="yuhi-sa"><link rel=canonical href=https://yuhi-sa.github.io/en/posts/20260228_fft_window_psd/1/><meta property="og:type" content="article"><meta property="og:title" content="Window Functions and Power Spectral Density (PSD): Theory and Python Implementation"><meta property="og:description" content="A comprehensive guide to window functions for FFT analysis and Power Spectral Density estimation using Welch's method, with full Python implementations."><meta property="og:url" content="https://yuhi-sa.github.io/en/posts/20260228_fft_window_psd/1/"><meta property="og:site_name" content="tomato blog"><meta property="og:locale" content="en"><meta property="og:image" content="https://yuhi-sa.github.io/ogp.jpeg"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta property="article:published_time" content="2026-02-28T10:00:00+09:00"><meta property="article:modified_time" content="2026-02-28T19:16:58+09:00"><meta property="article:tag" content="Signal Processing"><meta property="article:tag" content="Python"><meta property="article:section" content="posts"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="Window Functions and Power Spectral Density (PSD): Theory and Python Implementation"><meta name=twitter:description content="A comprehensive guide to window functions for FFT analysis and Power Spectral Density estimation using Welch's method, with full Python implementations."><meta name=twitter:image content="https://yuhi-sa.github.io/ogp.jpeg"><title>Window Functions and Power Spectral Density (PSD): Theory and Python Implementation | tomato blog</title><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preconnect href=https://cdn.jsdelivr.net crossorigin><link rel=preconnect href=https://pagead2.googlesyndication.com crossorigin><link rel=dns-prefetch href=https://pagead2.googlesyndication.com><link rel=icon href=https://yuhi-sa.github.io/favicon.ico><link rel=alternate hreflang=ja href=https://yuhi-sa.github.io/posts/20260228_fft_window_psd/1/><link rel=alternate hreflang=en href=https://yuhi-sa.github.io/en/posts/20260228_fft_window_psd/1/><link rel=alternate hreflang=x-default href=https://yuhi-sa.github.io/en/posts/20260228_fft_window_psd/1/><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Window Functions and Power Spectral Density (PSD): Theory and Python Implementation","description":"A comprehensive guide to window functions for FFT analysis and Power Spectral Density estimation using Welch\u0027s method, with full Python implementations.","author":{"@type":"Person","name":"yuhi-sa","url":"https:\/\/yuhi-sa.github.io\/"},"publisher":{"@type":"Organization","name":"tomato blog","logo":{"@type":"ImageObject","url":"https:\/\/yuhi-sa.github.io\/ogp.jpeg"},"url":"https:\/\/yuhi-sa.github.io\/"},"datePublished":"2026-02-28T10:00:00\u002b09:00","dateModified":"2026-02-28T19:16:58\u002b09:00","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/yuhi-sa.github.io\/en\/posts\/20260228_fft_window_psd\/1\/"},"url":"https:\/\/yuhi-sa.github.io\/en\/posts\/20260228_fft_window_psd\/1\/","wordCount":1926,"keywords":["Signal Processing","Python"],"articleSection":"Posts","inLanguage":"en","timeRequired":"PT10M"}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"tomato blog","item":"https:\/\/yuhi-sa.github.io\/en\/"},{"@type":"ListItem","position":2,"name":"Posts","item":"https:\/\/yuhi-sa.github.io\/en\/posts\/"},{"@type":"ListItem","position":3,"name":"Window Functions and Power Spectral Density (PSD): Theory and Python Implementation"}]}</script><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin=anonymous referrerpolicy=no-referrer><link href=https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css rel=stylesheet integrity=sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH crossorigin=anonymous><link rel=stylesheet href=/css/variables.min.72a177faa7b12de55dcc39c4ab6b6392116718d5e2735dab0214511354ecb973.css integrity="sha256-cqF3+qexLeVdzDnEq2tjkhFnGNXic12rAhRRE1TsuXM=" crossorigin=anonymous><link rel=stylesheet href=/css/main.min.403a82b29e94ee6e7a39204b5082cdf8b4966cfb44115390da7d8867a5006acd.css integrity="sha256-QDqCsp6U7m56OSBLUILN+LSWbPtEEVOQ2n2IZ6UAas0=" crossorigin=anonymous><link rel=stylesheet href=/css/syntax.min.e379066489e20d5433ca35ac1f468fd9e8859705a62d77a79bb7379ac3613848.css integrity="sha256-43kGZIniDVQzyjWsH0aP2eiFlwWmLXenm7c3msNhOEg=" crossorigin=anonymous><style>body{font-family:-apple-system,BlinkMacSystemFont,inter,segoe ui,Roboto,sans-serif;line-height:1.5;color:#000;background:#fff}[data-theme=dark] body{color:#fff;background:#000}.container{max-width:768px;margin:0 auto;padding:0 1rem}</style><script src=https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js integrity=sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz crossorigin=anonymous defer></script><script src=/js/dark-mode.min.3e457dc8346f064bee795e6f9b73e1516dcd059e750c521fe4b445f9ea9a7821.js integrity="sha256-PkV9yDRvBkvueV5vm3PhUW3NBZ51DFIf5LRF+eqaeCE=" defer></script><script>window.addEventListener("load",function(){const e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-LN6QP6VVM3",document.head.appendChild(e),e.onload=function(){window.dataLayer=window.dataLayer||[];function e(){dataLayer.push(arguments)}e("js",new Date),e("config","G-LN6QP6VVM3")}})</script><script>window.MathJax={tex:{inlineMath:[["\\(","\\)"]],displayMath:[["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre","code"],ignoreHtmlClass:"tex2jax_ignore",processHtmlClass:"tex2jax_process"}}</script><script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js id=mathjax-script async></script></head><body itemscope itemtype=https://schema.org/WebPage class=theme-tomatohugo><a href=#main-content class="skip-link sr-only sr-only-focusable" aria-label="Skip to main content">Skip to main content</a><header role=banner class=site-header><nav class="navbar navbar-expand-lg navbar-light bg-light" role=navigation aria-label="Main navigation"><div class=container><a class=navbar-brand href=https://yuhi-sa.github.io/ aria-label="Return to tomato blog homepage">tomato blog
</a><button class="navbar-toggler d-lg-none" type=button data-bs-toggle=collapse data-bs-target=#navbarNav aria-controls=navbarNav aria-expanded=false aria-label="Toggle navigation menu">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarNav><ul class="navbar-nav ms-auto" role=menubar><li class=nav-item role=none><a class=nav-link href=https://yuhi-sa.github.io/en/ role=menuitem aria-label="Navigate to Blog">Blog</a></li><li class=nav-item role=none><a class=nav-link href=https://yuhi-sa.github.io/en/tags/ role=menuitem aria-label="Navigate to Tags">Tags</a></li><li class=nav-item role=none><a class=nav-link href=https://yuhi-sa.github.io/en/posts/about/ role=menuitem aria-label="Navigate to About">About</a></li><li class=nav-item role=none><a class=nav-link href=https://yuhi-sa.github.io/en/posts/privacy_policy/ role=menuitem aria-label="Navigate to Privacy policy">Privacy policy</a></li><li class=nav-item role=none><button id=darkModeToggle class="nav-link btn btn-link border-0" type=button role=menuitem aria-label="Toggle dark mode" title="Switch between light and dark themes">
<i class="fas fa-moon" id=darkModeIcon aria-hidden=true></i>
<span class="d-lg-none ms-2">ダークモード</span></button></li></ul></div></div></nav><script data-ad-client=ca-pub-9558545098866170 async crossorigin=anonymous src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></header><main id=main-content role=main class=site-main aria-label="Main content"><div class="container mt-4"><div class="row justify-content-center"><div class=col-lg-8><article itemscope itemtype=https://schema.org/Article><header class=article-header><h1 itemprop=headline>Window Functions and Power Spectral Density (PSD): Theory and Python Implementation</h1><p class="lead article-description" itemprop=description>A comprehensive guide to window functions for FFT analysis and Power Spectral Density estimation using Welch's method, with full Python implementations.</p><div class=article-meta><time datetime=2026-02-28T10:00:00+09:00 itemprop=datePublished><i class="far fa-calendar-alt me-1" aria-hidden=true></i>
February 28, 2026
</time><time datetime=2026-02-28T19:16:58+09:00 itemprop=dateModified class=ms-3><i class="far fa-edit me-1" aria-hidden=true></i>
Updated
February 28, 2026
</time><span aria-label="Reading time" class=ms-3><i class="far fa-clock me-1" aria-hidden=true></i>
10 min read</span></div><div class=article-tags role=group aria-label="Article tags"><a href=/en/tags/signal-processing/ class="badge badge-custom text-decoration-none me-1" rel=tag itemprop=keywords>Signal Processing
</a><a href=/en/tags/python/ class="badge badge-custom text-decoration-none me-1" rel=tag itemprop=keywords>Python</a></div></header><div class=article-content itemprop=articleBody><h2 id=introduction>Introduction</h2><p>In the <a href=https://yuhi-sa.github.io/en/posts/20260225_fft/1/>FFT article</a>, we covered the DFT algorithm and basic frequency analysis. We briefly touched on using the Hann window to mitigate spectral leakage, but there are many types of window functions, and choosing the right one for the task at hand is essential.</p><p>Moreover, the amplitude spectrum from FFT shows &ldquo;how much amplitude exists at each frequency,&rdquo; but in practice we often need to know the <strong>signal power per unit frequency</strong>. This quantity is the <strong>Power Spectral Density (PSD)</strong>.</p><p>This article dives deeper into the mathematics behind spectral leakage, compares the characteristics of major window functions, and implements PSD estimation via Welch&rsquo;s method in Python.</p><h2 id=mathematical-understanding-of-spectral-leakage>Mathematical Understanding of Spectral Leakage</h2><h3 id=finite-length-signals-and-the-rectangular-window>Finite-Length Signals and the Rectangular Window</h3><p>In practice, we can never record a signal for infinite duration. We acquire a finite-length signal \(x[n]\) (\(n = 0, 1, \ldots, N-1\)). Mathematically, this is equivalent to multiplying an infinite-length signal \(x_\infty[n]\) by a <strong>rectangular window</strong> \(w_R[n]\).</p>\[x[n] = x_\infty[n] \cdot w_R[n] \tag{1}\]<p>The rectangular window is defined as:</p>\[w_R[n] = \begin{cases} 1, & 0 \leq n \leq N-1 \\ 0, & \text{otherwise} \end{cases} \tag{2}\]<h3 id=effect-in-the-frequency-domain>Effect in the Frequency Domain</h3><p>Multiplication in the time domain corresponds to <strong>convolution</strong> in the frequency domain.</p>\[X(f) = X_\infty(f) * W_R(f) \tag{3}\]<p>The Fourier transform of the rectangular window is the Dirichlet kernel, which in continuous approximation is proportional to the sinc function.</p>\[W_R(f) \approx N \cdot \text{sinc}(Nf) \cdot e^{-j\pi f(N-1)} \tag{4}\]<p>This sinc function has a broad mainlobe and slowly decaying sidelobes. Through the convolution in Eq. \((3)\), a spectrum that should be concentrated at a single frequency spreads to adjacent frequencies via these sidelobes. This is the mathematical origin of spectral leakage.</p><h3 id=mainlobe-and-sidelobes>Mainlobe and Sidelobes</h3><p>The frequency characteristics of a window function are described by two key elements:</p><ul><li><strong>Mainlobe</strong>: The primary peak around the center frequency. A narrower mainlobe yields higher frequency resolution.</li><li><strong>Sidelobes</strong>: Secondary peaks on either side of the mainlobe. Lower sidelobe levels mean less spectral leakage.</li></ul><p>The rectangular window has a peak sidelobe level of only \(-13\) dB, which means weak signal components near a strong tone can be buried under the sidelobes. By choosing different window functions, we can control this tradeoff.</p><h2 id=major-window-functions>Major Window Functions</h2><p>Below are the mathematical definitions of commonly used window functions, all of length \(N\).</p><h3 id=rectangular-window>Rectangular Window</h3>\[w[n] = 1, \quad 0 \leq n \leq N-1 \tag{5}\]<p>Equivalent to applying no window. It has the narrowest mainlobe and therefore the best frequency resolution, but the sidelobes are large and spectral leakage is severe.</p><h3 id=hann-window>Hann Window</h3>\[w[n] = 0.5\left(1 - \cos\left(\frac{2\pi n}{N-1}\right)\right) \tag{6}\]<p>A cosine-based window that tapers to zero at both ends. The sidelobe decay rate of \(-18\) dB/oct is fast, making it the most widely used general-purpose window.</p><h3 id=hamming-window>Hamming Window</h3>\[w[n] = 0.54 - 0.46\cos\left(\frac{2\pi n}{N-1}\right) \tag{7}\]<p>Similar to the Hann window, but the endpoints do not reach zero (they have a value of approximately 0.08). The first sidelobe is suppressed to \(-43\) dB, but the far sidelobe decay is only \(-6\) dB/oct, slower than the Hann window.</p><h3 id=blackman-window>Blackman Window</h3>\[w[n] = 0.42 - 0.5\cos\left(\frac{2\pi n}{N-1}\right) + 0.08\cos\left(\frac{4\pi n}{N-1}\right) \tag{8}\]<p>Composed of three cosine terms. The first sidelobe is extremely low at \(-58\) dB, making it suitable for high dynamic range analysis, but the wider mainlobe reduces frequency resolution.</p><h3 id=kaiser-window>Kaiser Window</h3>\[w[n] = \frac{I_0\left(\beta\sqrt{1 - \left(\frac{2n}{N-1} - 1\right)^2}\right)}{I_0(\beta)} \tag{9}\]<p>Here \(I_0\) is the zeroth-order modified Bessel function of the first kind, and \(\beta\) is the shape parameter. By adjusting \(\beta\), you can continuously control the tradeoff between mainlobe width and sidelobe suppression. \(\beta = 0\) gives the rectangular window, and \(\beta \approx 5.4\) approximates the Hamming window.</p><h3 id=window-function-characteristics-comparison>Window Function Characteristics Comparison</h3><table><thead><tr><th>Window</th><th>Mainlobe Width</th><th>Peak Sidelobe [dB]</th><th>Sidelobe Decay</th><th>ENBW (bins)</th></tr></thead><tbody><tr><td>Rectangular</td><td>2 bins</td><td>-13</td><td>-6 dB/oct</td><td>1.00</td></tr><tr><td>Hann</td><td>4 bins</td><td>-32</td><td>-18 dB/oct</td><td>1.50</td></tr><tr><td>Hamming</td><td>4 bins</td><td>-43</td><td>-6 dB/oct</td><td>1.36</td></tr><tr><td>Blackman</td><td>6 bins</td><td>-58</td><td>-18 dB/oct</td><td>1.73</td></tr><tr><td>Kaiser (β=6)</td><td>Variable</td><td>Variable</td><td>Variable</td><td>Variable</td></tr></tbody></table><p>ENBW (Equivalent Noise Bandwidth) indicates how many frequency bins of bandwidth a window effectively has for white noise. A larger value means more noise influence on the estimate.</p><h2 id=window-functions-frequency-response-comparison-python>Window Functions: Frequency Response Comparison (Python)</h2><p>Let us generate all window functions and compare their frequency responses on a dB scale.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>scipy.signal.windows</span> <span class=kn>import</span> <span class=n>hann</span><span class=p>,</span> <span class=n>hamming</span><span class=p>,</span> <span class=n>blackman</span><span class=p>,</span> <span class=n>kaiser</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Window length</span>
</span></span><span class=line><span class=cl><span class=n>N</span> <span class=o>=</span> <span class=mi>64</span>
</span></span><span class=line><span class=cl><span class=c1># FFT size (zero-padded for interpolation)</span>
</span></span><span class=line><span class=cl><span class=n>N_fft</span> <span class=o>=</span> <span class=mi>4096</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Generate each window function</span>
</span></span><span class=line><span class=cl><span class=n>windows</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;Rectangular&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ones</span><span class=p>(</span><span class=n>N</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;Hann&#39;</span><span class=p>:</span> <span class=n>hann</span><span class=p>(</span><span class=n>N</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;Hamming&#39;</span><span class=p>:</span> <span class=n>hamming</span><span class=p>(</span><span class=n>N</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;Blackman&#39;</span><span class=p>:</span> <span class=n>blackman</span><span class=p>(</span><span class=n>N</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;Kaiser (β=6)&#39;</span><span class=p>:</span> <span class=n>kaiser</span><span class=p>(</span><span class=n>N</span><span class=p>,</span> <span class=n>beta</span><span class=o>=</span><span class=mi>6</span><span class=p>),</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Compute and plot frequency responses</span>
</span></span><span class=line><span class=cl><span class=n>fig</span><span class=p>,</span> <span class=n>ax</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>6</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>name</span><span class=p>,</span> <span class=n>w</span> <span class=ow>in</span> <span class=n>windows</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=c1># Compute frequency response via FFT</span>
</span></span><span class=line><span class=cl>    <span class=n>W</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>fft</span><span class=o>.</span><span class=n>fft</span><span class=p>(</span><span class=n>w</span><span class=p>,</span> <span class=n>n</span><span class=o>=</span><span class=n>N_fft</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>W_shift</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>fft</span><span class=o>.</span><span class=n>fftshift</span><span class=p>(</span><span class=n>W</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># Normalize (mainlobe peak at 0 dB)</span>
</span></span><span class=line><span class=cl>    <span class=n>W_dB</span> <span class=o>=</span> <span class=mi>20</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>log10</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>maximum</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>W_shift</span><span class=p>)</span> <span class=o>/</span> <span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>W_shift</span><span class=p>)</span><span class=o>.</span><span class=n>max</span><span class=p>(),</span> <span class=mf>1e-12</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=c1># Frequency axis (in bins)</span>
</span></span><span class=line><span class=cl>    <span class=n>freq_bins</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=o>-</span><span class=n>N</span> <span class=o>/</span> <span class=mi>2</span><span class=p>,</span> <span class=n>N</span> <span class=o>/</span> <span class=mi>2</span><span class=p>,</span> <span class=n>N_fft</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>ax</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>freq_bins</span><span class=p>,</span> <span class=n>W_dB</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=n>name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>set_xlim</span><span class=p>(</span><span class=o>-</span><span class=mi>15</span><span class=p>,</span> <span class=mi>15</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>set_ylim</span><span class=p>(</span><span class=o>-</span><span class=mi>120</span><span class=p>,</span> <span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;Frequency [bins]&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;Magnitude [dB]&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;Window Functions: Frequency Response Comparison&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>legend</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></div><p>This plot visually confirms that the rectangular window has the narrowest mainlobe but the largest sidelobes, while the Blackman window has very low sidelobes at the cost of a wider mainlobe.</p><h2 id=power-spectral-density-psd>Power Spectral Density (PSD)</h2><h3 id=definition-and-physical-meaning>Definition and Physical Meaning</h3><p>The amplitude spectrum \(|X[k]|\) shows the signal amplitude at each frequency bin, but it depends on the FFT length \(N\) and sampling rate \(f_s\), making direct comparison between spectra obtained under different conditions difficult.</p><p><strong>Power Spectral Density (PSD)</strong> is defined as signal power per unit frequency and shows how a signal&rsquo;s power is distributed across the frequency axis. Its unit is \(\text{V}^2/\text{Hz}\) (or the appropriate physical unit squared per Hz).</p><p>An important property of PSD is that integrating it over all frequencies yields the total signal power (variance).</p>\[\int_0^{f_s/2} S_{xx}(f) \, df = \sigma_x^2 \tag{10}\]<h3 id=difference-from-amplitude-spectrum>Difference from Amplitude Spectrum</h3><table><thead><tr><th>Property</th><th>Amplitude Spectrum</th><th>Power Spectral Density</th></tr></thead><tbody><tr><td>Value</td><td>\(\|X[k]\|\)</td><td>\(S_{xx}(f)\)</td></tr><tr><td>Unit</td><td>V (signal unit)</td><td>\(\text{V}^2/\text{Hz}\)</td></tr><tr><td>N dependency</td><td>Proportional to N</td><td>Independent of N</td></tr><tr><td>Use case</td><td>Check amplitude at a frequency</td><td>Quantitative power distribution</td></tr></tbody></table><h2 id=psd-estimation-methods>PSD Estimation Methods</h2><h3 id=periodogram>Periodogram</h3><p>The simplest PSD estimator is the <strong>periodogram</strong>, computed directly from the FFT result.</p>\[\hat{S}_{xx}[k] = \frac{|X[k]|^2}{N \cdot f_s \cdot U} \tag{11}\]<p>Here \(X[k]\) is the DFT of the windowed signal and \(U = \frac{1}{N}\sum_{n=0}^{N-1} w[n]^2\) is the window power correction factor (\(U=1\) for the rectangular window). The periodogram is asymptotically unbiased (unbiased as \(N \to \infty\)), but suffers from <strong>high variance</strong>. Even increasing the data length \(N\) does not reduce the variance, so the estimate fluctuates significantly due to noise.</p><h3 id=welchs-method>Welch&rsquo;s Method</h3><p><strong>Welch&rsquo;s method</strong> (1967) is a practical technique for reducing periodogram variance. The procedure is:</p><ol><li>Divide the signal into segments of length \(L\) with overlap</li><li>Apply a window function \(w[n]\) to each segment</li><li>Compute the modified periodogram for each segment</li><li>Average all segment results</li></ol><p>The modified periodogram of the \(i\)-th segment is defined as:</p>\[\hat{S}_{xx}^{(i)}[k] = \frac{1}{L \cdot f_s \cdot U} \left| \sum_{n=0}^{L-1} x_i[n] \cdot w[n] \cdot e^{-j2\pi kn/L} \right|^2 \tag{12}\]<p>where \(U\) is the window power normalization factor:</p>\[U = \frac{1}{L}\sum_{n=0}^{L-1} w[n]^2 \tag{13}\]<p>Averaging over \(K\) segments gives the Welch PSD estimate:</p>\[\hat{S}_{xx}^{\text{Welch}}[k] = \frac{1}{K}\sum_{i=1}^{K} \hat{S}_{xx}^{(i)}[k] \tag{14}\]<p><strong>Overlap</strong> is used to make effective use of the data and increase the number of segments available for averaging. A 50% overlap is typical. Excessive overlap increases inter-segment correlation and diminishes the averaging benefit.</p><p><strong>Segment length tradeoff</strong>: longer segments improve frequency resolution but yield fewer segments for averaging (higher variance). Shorter segments reduce variance but degrade frequency resolution.</p><h2 id=practical-psd-estimation-in-python>Practical PSD Estimation in Python</h2><p>We generate a test signal with two sinusoids (50 Hz and 120 Hz) plus white noise, then compare PSD estimates from the periodogram and Welch&rsquo;s method.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>scipy.signal</span> <span class=kn>import</span> <span class=n>welch</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>scipy.signal.windows</span> <span class=kn>import</span> <span class=n>hann</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># --- Generate test signal ---</span>
</span></span><span class=line><span class=cl><span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>fs</span> <span class=o>=</span> <span class=mi>1000</span>            <span class=c1># Sampling frequency [Hz]</span>
</span></span><span class=line><span class=cl><span class=n>T</span> <span class=o>=</span> <span class=mf>4.0</span>              <span class=c1># Signal duration [s]</span>
</span></span><span class=line><span class=cl><span class=n>t</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>T</span><span class=p>,</span> <span class=mi>1</span><span class=o>/</span><span class=n>fs</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>N_total</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 50 Hz (amplitude 1.0) and 120 Hz (amplitude 0.5) + white noise</span>
</span></span><span class=line><span class=cl><span class=n>signal</span> <span class=o>=</span> <span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span> <span class=o>*</span> <span class=mi>50</span> <span class=o>*</span> <span class=n>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=o>+</span> <span class=mf>0.5</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span> <span class=o>*</span> <span class=mi>120</span> <span class=o>*</span> <span class=n>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=o>+</span> <span class=mf>0.8</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=n>N_total</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># --- 1. Periodogram (manual implementation) ---</span>
</span></span><span class=line><span class=cl><span class=n>window</span> <span class=o>=</span> <span class=n>hann</span><span class=p>(</span><span class=n>N_total</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>X</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>fft</span><span class=o>.</span><span class=n>fft</span><span class=p>(</span><span class=n>signal</span> <span class=o>*</span> <span class=n>window</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>freqs_periodo</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>fft</span><span class=o>.</span><span class=n>fftfreq</span><span class=p>(</span><span class=n>N_total</span><span class=p>,</span> <span class=mi>1</span><span class=o>/</span><span class=n>fs</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># Window power correction</span>
</span></span><span class=line><span class=cl><span class=n>U</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>window</span><span class=o>**</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># One-sided periodogram</span>
</span></span><span class=line><span class=cl><span class=n>psd_periodo</span> <span class=o>=</span> <span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>X</span><span class=p>[:</span><span class=n>N_total</span><span class=o>//</span><span class=mi>2</span><span class=p>])</span><span class=o>**</span><span class=mi>2</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=n>N_total</span> <span class=o>*</span> <span class=n>fs</span> <span class=o>*</span> <span class=n>U</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>psd_periodo</span><span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>*=</span> <span class=mi>2</span>  <span class=c1># Double all bins except DC and Nyquist</span>
</span></span><span class=line><span class=cl><span class=n>freqs_periodo</span> <span class=o>=</span> <span class=n>freqs_periodo</span><span class=p>[:</span><span class=n>N_total</span><span class=o>//</span><span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># --- 2. Welch&#39;s method (scipy.signal.welch) ---</span>
</span></span><span class=line><span class=cl><span class=n>freqs_welch</span><span class=p>,</span> <span class=n>psd_welch</span> <span class=o>=</span> <span class=n>welch</span><span class=p>(</span><span class=n>signal</span><span class=p>,</span> <span class=n>fs</span><span class=o>=</span><span class=n>fs</span><span class=p>,</span> <span class=n>window</span><span class=o>=</span><span class=s1>&#39;hann&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                <span class=n>nperseg</span><span class=o>=</span><span class=mi>512</span><span class=p>,</span> <span class=n>noverlap</span><span class=o>=</span><span class=mi>256</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># --- 3. Window function comparison ---</span>
</span></span><span class=line><span class=cl><span class=n>windows_list</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;hann&#39;</span><span class=p>,</span> <span class=s1>&#39;hamming&#39;</span><span class=p>,</span> <span class=s1>&#39;blackman&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>psd_results</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>win_name</span> <span class=ow>in</span> <span class=n>windows_list</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>f</span><span class=p>,</span> <span class=n>p</span> <span class=o>=</span> <span class=n>welch</span><span class=p>(</span><span class=n>signal</span><span class=p>,</span> <span class=n>fs</span><span class=o>=</span><span class=n>fs</span><span class=p>,</span> <span class=n>window</span><span class=o>=</span><span class=n>win_name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                 <span class=n>nperseg</span><span class=o>=</span><span class=mi>512</span><span class=p>,</span> <span class=n>noverlap</span><span class=o>=</span><span class=mi>256</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>psd_results</span><span class=p>[</span><span class=n>win_name</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>f</span><span class=p>,</span> <span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># --- Plot ---</span>
</span></span><span class=line><span class=cl><span class=n>fig</span><span class=p>,</span> <span class=n>axes</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>12</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># (a) Periodogram vs Welch&#39;s method</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>semilogy</span><span class=p>(</span><span class=n>freqs_periodo</span><span class=p>,</span> <span class=n>psd_periodo</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Periodogram&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>semilogy</span><span class=p>(</span><span class=n>freqs_welch</span><span class=p>,</span> <span class=n>psd_welch</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Welch (nperseg=512)&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;Frequency [Hz]&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;PSD [V²/Hz]&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;Periodogram vs Welch Method&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>legend</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>set_xlim</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>200</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># (b) Welch&#39;s method with different windows</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>win_name</span><span class=p>,</span> <span class=p>(</span><span class=n>f</span><span class=p>,</span> <span class=n>p</span><span class=p>)</span> <span class=ow>in</span> <span class=n>psd_results</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>axes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>semilogy</span><span class=p>(</span><span class=n>f</span><span class=p>,</span> <span class=n>p</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=sa>f</span><span class=s1>&#39;Welch (</span><span class=si>{</span><span class=n>win_name</span><span class=si>}</span><span class=s1>)&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;Frequency [Hz]&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;PSD [V²/Hz]&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;Welch Method: Window Function Comparison&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>legend</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>set_xlim</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>200</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># (c) Input signal waveform</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>t</span><span class=p>[:</span><span class=mi>500</span><span class=p>],</span> <span class=n>signal</span><span class=p>[:</span><span class=mi>500</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;Time [s]&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;Amplitude&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;Input Signal (first 0.5 s)&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></div><p>The periodogram shows large fluctuations in the estimate, whereas Welch&rsquo;s method produces a much smoother result through averaging. The peaks at 50 Hz and 120 Hz are clearly visible, with the 120 Hz peak approximately 1/4 the power of the 50 Hz peak (since the amplitude ratio is 0.5, and power scales as amplitude squared).</p><h2 id=window-function-selection-guidelines>Window Function Selection Guidelines</h2><table><thead><tr><th>Use Case</th><th>Recommended Window</th><th>Reason</th></tr></thead><tbody><tr><td>General-purpose analysis</td><td>Hann</td><td>Good balance of sidelobe suppression and resolution</td></tr><tr><td>Resolving close frequencies</td><td>Rectangular / Kaiser (low β)</td><td>Narrowest mainlobe</td></tr><tr><td>High dynamic range analysis</td><td>Blackman / Kaiser (high β)</td><td>Lowest sidelobes for detecting weak signals</td></tr><tr><td>Hardware / real-time</td><td>Hamming</td><td>Simple computation, non-zero at endpoints</td></tr></tbody></table><p>In practice, it is recommended to start with the Hann window and switch to other windows as needed.</p><h2 id=summary>Summary</h2><ul><li><strong>Spectral leakage</strong> occurs because finite-length signal truncation (rectangular windowing) causes convolution in the frequency domain</li><li><strong>Window functions</strong> control the tradeoff between mainlobe width and sidelobe suppression; options include Hann, Hamming, Blackman, and Kaiser for different purposes</li><li><strong>Power Spectral Density (PSD)</strong> expresses power per unit frequency, enabling comparison across different measurement conditions</li><li>The <strong>periodogram</strong> has high variance, so <strong>Welch&rsquo;s method</strong> with segment averaging is the standard practical estimator</li><li>Window function selection also affects PSD estimation quality, so choosing appropriately for the analysis objective is important</li></ul><h2 id=related-articles>Related Articles</h2><ul><li><a href=https://yuhi-sa.github.io/en/posts/20260225_fft/1/>Fast Fourier Transform (FFT): Algorithm and Python Implementation</a> - Covers the DFT/FFT algorithms and basic frequency analysis that serve as prerequisites for this article.</li><li><a href=https://yuhi-sa.github.io/en/posts/20220206_ema/1/>Frequency Characteristics of the Exponential Moving Average (EMA) Filter</a> - A reference for understanding filter frequency response concepts.</li><li><a href=https://yuhi-sa.github.io/en/posts/20260223_lowpass_filter/1/>Lowpass Filter Design and Comparison</a> - Compares frequency responses of various lowpass filters.</li><li><a href=https://yuhi-sa.github.io/en/posts/20260226_fir_iir/1/>FIR and IIR Filter Comparison</a> - Explains how window functions are used in FIR filter design.</li><li><a href=https://yuhi-sa.github.io/en/posts/20260226_wavelet/1/>Wavelet Transform: Theory and Python Implementation</a> - Covers wavelet analysis for time-frequency localization that FFT/PSD cannot capture.</li><li><a href=https://yuhi-sa.github.io/en/posts/20260225_moving_average/1/>Types and Comparison of Moving Average Filters</a> - Analyzes moving average filter frequency characteristics using FFT.</li><li><a href=https://yuhi-sa.github.io/en/posts/20260223_matplotlib_tips/1/>Matplotlib Practical Tips: Creating Publication-Quality Plots</a> - Techniques for producing publication-quality spectral plots.</li></ul><h2 id=references>References</h2><ul><li>Harris, F. J. (1978). &ldquo;On the Use of Windows for Harmonic Analysis with the Discrete Fourier Transform.&rdquo; <em>Proceedings of the IEEE</em>, 66(1), 51-83.</li><li>Welch, P. D. (1967). &ldquo;The Use of Fast Fourier Transform for the Estimation of Power Spectra.&rdquo; <em>IEEE Transactions on Audio and Electroacoustics</em>, 15(2), 70-73.</li><li>Oppenheim, A. V., & Schafer, R. W. (2009). <em>Discrete-Time Signal Processing</em> (3rd ed.). Prentice Hall.</li><li><a href=https://numpy.org/doc/stable/reference/routines.fft.html>NumPy FFT documentation</a></li><li><a href=https://docs.scipy.org/doc/scipy/reference/signal.html>SciPy Signal Processing documentation</a></li></ul></div><div class="ad-slot in-content my-3"><ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=fluid data-ad-client=ca-pub-9558545098866170></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><footer class=article-footer></footer><meta itemprop=wordCount content="1926"><meta itemprop=url content="https://yuhi-sa.github.io/en/posts/20260228_fft_window_psd/1/"></article><nav class="post-nav mt-5" aria-label="Post navigation"><a href=/en/posts/20260226_svm/1/ class="post-nav__item post-nav__item--prev"><span class="post-nav__label text-muted"><i class="fas fa-arrow-left me-1" aria-hidden=true></i>前の記事
</span><span class=post-nav__title>Support Vector Machines (SVM): Kernel Methods and Nonlinear Classification with Python</span>
</a><a href=/en/posts/20260228_timeseries_anomaly/1/ class="post-nav__item post-nav__item--next"><span class="post-nav__label text-muted">次の記事<i class="fas fa-arrow-right ms-1" aria-hidden=true></i>
</span><span class=post-nav__title>Time-Series Anomaly Detection: From Statistical Methods to Kalman Filter in Python</span></a></nav><section class="related-posts mt-5" aria-label="Related posts"><h2 class=related-posts__title>関連記事</h2><div class=related-posts__grid><article class=related-posts__item><h3 class=related-posts__item-title><a href=/en/posts/20260228_notch_filter/1/>Notch Filter Design and Python Implementation: Removing Power Line Noise</a></h3><div class=card-meta><time datetime=2026-02-28>February 28, 2026</time></div></article><article class=related-posts__item><h3 class=related-posts__item-title><a href=/en/posts/20260228_timeseries_anomaly/1/>Time-Series Anomaly Detection: From Statistical Methods to Kalman Filter in Python</a></h3><div class=card-meta><time datetime=2026-02-28>February 28, 2026</time></div></article><article class=related-posts__item><h3 class=related-posts__item-title><a href=/en/posts/20260226_wavelet/1/>Introduction to Wavelet Transform: Time-Frequency Analysis with Python</a></h3><div class=card-meta><time datetime=2026-02-26>February 26, 2026</time></div></article></div></section><nav class="article-navigation mt-4" aria-label="Article navigation"><a href=/en/posts/ class="btn btn-outline-secondary btn-sm mb-3"><i class="fas fa-arrow-left me-1" aria-hidden=true></i>
Back to posts</a><nav aria-label="Breadcrumb navigation" class=breadcrumb-nav role=navigation><ol class=breadcrumb itemscope itemtype=https://schema.org/BreadcrumbList><li class=breadcrumb-item itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a href=/en/ itemprop=item aria-label="Navigate to homepage"><i class="fas fa-home" aria-hidden=true></i>
<span itemprop=name>tomato blog</span>
</a><meta itemprop=position content="1"></li><li class=breadcrumb-item itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a href=https://yuhi-sa.github.io/en/ itemprop=item aria-label="Navigate to tomato blog"><span itemprop=name>tomato blog</span>
</a><meta itemprop=position content="2"></li><li class=breadcrumb-item itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a href=https://yuhi-sa.github.io/en/posts/ itemprop=item aria-label="Navigate to Posts"><span itemprop=name>Posts</span>
</a><meta itemprop=position content="3"></li><li class="breadcrumb-item active" aria-current=page itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><span itemprop=name>Window Functions and Power Spectral Density (PSD): Theory and Python Implementation</span>
<meta itemprop=position content="4"></li></ol></nav></nav></div></div></div></main><footer role=contentinfo class=site-footer><div class="container pt-4 pb-3" style="border-top:2px solid var(--accent,#e54d2e)"><div class="row justify-content-center"><div class="col-md-8 text-center"><p class="copyright-text text-muted mb-2">&copy; 2026 yuhi-sa. All rights reserved.</p><p class="theme-attribution text-muted small mt-2 mb-0">Powered by
<a href=https://gohugo.io/ target=_blank rel=noopener class=text-decoration-none>Hugo</a>
with
<a href=https://github.com/yuhi-sa/tomatohugo target=_blank rel=noopener class=text-decoration-none>TomatoHugo</a></p></div></div></div></footer><script src=https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js integrity=sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz crossorigin=anonymous defer></script><script src=/js/dark-mode.min.3e457dc8346f064bee795e6f9b73e1516dcd059e750c521fe4b445f9ea9a7821.js integrity="sha256-PkV9yDRvBkvueV5vm3PhUW3NBZ51DFIf5LRF+eqaeCE=" defer></script><script>window.addEventListener("load",function(){const e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-LN6QP6VVM3",document.head.appendChild(e),e.onload=function(){window.dataLayer=window.dataLayer||[];function e(){dataLayer.push(arguments)}e("js",new Date),e("config","G-LN6QP6VVM3")}})</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"WebPage","name":"Window Functions and Power Spectral Density (PSD): Theory and Python Implementation","url":"https:\/\/yuhi-sa.github.io\/en\/posts\/20260228_fft_window_psd\/1\/","description":"A comprehensive guide to window functions for FFT analysis and Power Spectral Density estimation using Welch\u0027s method, with full Python implementations.","inLanguage":"en","isPartOf":{"@type":"WebSite","name":"tomato blog","url":"https:\/\/yuhi-sa.github.io\/"}}</script></body></html>