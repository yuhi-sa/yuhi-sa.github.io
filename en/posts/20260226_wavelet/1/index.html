<!doctype html><html lang=en dir=ltr data-theme=light><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=theme-color content="#e74c3c"><meta name=format-detection content="telephone=no"><meta name=robots content="index,follow"><meta name=description content="Mathematical foundations of CWT and DWT with time-frequency analysis implementations using PyWavelets in Python."><meta name=author content="yuhi-sa"><link rel=canonical href=https://yuhi-sa.github.io/en/posts/20260226_wavelet/1/><meta property="og:type" content="article"><meta property="og:title" content="Introduction to Wavelet Transform: Time-Frequency Analysis with Python"><meta property="og:description" content="Mathematical foundations of CWT and DWT with time-frequency analysis implementations using PyWavelets in Python."><meta property="og:url" content="https://yuhi-sa.github.io/en/posts/20260226_wavelet/1/"><meta property="og:site_name" content="tomato blog"><meta property="og:locale" content="en"><meta property="og:image" content="https://yuhi-sa.github.io/ogp.jpeg"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta property="article:published_time" content="2026-02-26T19:00:00+09:00"><meta property="article:modified_time" content="2026-02-26T23:47:37+09:00"><meta property="article:tag" content="Signal Processing"><meta property="article:tag" content="Python"><meta property="article:tag" content="Data Visualization"><meta property="article:section" content="posts"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="Introduction to Wavelet Transform: Time-Frequency Analysis with Python"><meta name=twitter:description content="Mathematical foundations of CWT and DWT with time-frequency analysis implementations using PyWavelets in Python."><meta name=twitter:image content="https://yuhi-sa.github.io/ogp.jpeg"><title>Introduction to Wavelet Transform: Time-Frequency Analysis with Python | tomato blog</title><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preconnect href=https://cdn.jsdelivr.net crossorigin><link rel=preconnect href=https://pagead2.googlesyndication.com crossorigin><link rel=dns-prefetch href=https://pagead2.googlesyndication.com><link rel=icon href=https://yuhi-sa.github.io/favicon.ico><link rel=alternate hreflang=ja href=https://yuhi-sa.github.io/posts/20260226_wavelet/1/><link rel=alternate hreflang=en href=https://yuhi-sa.github.io/en/posts/20260226_wavelet/1/><link rel=alternate hreflang=x-default href=https://yuhi-sa.github.io/en/posts/20260226_wavelet/1/><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Introduction to Wavelet Transform: Time-Frequency Analysis with Python","description":"Mathematical foundations of CWT and DWT with time-frequency analysis implementations using PyWavelets in Python.","author":{"@type":"Person","name":"yuhi-sa","url":"https:\/\/yuhi-sa.github.io\/"},"publisher":{"@type":"Organization","name":"tomato blog","logo":{"@type":"ImageObject","url":"https:\/\/yuhi-sa.github.io\/ogp.jpeg"},"url":"https:\/\/yuhi-sa.github.io\/"},"datePublished":"2026-02-26T19:00:00\u002b09:00","dateModified":"2026-02-26T23:47:37\u002b09:00","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/yuhi-sa.github.io\/en\/posts\/20260226_wavelet\/1\/"},"url":"https:\/\/yuhi-sa.github.io\/en\/posts\/20260226_wavelet\/1\/","wordCount":1932,"keywords":["Signal Processing","Python","Data Visualization"],"articleSection":"Posts","inLanguage":"en","timeRequired":"PT10M"}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"tomato blog","item":"https:\/\/yuhi-sa.github.io\/en\/"},{"@type":"ListItem","position":2,"name":"Posts","item":"https:\/\/yuhi-sa.github.io\/en\/posts\/"},{"@type":"ListItem","position":3,"name":"Introduction to Wavelet Transform: Time-Frequency Analysis with Python"}]}</script><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin=anonymous referrerpolicy=no-referrer><link href=https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css rel=stylesheet integrity=sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH crossorigin=anonymous><link rel=stylesheet href=/css/variables.min.72a177faa7b12de55dcc39c4ab6b6392116718d5e2735dab0214511354ecb973.css integrity="sha256-cqF3+qexLeVdzDnEq2tjkhFnGNXic12rAhRRE1TsuXM=" crossorigin=anonymous><link rel=stylesheet href=/css/main.min.403a82b29e94ee6e7a39204b5082cdf8b4966cfb44115390da7d8867a5006acd.css integrity="sha256-QDqCsp6U7m56OSBLUILN+LSWbPtEEVOQ2n2IZ6UAas0=" crossorigin=anonymous><link rel=stylesheet href=/css/syntax.min.e379066489e20d5433ca35ac1f468fd9e8859705a62d77a79bb7379ac3613848.css integrity="sha256-43kGZIniDVQzyjWsH0aP2eiFlwWmLXenm7c3msNhOEg=" crossorigin=anonymous><style>body{font-family:-apple-system,BlinkMacSystemFont,inter,segoe ui,Roboto,sans-serif;line-height:1.5;color:#000;background:#fff}[data-theme=dark] body{color:#fff;background:#000}.container{max-width:768px;margin:0 auto;padding:0 1rem}</style><script src=https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js integrity=sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz crossorigin=anonymous defer></script><script src=/js/dark-mode.min.3e457dc8346f064bee795e6f9b73e1516dcd059e750c521fe4b445f9ea9a7821.js integrity="sha256-PkV9yDRvBkvueV5vm3PhUW3NBZ51DFIf5LRF+eqaeCE=" defer></script><script>window.addEventListener("load",function(){const e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-LN6QP6VVM3",document.head.appendChild(e),e.onload=function(){window.dataLayer=window.dataLayer||[];function e(){dataLayer.push(arguments)}e("js",new Date),e("config","G-LN6QP6VVM3")}})</script><script>window.MathJax={tex:{inlineMath:[["\\(","\\)"]],displayMath:[["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre","code"],ignoreHtmlClass:"tex2jax_ignore",processHtmlClass:"tex2jax_process"}}</script><script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js id=mathjax-script async></script></head><body itemscope itemtype=https://schema.org/WebPage class=theme-tomatohugo><a href=#main-content class="skip-link sr-only sr-only-focusable" aria-label="Skip to main content">Skip to main content</a><header role=banner class=site-header><nav class="navbar navbar-expand-lg navbar-light bg-light" role=navigation aria-label="Main navigation"><div class=container><a class=navbar-brand href=https://yuhi-sa.github.io/ aria-label="Return to tomato blog homepage">tomato blog
</a><button class="navbar-toggler d-lg-none" type=button data-bs-toggle=collapse data-bs-target=#navbarNav aria-controls=navbarNav aria-expanded=false aria-label="Toggle navigation menu">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarNav><ul class="navbar-nav ms-auto" role=menubar><li class=nav-item role=none><a class=nav-link href=https://yuhi-sa.github.io/en/ role=menuitem aria-label="Navigate to Blog">Blog</a></li><li class=nav-item role=none><a class=nav-link href=https://yuhi-sa.github.io/en/tags/ role=menuitem aria-label="Navigate to Tags">Tags</a></li><li class=nav-item role=none><a class=nav-link href=https://yuhi-sa.github.io/en/posts/about/ role=menuitem aria-label="Navigate to About">About</a></li><li class=nav-item role=none><a class=nav-link href=https://yuhi-sa.github.io/en/posts/privacy_policy/ role=menuitem aria-label="Navigate to Privacy policy">Privacy policy</a></li><li class=nav-item role=none><button id=darkModeToggle class="nav-link btn btn-link border-0" type=button role=menuitem aria-label="Toggle dark mode" title="Switch between light and dark themes">
<i class="fas fa-moon" id=darkModeIcon aria-hidden=true></i>
<span class="d-lg-none ms-2">ダークモード</span></button></li></ul></div></div></nav><script data-ad-client=ca-pub-9558545098866170 async crossorigin=anonymous src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></header><main id=main-content role=main class=site-main aria-label="Main content"><div class="container mt-4"><div class="row justify-content-center"><div class=col-lg-8><article itemscope itemtype=https://schema.org/Article><header class=article-header><h1 itemprop=headline>Introduction to Wavelet Transform: Time-Frequency Analysis with Python</h1><p class="lead article-description" itemprop=description>Mathematical foundations of CWT and DWT with time-frequency analysis implementations using PyWavelets in Python.</p><div class=article-meta><time datetime=2026-02-26T19:00:00+09:00 itemprop=datePublished><i class="far fa-calendar-alt me-1" aria-hidden=true></i>
February 26, 2026
</time><time datetime=2026-02-26T23:47:37+09:00 itemprop=dateModified class=ms-3><i class="far fa-edit me-1" aria-hidden=true></i>
Updated
February 26, 2026
</time><span aria-label="Reading time" class=ms-3><i class="far fa-clock me-1" aria-hidden=true></i>
10 min read</span></div><div class=article-tags role=group aria-label="Article tags"><a href=/en/tags/signal-processing/ class="badge badge-custom text-decoration-none me-1" rel=tag itemprop=keywords>Signal Processing
</a><a href=/en/tags/python/ class="badge badge-custom text-decoration-none me-1" rel=tag itemprop=keywords>Python
</a><a href=/en/tags/data-visualization/ class="badge badge-custom text-decoration-none me-1" rel=tag itemprop=keywords>Data Visualization</a></div></header><div class=article-content itemprop=articleBody><h2 id=introduction>Introduction</h2><p>As discussed in the <a href=https://yuhi-sa.github.io/en/posts/20260225_fft/1/>FFT article</a>, the Fourier transform is a powerful tool for decomposing signals into sinusoidal frequency components. However, it has an inherent limitation: <strong>loss of time information</strong>.</p><p>The Fourier transform tells us &ldquo;which frequencies are present in the signal as a whole&rdquo; but not &ldquo;when those frequencies occurred.&rdquo; For signals whose frequency content changes over time, such as speech or seismic waves, this limitation is critical.</p><p>The Short-Time Fourier Transform (STFT) introduces time localization using a window function, but its fixed window size cannot simultaneously achieve high resolution for both high and low frequencies. The <strong>Wavelet Transform</strong> solves this problem by providing adaptive resolution in both time and frequency.</p><p>This article covers the mathematical foundations of the Continuous Wavelet Transform (CWT) and Discrete Wavelet Transform (DWT), along with Python implementations using PyWavelets.</p><h2 id=from-fourier-to-wavelet-transform>From Fourier to Wavelet Transform</h2><h3 id=limitations-of-stft-fixed-window-size>Limitations of STFT: Fixed Window Size</h3><p>The STFT segments a signal with a short window and applies the Fourier transform to each segment:</p>\[\text{STFT}\{x(t)\}(\tau, \omega) = \int_{-\infty}^{\infty} x(t) \, w(t - \tau) \, e^{-j\omega t} \, dt \tag{1}\]<p>where \(w(t)\) is the window function and \(\tau\) is the time shift. The fundamental issue with STFT is that the window size is fixed:</p><ul><li><strong>Short window</strong>: Good time resolution, poor frequency resolution</li><li><strong>Long window</strong>: Good frequency resolution, poor time resolution</li></ul><p>This trade-off is governed by the <strong>Heisenberg uncertainty principle</strong>. There is a lower bound on the product of time spread \(\Delta t\) and frequency spread \(\Delta f\):</p>\[\Delta t \cdot \Delta f \geq \frac{1}{4\pi} \tag{2}\]<p>In STFT, the product \(\Delta t \cdot \Delta f\) is fixed at a constant value. Wavelet transforms maintain this constant product but adaptively redistribute \(\Delta t\) and \(\Delta f\) depending on frequency.</p><h3 id=the-wavelet-transform-idea>The Wavelet Transform Idea</h3><p>The key insight of wavelet analysis is to use <strong>localized waveforms (wavelets)</strong> as basis functions instead of sinusoids. Wavelets have finite temporal extent, naturally providing time localization.</p><p>By <strong>dilating and compressing</strong> the wavelet, different frequency bands can be analyzed at different resolutions:</p><ul><li><strong>Small scale</strong> (compressed wavelet): Captures high-frequency components with high time resolution</li><li><strong>Large scale</strong> (stretched wavelet): Captures low-frequency components with high frequency resolution</li></ul><h2 id=continuous-wavelet-transform-cwt>Continuous Wavelet Transform (CWT)</h2><h3 id=mother-wavelet>Mother Wavelet</h3><p>The basis function for the wavelet transform is called the <strong>mother wavelet</strong> \(\psi(t)\). It must satisfy two conditions:</p><ol><li><strong>Finite energy</strong>: \(\int_{-\infty}^{\infty} |\psi(t)|^2 \, dt &lt; \infty\)</li><li><strong>Admissibility condition</strong>: \(C_\psi = \int_0^{\infty} \frac{|\hat{\Psi}(\omega)|^2}{\omega} \, d\omega &lt; \infty\)</li></ol><p>The admissibility condition implies that the mother wavelet has zero mean (\(\int \psi(t) \, dt = 0\)), meaning it must be an oscillatory waveform.</p><h3 id=cwt-definition>CWT Definition</h3><p>The CWT of a signal \(x(t)\) is defined using the scale parameter \(a > 0\) and translation parameter \(b\):</p>\[W(a, b) = \frac{1}{\sqrt{a}} \int_{-\infty}^{\infty} x(t) \, \psi^*\!\left(\frac{t - b}{a}\right) dt \tag{3}\]<p>where:</p><ul><li>\(a\): Scale parameter (dilation). Larger \(a\) stretches the wavelet, capturing lower frequencies</li><li>\(b\): Translation parameter. Specifies the position along the signal</li><li>\(\psi^*\): Complex conjugate of the mother wavelet</li><li>\(\frac{1}{\sqrt{a}}\): Energy normalization factor, ensuring constant wavelet energy across scales</li></ul><p>The CWT result \(W(a, b)\) is a two-dimensional time-scale representation, visualized as a <strong>scalogram</strong> (\(|W(a, b)|^2\)).</p><h3 id=common-mother-wavelets>Common Mother Wavelets</h3><h4 id=morlet-wavelet>Morlet Wavelet</h4>\[\psi(t) = \pi^{-1/4} e^{j\omega_0 t} e^{-t^2/2} \tag{4}\]<p>A complex sinusoid modulated by a Gaussian envelope, where \(\omega_0\) (typically \(5\) or \(6\)) controls the center frequency. It is one of the most widely used wavelets for time-frequency analysis, offering a good balance between time and frequency resolution.</p><h4 id=mexican-hat-wavelet>Mexican Hat Wavelet</h4>\[\psi(t) = \frac{2}{\sqrt{3}\pi^{1/4}} (1 - t^2) e^{-t^2/2} \tag{5}\]<p>The negative normalized second derivative of a Gaussian, also known as the Difference of Gaussians (DoG). It is a real-valued wavelet well-suited for detecting singularities and edges in signals.</p><h2 id=discrete-wavelet-transform-dwt>Discrete Wavelet Transform (DWT)</h2><h3 id=dyadic-sampling>Dyadic Sampling</h3><p>The CWT varies scale and translation continuously, producing highly redundant information. For computational efficiency and theoretical elegance, the <strong>Discrete Wavelet Transform (DWT)</strong> discretizes scale and translation using powers of two:</p>\[a = 2^j, \quad b = k \cdot 2^j \tag{6}\]<p>where \(j\) is the decomposition level and \(k\) is the translation index. The wavelet basis functions become:</p>\[\psi_{j,k}(t) = 2^{-j/2} \psi(2^{-j} t - k) \tag{7}\]<h3 id=multiresolution-analysis-mra>Multiresolution Analysis (MRA)</h3><p>The theoretical foundation of the DWT is <strong>Multiresolution Analysis (MRA)</strong>, which decomposes a signal into <strong>approximation</strong> and <strong>detail</strong> components at different resolution levels.</p><p>MRA is built upon two functions:</p><ul><li><strong>Scaling function</strong> \(\phi(t)\): Represents low-frequency content (approximation)</li><li><strong>Wavelet function</strong> \(\psi(t)\): Represents high-frequency content (detail)</li></ul><p>The scaling function satisfies the two-scale equation:</p>\[\phi(t) = \sqrt{2} \sum_k h[k] \, \phi(2t - k) \tag{8}\]<p>The wavelet function is derived from the scaling function:</p>\[\psi(t) = \sqrt{2} \sum_k g[k] \, \phi(2t - k) \tag{9}\]<p>where \(h[k]\) is the low-pass filter coefficients, \(g[k]\) is the high-pass filter coefficients, and they are related by:</p>\[g[k] = (-1)^k h[N - 1 - k] \tag{10}\]<h3 id=filter-bank-decomposition>Filter Bank Decomposition</h3><p>DWT computation is efficiently implemented as a cascade of filter banks and downsampling operations, known as <strong>Mallat&rsquo;s algorithm</strong>.</p><p>Each decomposition stage passes the signal through a low-pass filter \(H\) and a high-pass filter \(G\), followed by downsampling by 2:</p><ul><li><strong>Approximation Coefficients (cA)</strong>: Low-pass filter \(H\) + downsampling by 2 -> low-frequency components</li><li><strong>Detail Coefficients (cD)</strong>: High-pass filter \(G\) + downsampling by 2 -> high-frequency components</li></ul><p>In multi-level decomposition, the approximation coefficients cA are recursively decomposed further. At level \(j\), the signal is separated into:</p>\[x(t) = \text{cA}_j + \text{cD}_j + \text{cD}_{j-1} + \cdots + \text{cD}_1 \tag{11}\]<p>This structure can be understood as a cascaded version of the filter concepts discussed in <a href=https://yuhi-sa.github.io/en/posts/20260223_lowpass_filter/1/>Low-Pass Filter Design and Comparison</a>.</p><h2 id=python-implementation-with-pywavelets>Python Implementation with PyWavelets</h2><h3 id=cwt-example-scalogram-of-a-chirp-signal>CWT Example: Scalogram of a Chirp Signal</h3><p>We apply CWT to a chirp signal whose frequency changes over time and visualize the resulting scalogram.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pywt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># --- Generate chirp signal ---</span>
</span></span><span class=line><span class=cl><span class=n>fs</span> <span class=o>=</span> <span class=mi>1000</span>  <span class=c1># Sampling frequency [Hz]</span>
</span></span><span class=line><span class=cl><span class=n>t</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>1</span> <span class=o>/</span> <span class=n>fs</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># Chirp: frequency linearly increases from 10 Hz to 100 Hz</span>
</span></span><span class=line><span class=cl><span class=n>freq</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>t</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>signal</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>cumsum</span><span class=p>(</span><span class=n>freq</span><span class=p>)</span> <span class=o>/</span> <span class=n>fs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># --- Compute CWT ---</span>
</span></span><span class=line><span class=cl><span class=n>scales</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>128</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>coefficients</span><span class=p>,</span> <span class=n>frequencies</span> <span class=o>=</span> <span class=n>pywt</span><span class=o>.</span><span class=n>cwt</span><span class=p>(</span><span class=n>signal</span><span class=p>,</span> <span class=n>scales</span><span class=p>,</span> <span class=s2>&#34;morl&#34;</span><span class=p>,</span> <span class=mi>1</span> <span class=o>/</span> <span class=n>fs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># --- Plot scalogram ---</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>5</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>pcolormesh</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>t</span><span class=p>,</span> <span class=n>frequencies</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>coefficients</span><span class=p>)</span> <span class=o>**</span> <span class=mi>2</span><span class=p>,</span> <span class=n>shading</span><span class=o>=</span><span class=s2>&#34;gouraud&#34;</span><span class=p>,</span> <span class=n>cmap</span><span class=o>=</span><span class=s2>&#34;viridis&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>colorbar</span><span class=p>(</span><span class=n>label</span><span class=o>=</span><span class=s2>&#34;Power&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s2>&#34;Time [s]&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s2>&#34;Frequency [Hz]&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>ylim</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>150</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s2>&#34;CWT Scalogram (Morlet Wavelet)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></div><p>The scalogram clearly shows the frequency increasing from 10 Hz to 100 Hz over time. Compared to an STFT spectrogram, the wavelet scalogram offers higher frequency resolution at low frequencies and higher time resolution at high frequencies, demonstrating the adaptive resolution property.</p><h3 id=dwt-example-multi-level-decomposition>DWT Example: Multi-Level Decomposition</h3><p>We perform multi-level DWT decomposition on a noisy signal and visualize the approximation and detail coefficients at each level.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pywt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># --- Generate test signal ---</span>
</span></span><span class=line><span class=cl><span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>fs</span> <span class=o>=</span> <span class=mi>500</span>
</span></span><span class=line><span class=cl><span class=n>t</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span> <span class=o>/</span> <span class=n>fs</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># Low-frequency + high-frequency + noise</span>
</span></span><span class=line><span class=cl><span class=n>clean</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span> <span class=o>*</span> <span class=mi>5</span> <span class=o>*</span> <span class=n>t</span><span class=p>)</span> <span class=o>+</span> <span class=mf>0.5</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span> <span class=o>*</span> <span class=mi>50</span> <span class=o>*</span> <span class=n>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>noise</span> <span class=o>=</span> <span class=mf>0.3</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>t</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>signal</span> <span class=o>=</span> <span class=n>clean</span> <span class=o>+</span> <span class=n>noise</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># --- Multi-level DWT decomposition ---</span>
</span></span><span class=line><span class=cl><span class=n>wavelet</span> <span class=o>=</span> <span class=s2>&#34;db4&#34;</span>  <span class=c1># Daubechies-4 wavelet</span>
</span></span><span class=line><span class=cl><span class=n>level</span> <span class=o>=</span> <span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=n>coeffs</span> <span class=o>=</span> <span class=n>pywt</span><span class=o>.</span><span class=n>wavedec</span><span class=p>(</span><span class=n>signal</span><span class=p>,</span> <span class=n>wavelet</span><span class=p>,</span> <span class=n>level</span><span class=o>=</span><span class=n>level</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># coeffs = [cA5, cD5, cD4, cD3, cD2, cD1]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># --- Visualization ---</span>
</span></span><span class=line><span class=cl><span class=n>fig</span><span class=p>,</span> <span class=n>axes</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=n>level</span> <span class=o>+</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>10</span><span class=p>),</span> <span class=n>sharex</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>t</span><span class=p>,</span> <span class=n>signal</span><span class=p>,</span> <span class=s2>&#34;k&#34;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mf>0.5</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s2>&#34;Original Signal&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s2>&#34;Amplitude&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>coeffs</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=s2>&#34;b&#34;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mf>0.5</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Approximation Coefficients (cA</span><span class=si>{</span><span class=n>level</span><span class=si>}</span><span class=s2>)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s2>&#34;Amplitude&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>level</span> <span class=o>+</span> <span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>axes</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>coeffs</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=s2>&#34;r&#34;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mf>0.5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>axes</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Detail Coefficients (cD</span><span class=si>{</span><span class=n>level</span> <span class=o>-</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=si>}</span><span class=s2>)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>axes</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s2>&#34;Amplitude&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></div><p>Examining the decomposition results reveals:</p><ul><li><strong>cA5</strong> (approximation coefficients): Contains the lowest-frequency components (the 5 Hz sine wave)</li><li><strong>cD1, cD2</strong> (detail coefficients, high levels): Primarily contain high-frequency noise</li><li><strong>cD3, cD4</strong> (detail coefficients, mid levels): Contain the 50 Hz sine wave component</li></ul><h3 id=signal-denoising-with-wavelet-thresholding>Signal Denoising with Wavelet Thresholding</h3><p>A key application of DWT is <strong>wavelet thresholding</strong> for signal denoising. Since noise primarily appears in the detail coefficients, zeroing out coefficients below a threshold effectively removes noise.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pywt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># --- Generate test signal ---</span>
</span></span><span class=line><span class=cl><span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>fs</span> <span class=o>=</span> <span class=mi>500</span>
</span></span><span class=line><span class=cl><span class=n>t</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span> <span class=o>/</span> <span class=n>fs</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>clean</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span> <span class=o>*</span> <span class=mi>5</span> <span class=o>*</span> <span class=n>t</span><span class=p>)</span> <span class=o>+</span> <span class=mf>0.5</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span> <span class=o>*</span> <span class=mi>50</span> <span class=o>*</span> <span class=n>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>noise</span> <span class=o>=</span> <span class=mf>0.3</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>t</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>signal</span> <span class=o>=</span> <span class=n>clean</span> <span class=o>+</span> <span class=n>noise</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># --- DWT decomposition ---</span>
</span></span><span class=line><span class=cl><span class=n>wavelet</span> <span class=o>=</span> <span class=s2>&#34;db4&#34;</span>
</span></span><span class=line><span class=cl><span class=n>level</span> <span class=o>=</span> <span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=n>coeffs</span> <span class=o>=</span> <span class=n>pywt</span><span class=o>.</span><span class=n>wavedec</span><span class=p>(</span><span class=n>signal</span><span class=p>,</span> <span class=n>wavelet</span><span class=p>,</span> <span class=n>level</span><span class=o>=</span><span class=n>level</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># --- Thresholding ---</span>
</span></span><span class=line><span class=cl><span class=c1># Universal threshold (VisuShrink): lambda = sigma * sqrt(2 * log(N))</span>
</span></span><span class=line><span class=cl><span class=n>sigma</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>median</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>coeffs</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]))</span> <span class=o>/</span> <span class=mf>0.6745</span>  <span class=c1># Robust noise estimation</span>
</span></span><span class=line><span class=cl><span class=n>threshold</span> <span class=o>=</span> <span class=n>sigma</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>log</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>signal</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Apply soft thresholding to detail coefficients</span>
</span></span><span class=line><span class=cl><span class=n>coeffs_thresh</span> <span class=o>=</span> <span class=p>[</span><span class=n>coeffs</span><span class=p>[</span><span class=mi>0</span><span class=p>]]</span>  <span class=c1># Keep approximation coefficients</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>coeffs</span><span class=p>[</span><span class=mi>1</span><span class=p>:]:</span>
</span></span><span class=line><span class=cl>    <span class=n>coeffs_thresh</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>pywt</span><span class=o>.</span><span class=n>threshold</span><span class=p>(</span><span class=n>c</span><span class=p>,</span> <span class=n>threshold</span><span class=p>,</span> <span class=n>mode</span><span class=o>=</span><span class=s2>&#34;soft&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># --- Inverse DWT reconstruction ---</span>
</span></span><span class=line><span class=cl><span class=n>denoised</span> <span class=o>=</span> <span class=n>pywt</span><span class=o>.</span><span class=n>waverec</span><span class=p>(</span><span class=n>coeffs_thresh</span><span class=p>,</span> <span class=n>wavelet</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># --- Visualization ---</span>
</span></span><span class=line><span class=cl><span class=n>fig</span><span class=p>,</span> <span class=n>axes</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>7</span><span class=p>),</span> <span class=n>sharex</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>t</span><span class=p>,</span> <span class=n>clean</span><span class=p>,</span> <span class=s2>&#34;b&#34;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mf>0.8</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s2>&#34;Original Clean Signal&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s2>&#34;Amplitude&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>t</span><span class=p>,</span> <span class=n>signal</span><span class=p>,</span> <span class=s2>&#34;k&#34;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mf>0.5</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Noisy Signal (SNR = </span><span class=si>{</span><span class=mi>10</span><span class=o>*</span><span class=n>np</span><span class=o>.</span><span class=n>log10</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>var</span><span class=p>(</span><span class=n>clean</span><span class=p>)</span><span class=o>/</span><span class=n>np</span><span class=o>.</span><span class=n>var</span><span class=p>(</span><span class=n>noise</span><span class=p>))</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2> dB)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s2>&#34;Amplitude&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>t</span><span class=p>,</span> <span class=n>denoised</span><span class=p>[:</span> <span class=nb>len</span><span class=p>(</span><span class=n>t</span><span class=p>)],</span> <span class=s2>&#34;r&#34;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mf>0.8</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s2>&#34;Denoised Signal (Wavelet Thresholding)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s2>&#34;Amplitude&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>ax</span> <span class=ow>in</span> <span class=n>axes</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>ax</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s2>&#34;Time [s]&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># --- Quantitative evaluation ---</span>
</span></span><span class=line><span class=cl><span class=n>mse_noisy</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>((</span><span class=n>signal</span> <span class=o>-</span> <span class=n>clean</span><span class=p>)</span> <span class=o>**</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>mse_denoised</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>((</span><span class=n>denoised</span><span class=p>[:</span> <span class=nb>len</span><span class=p>(</span><span class=n>t</span><span class=p>)]</span> <span class=o>-</span> <span class=n>clean</span><span class=p>)</span> <span class=o>**</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;MSE of noisy signal:    </span><span class=si>{</span><span class=n>mse_noisy</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;MSE after denoising:    </span><span class=si>{</span><span class=n>mse_denoised</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;MSE improvement:        </span><span class=si>{</span><span class=p>(</span><span class=mi>1</span> <span class=o>-</span> <span class=n>mse_denoised</span> <span class=o>/</span> <span class=n>mse_noisy</span><span class=p>)</span> <span class=o>*</span> <span class=mi>100</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>%&#34;</span><span class=p>)</span>
</span></span></code></pre></div><p>Soft thresholding shrinks coefficients exceeding the threshold \(\lambda\) by \(\lambda\) and zeros out those below:</p>\[\text{soft}(x, \lambda) = \text{sign}(x) \cdot \max(|x| - \lambda, 0) \tag{12}\]<p>The universal threshold \(\lambda = \sigma\sqrt{2 \log N}\) (VisuShrink) is automatically determined from the noise standard deviation \(\sigma\) and signal length \(N\), requiring no parameter tuning. The noise standard deviation \(\sigma\) is robustly estimated using the MAD (Median Absolute Deviation).</p><h2 id=comparison-fft-vs-stft-vs-wavelet>Comparison: FFT vs STFT vs Wavelet</h2><table><thead><tr><th>Feature</th><th>FFT</th><th>STFT</th><th>Wavelet</th></tr></thead><tbody><tr><td>Time resolution</td><td>None</td><td>Fixed</td><td>Adaptive (high at high-freq)</td></tr><tr><td>Frequency resolution</td><td>High (global)</td><td>Fixed</td><td>Adaptive (high at low-freq)</td></tr><tr><td>Basis function</td><td>Sinusoid</td><td>Windowed sinusoid</td><td>Mother wavelet</td></tr><tr><td>Output</td><td>1D spectrum</td><td>2D (time-frequency)</td><td>2D (time-scale)</td></tr><tr><td>Inverse transform</td><td>Yes</td><td>Yes</td><td>Yes</td></tr><tr><td>Complexity</td><td>\(O(N \log N)\)</td><td>\(O(N L \log L)\)</td><td>CWT: \(O(NS)\), DWT: \(O(N)\)</td></tr><tr><td>Primary use</td><td>Stationary signals</td><td>Speech/music analysis</td><td>Non-stationary, denoising</td></tr></tbody></table><p>Here \(L\) is the STFT window length and \(S\) is the number of CWT scales. DWT achieves \(O(N)\) complexity through its filter bank implementation, making it highly efficient.</p><p>Guidelines for choosing the appropriate method:</p><ul><li><strong>Stationary signals</strong> where you need the overall frequency content -> FFT</li><li><strong>Time-varying frequencies</strong> tracked at uniform resolution -> STFT</li><li><strong>Simultaneous detection of slow trends and rapid transients</strong> -> Wavelet Transform</li></ul><h2 id=summary>Summary</h2><p>This article covered the mathematical foundations and Python implementations of the wavelet transform.</p><ul><li><strong>CWT</strong> varies scale and translation continuously, achieving adaptive time-frequency resolution</li><li><strong>DWT</strong> achieves efficient \(O(N)\) decomposition through dyadic sampling and filter banks</li><li><strong>Wavelet thresholding</strong> is a practical denoising technique that applies thresholds to detail coefficients</li><li>FFT, STFT, and wavelet transforms each excel in different scenarios; choosing the right tool depends on the analysis target</li></ul><p>The wavelet transform extends beyond signal processing into image compression (JPEG 2000), financial data analysis, biomedical signal processing, seismic analysis, and many other fields.</p><h2 id=related-articles>Related Articles</h2><ul><li><a href=https://yuhi-sa.github.io/en/posts/20260225_fft/1/>Fast Fourier Transform (FFT): Theory and Python Implementation</a> - Detailed coverage of the Fourier transform, providing the foundation for comparison with wavelets.</li><li><a href=https://yuhi-sa.github.io/en/posts/20220206_ema/1/>Frequency Characteristics of the Exponential Moving Average (EMA) Filter</a> - Helps understand the difference between time-domain filtering and wavelet-based frequency separation.</li><li><a href=https://yuhi-sa.github.io/en/posts/20260225_moving_average/1/>Types and Comparison of Moving Average Filters</a> - Helps understand the relationship between time-domain filters and wavelet filter banks.</li><li><a href=https://yuhi-sa.github.io/en/posts/20260223_lowpass_filter/1/>Low-Pass Filter Design and Comparison</a> - Enables comparison between classical filter design and the wavelet approach.</li><li><a href=https://yuhi-sa.github.io/en/posts/20260223_matplotlib_tips/1/>Matplotlib Practical Tips: Creating Publication-Quality Plots</a> - Tips for producing higher-quality scalogram visualizations.</li></ul><h2 id=references>References</h2><ul><li>Mallat, S. (2008). <em>A Wavelet Tour of Signal Processing: The Sparse Way</em> (3rd ed.). Academic Press.</li><li>Daubechies, I. (1992). <em>Ten Lectures on Wavelets</em>. SIAM.</li><li><a href=https://pywavelets.readthedocs.io/>PyWavelets documentation</a></li><li><a href=https://docs.scipy.org/doc/scipy/reference/signal.html>SciPy Signal Processing documentation</a></li></ul></div><div class="ad-slot in-content my-3"><ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=fluid data-ad-client=ca-pub-9558545098866170></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><footer class=article-footer></footer><meta itemprop=wordCount content="1932"><meta itemprop=url content="https://yuhi-sa.github.io/en/posts/20260226_wavelet/1/"></article><nav class="post-nav mt-5" aria-label="Post navigation"><a href=/en/posts/20260226_wiener_filter/1/ class="post-nav__item post-nav__item--prev"><span class="post-nav__label text-muted"><i class="fas fa-arrow-left me-1" aria-hidden=true></i>前の記事
</span><span class=post-nav__title>Wiener Filter: Optimal Linear Filtering Theory and Python Implementation</span>
</a><a href=/en/posts/20260226_ensemble_learning/1/ class="post-nav__item post-nav__item--next"><span class="post-nav__label text-muted">次の記事<i class="fas fa-arrow-right ms-1" aria-hidden=true></i>
</span><span class=post-nav__title>Ensemble Learning: From Decision Trees to Random Forest and Gradient Boosting</span></a></nav><section class="related-posts mt-5" aria-label="Related posts"><h2 class=related-posts__title>関連記事</h2><div class=related-posts__grid><article class=related-posts__item><h3 class=related-posts__item-title><a href=/en/posts/20260228_notch_filter/1/>Notch Filter Design and Python Implementation: Removing Power Line Noise</a></h3><div class=card-meta><time datetime=2026-02-28>February 28, 2026</time></div></article><article class=related-posts__item><h3 class=related-posts__item-title><a href=/en/posts/20260228_timeseries_anomaly/1/>Time-Series Anomaly Detection: From Statistical Methods to Kalman Filter in Python</a></h3><div class=card-meta><time datetime=2026-02-28>February 28, 2026</time></div></article><article class=related-posts__item><h3 class=related-posts__item-title><a href=/en/posts/20260228_fft_window_psd/1/>Window Functions and Power Spectral Density (PSD): Theory and Python Implementation</a></h3><div class=card-meta><time datetime=2026-02-28>February 28, 2026</time></div></article></div></section><nav class="article-navigation mt-4" aria-label="Article navigation"><a href=/en/posts/ class="btn btn-outline-secondary btn-sm mb-3"><i class="fas fa-arrow-left me-1" aria-hidden=true></i>
Back to posts</a><nav aria-label="Breadcrumb navigation" class=breadcrumb-nav role=navigation><ol class=breadcrumb itemscope itemtype=https://schema.org/BreadcrumbList><li class=breadcrumb-item itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a href=/en/ itemprop=item aria-label="Navigate to homepage"><i class="fas fa-home" aria-hidden=true></i>
<span itemprop=name>tomato blog</span>
</a><meta itemprop=position content="1"></li><li class=breadcrumb-item itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a href=https://yuhi-sa.github.io/en/ itemprop=item aria-label="Navigate to tomato blog"><span itemprop=name>tomato blog</span>
</a><meta itemprop=position content="2"></li><li class=breadcrumb-item itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a href=https://yuhi-sa.github.io/en/posts/ itemprop=item aria-label="Navigate to Posts"><span itemprop=name>Posts</span>
</a><meta itemprop=position content="3"></li><li class="breadcrumb-item active" aria-current=page itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><span itemprop=name>Introduction to Wavelet Transform: Time-Frequency Analysis with Python</span>
<meta itemprop=position content="4"></li></ol></nav></nav></div></div></div></main><footer role=contentinfo class=site-footer><div class="container pt-4 pb-3" style="border-top:2px solid var(--accent,#e54d2e)"><div class="row justify-content-center"><div class="col-md-8 text-center"><p class="copyright-text text-muted mb-2">&copy; 2026 yuhi-sa. All rights reserved.</p><p class="theme-attribution text-muted small mt-2 mb-0">Powered by
<a href=https://gohugo.io/ target=_blank rel=noopener class=text-decoration-none>Hugo</a>
with
<a href=https://github.com/yuhi-sa/tomatohugo target=_blank rel=noopener class=text-decoration-none>TomatoHugo</a></p></div></div></div></footer><script src=https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js integrity=sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz crossorigin=anonymous defer></script><script src=/js/dark-mode.min.3e457dc8346f064bee795e6f9b73e1516dcd059e750c521fe4b445f9ea9a7821.js integrity="sha256-PkV9yDRvBkvueV5vm3PhUW3NBZ51DFIf5LRF+eqaeCE=" defer></script><script>window.addEventListener("load",function(){const e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-LN6QP6VVM3",document.head.appendChild(e),e.onload=function(){window.dataLayer=window.dataLayer||[];function e(){dataLayer.push(arguments)}e("js",new Date),e("config","G-LN6QP6VVM3")}})</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"WebPage","name":"Introduction to Wavelet Transform: Time-Frequency Analysis with Python","url":"https:\/\/yuhi-sa.github.io\/en\/posts\/20260226_wavelet\/1\/","description":"Mathematical foundations of CWT and DWT with time-frequency analysis implementations using PyWavelets in Python.","inLanguage":"en","isPartOf":{"@type":"WebSite","name":"tomato blog","url":"https:\/\/yuhi-sa.github.io\/"}}</script></body></html>