<!doctype html><html lang=en dir=ltr data-theme=light><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=theme-color content="#e74c3c"><meta name=format-detection content="telephone=no"><meta name=robots content="index,follow"><meta name=description content="A practical guide to notch (band-reject) filter design for removing 50/60 Hz power line noise, with IIR notch filter theory, pole-zero analysis, and Python …"><meta name=keywords content="notch filter,band-reject filter,power line noise,50Hz,60Hz,Python,scipy,IIR,signal processing"><meta name=author content="yuhi-sa"><link rel=canonical href=https://yuhi-sa.github.io/en/posts/20260228_notch_filter/1/><meta property="og:type" content="article"><meta property="og:title" content="Notch Filter Design and Python Implementation: Removing Power Line Noise"><meta property="og:description" content="A practical guide to notch (band-reject) filter design for removing 50/60 Hz power line noise, with IIR notch filter theory, pole-zero analysis, and Python …"><meta property="og:url" content="https://yuhi-sa.github.io/en/posts/20260228_notch_filter/1/"><meta property="og:site_name" content="tomato blog"><meta property="og:locale" content="en"><meta property="og:image" content="https://yuhi-sa.github.io/ogp.jpeg"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta property="article:published_time" content="2026-02-28T12:00:00+09:00"><meta property="article:modified_time" content="2026-02-28T19:16:58+09:00"><meta property="article:tag" content="Signal Processing"><meta property="article:tag" content="Filtering"><meta property="article:tag" content="Python"><meta property="article:section" content="posts"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="Notch Filter Design and Python Implementation: Removing Power Line Noise"><meta name=twitter:description content="A practical guide to notch (band-reject) filter design for removing 50/60 Hz power line noise, with IIR notch filter theory, pole-zero analysis, and Python …"><meta name=twitter:image content="https://yuhi-sa.github.io/ogp.jpeg"><title>Notch Filter Design and Python Implementation: Removing Power Line Noise | tomato blog</title><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preconnect href=https://cdn.jsdelivr.net crossorigin><link rel=preconnect href=https://pagead2.googlesyndication.com crossorigin><link rel=dns-prefetch href=https://pagead2.googlesyndication.com><link rel=icon href=https://yuhi-sa.github.io/favicon.ico><link rel=alternate hreflang=ja href=https://yuhi-sa.github.io/posts/20260228_notch_filter/1/><link rel=alternate hreflang=en href=https://yuhi-sa.github.io/en/posts/20260228_notch_filter/1/><link rel=alternate hreflang=x-default href=https://yuhi-sa.github.io/en/posts/20260228_notch_filter/1/><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Notch Filter Design and Python Implementation: Removing Power Line Noise","description":"A practical guide to notch (band-reject) filter design for removing 50\/60 Hz power line noise, with IIR notch filter theory, pole-zero analysis, and Python implementation using scipy.signal.iirnotch.","author":{"@type":"Person","name":"yuhi-sa","url":"https:\/\/yuhi-sa.github.io\/"},"publisher":{"@type":"Organization","name":"tomato blog","logo":{"@type":"ImageObject","url":"https:\/\/yuhi-sa.github.io\/ogp.jpeg"},"url":"https:\/\/yuhi-sa.github.io\/"},"datePublished":"2026-02-28T12:00:00\u002b09:00","dateModified":"2026-02-28T19:16:58\u002b09:00","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/yuhi-sa.github.io\/en\/posts\/20260228_notch_filter\/1\/"},"url":"https:\/\/yuhi-sa.github.io\/en\/posts\/20260228_notch_filter\/1\/","wordCount":1776,"keywords":["Signal Processing","Filtering","Python"],"articleSection":"Posts","inLanguage":"en","timeRequired":"PT9M"}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"tomato blog","item":"https:\/\/yuhi-sa.github.io\/en\/"},{"@type":"ListItem","position":2,"name":"Posts","item":"https:\/\/yuhi-sa.github.io\/en\/posts\/"},{"@type":"ListItem","position":3,"name":"Notch Filter Design and Python Implementation: Removing Power Line Noise"}]}</script><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin=anonymous referrerpolicy=no-referrer><link href=https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css rel=stylesheet integrity=sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH crossorigin=anonymous><link rel=stylesheet href=/css/variables.min.72a177faa7b12de55dcc39c4ab6b6392116718d5e2735dab0214511354ecb973.css integrity="sha256-cqF3+qexLeVdzDnEq2tjkhFnGNXic12rAhRRE1TsuXM=" crossorigin=anonymous><link rel=stylesheet href=/css/main.min.403a82b29e94ee6e7a39204b5082cdf8b4966cfb44115390da7d8867a5006acd.css integrity="sha256-QDqCsp6U7m56OSBLUILN+LSWbPtEEVOQ2n2IZ6UAas0=" crossorigin=anonymous><link rel=stylesheet href=/css/syntax.min.e379066489e20d5433ca35ac1f468fd9e8859705a62d77a79bb7379ac3613848.css integrity="sha256-43kGZIniDVQzyjWsH0aP2eiFlwWmLXenm7c3msNhOEg=" crossorigin=anonymous><style>body{font-family:-apple-system,BlinkMacSystemFont,inter,segoe ui,Roboto,sans-serif;line-height:1.5;color:#000;background:#fff}[data-theme=dark] body{color:#fff;background:#000}.container{max-width:768px;margin:0 auto;padding:0 1rem}</style><script src=https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js integrity=sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz crossorigin=anonymous defer></script><script src=/js/dark-mode.min.3e457dc8346f064bee795e6f9b73e1516dcd059e750c521fe4b445f9ea9a7821.js integrity="sha256-PkV9yDRvBkvueV5vm3PhUW3NBZ51DFIf5LRF+eqaeCE=" defer></script><script>window.addEventListener("load",function(){const e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-LN6QP6VVM3",document.head.appendChild(e),e.onload=function(){window.dataLayer=window.dataLayer||[];function e(){dataLayer.push(arguments)}e("js",new Date),e("config","G-LN6QP6VVM3")}})</script><script>window.MathJax={tex:{inlineMath:[["\\(","\\)"]],displayMath:[["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre","code"],ignoreHtmlClass:"tex2jax_ignore",processHtmlClass:"tex2jax_process"}}</script><script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js id=mathjax-script async></script></head><body itemscope itemtype=https://schema.org/WebPage class=theme-tomatohugo><a href=#main-content class="skip-link sr-only sr-only-focusable" aria-label="Skip to main content">Skip to main content</a><header role=banner class=site-header><nav class="navbar navbar-expand-lg navbar-light bg-light" role=navigation aria-label="Main navigation"><div class=container><a class=navbar-brand href=https://yuhi-sa.github.io/ aria-label="Return to tomato blog homepage">tomato blog
</a><button class="navbar-toggler d-lg-none" type=button data-bs-toggle=collapse data-bs-target=#navbarNav aria-controls=navbarNav aria-expanded=false aria-label="Toggle navigation menu">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarNav><ul class="navbar-nav ms-auto" role=menubar><li class=nav-item role=none><a class=nav-link href=https://yuhi-sa.github.io/en/ role=menuitem aria-label="Navigate to Blog">Blog</a></li><li class=nav-item role=none><a class=nav-link href=https://yuhi-sa.github.io/en/tags/ role=menuitem aria-label="Navigate to Tags">Tags</a></li><li class=nav-item role=none><a class=nav-link href=https://yuhi-sa.github.io/en/posts/about/ role=menuitem aria-label="Navigate to About">About</a></li><li class=nav-item role=none><a class=nav-link href=https://yuhi-sa.github.io/en/posts/privacy_policy/ role=menuitem aria-label="Navigate to Privacy policy">Privacy policy</a></li><li class=nav-item role=none><button id=darkModeToggle class="nav-link btn btn-link border-0" type=button role=menuitem aria-label="Toggle dark mode" title="Switch between light and dark themes">
<i class="fas fa-moon" id=darkModeIcon aria-hidden=true></i>
<span class="d-lg-none ms-2">ダークモード</span></button></li></ul></div></div></nav><script data-ad-client=ca-pub-9558545098866170 async crossorigin=anonymous src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></header><main id=main-content role=main class=site-main aria-label="Main content"><div class="container mt-4"><div class="row justify-content-center"><div class=col-lg-8><article itemscope itemtype=https://schema.org/Article><header class=article-header><h1 itemprop=headline>Notch Filter Design and Python Implementation: Removing Power Line Noise</h1><p class="lead article-description" itemprop=description>A practical guide to notch (band-reject) filter design for removing 50/60 Hz power line noise, with IIR notch filter theory, pole-zero analysis, and Python implementation using scipy.signal.iirnotch.</p><div class=article-meta><time datetime=2026-02-28T12:00:00+09:00 itemprop=datePublished><i class="far fa-calendar-alt me-1" aria-hidden=true></i>
February 28, 2026
</time><time datetime=2026-02-28T19:16:58+09:00 itemprop=dateModified class=ms-3><i class="far fa-edit me-1" aria-hidden=true></i>
Updated
February 28, 2026
</time><span aria-label="Reading time" class=ms-3><i class="far fa-clock me-1" aria-hidden=true></i>
9 min read</span></div><div class=article-tags role=group aria-label="Article tags"><a href=/en/tags/signal-processing/ class="badge badge-custom text-decoration-none me-1" rel=tag itemprop=keywords>Signal Processing
</a><a href=/en/tags/filtering/ class="badge badge-custom text-decoration-none me-1" rel=tag itemprop=keywords>Filtering
</a><a href=/en/tags/python/ class="badge badge-custom text-decoration-none me-1" rel=tag itemprop=keywords>Python</a></div></header><div class=article-content itemprop=articleBody><h2 id=introduction>Introduction</h2><p>When measuring signals with electrocardiograms (ECG), electroencephalograms (EEG), accelerometers, or audio equipment, <strong>power line noise</strong> at 50 Hz (Japan, Europe) or 60 Hz (US) frequently contaminates the data. This noise is concentrated at specific frequencies, so a simple lowpass filter often cannot solve the problem. For example, the R-wave in an ECG contains high-frequency components, and applying a lowpass filter to remove noise would also degrade the signal itself.</p><p>A <strong>notch filter</strong> selectively removes only a narrow frequency band while passing all other frequency components unchanged. In this article, we explain the theoretical background of IIR notch filters and demonstrate practical power line noise removal with Python using SciPy.</p><p>For filter fundamentals, see <a href=https://yuhi-sa.github.io/en/posts/20260226_fir_iir/1/>FIR vs IIR Filters</a>. For frequency analysis basics, see <a href=https://yuhi-sa.github.io/en/posts/20260225_fft/1/>FFT Algorithm and Python Implementation</a>.</p><h2 id=basic-concepts-of-notch-filters>Basic Concepts of Notch Filters</h2><p>A notch filter is an extreme case of a <strong>band-reject filter</strong> that removes only a very narrow frequency band. Its frequency response has a sharp &ldquo;notch&rdquo; at the target frequency while maintaining nearly flat gain elsewhere.</p><p>The two key design parameters are:</p><ul><li><strong>Notch frequency</strong> \(f_0\): the center frequency to reject (e.g., 50 Hz, 60 Hz)</li><li><strong>Quality factor</strong> \(Q\): controls the sharpness of the notch</li></ul><p>\(Q\) is defined as the ratio of the notch frequency to the bandwidth:</p>\[Q = \frac{f_0}{\Delta f} \tag{1}\]<p>where \(\Delta f\) is the \(-3\) dB bandwidth. A larger \(Q\) produces a narrower notch, enabling precise removal of only the target frequency.</p><h2 id=iir-notch-filter-transfer-function>IIR Notch Filter Transfer Function</h2><p>The transfer function of a 2nd-order IIR notch filter is expressed as:</p>\[H(z) = \frac{1 - 2\cos(\omega_0)z^{-1} + z^{-2}}{1 - 2r\cos(\omega_0)z^{-1} + r^2 z^{-2}} \tag{2}\]<p>where \(\omega_0 = 2\pi f_0 / f_s\) is the normalized angular frequency and \(r\) is the pole radius (\(0 &lt; r &lt; 1\)).</p><h3 id=role-of-the-numerator-zeros>Role of the Numerator (Zeros)</h3><p>The numerator zeros are placed on the unit circle at \(z = e^{\pm j\omega_0}\). Since the zeros lie exactly on the unit circle, the transfer function gain at frequency \(\omega_0\) becomes <strong>exactly zero</strong>. This is the source of the notch filter&rsquo;s perfect rejection characteristic.</p><h3 id=role-of-the-denominator-poles>Role of the Denominator (Poles)</h3><p>The denominator poles are located at \(z = r \cdot e^{\pm j\omega_0}\), placed inside the unit circle at radius \(r &lt; 1\). The poles are at the same angle as the zeros but at a smaller radius. The closer \(r\) is to 1, the closer the poles are to the zeros, resulting in a narrower notch (higher \(Q\)).</p><h2 id=pole-zero-placement-and-quality-factor>Pole-Zero Placement and Quality Factor</h2><p>The relationship between the pole radius \(r\) and the quality factor \(Q\) is approximately:</p>\[Q \approx \frac{\omega_0}{2(1-r)} \tag{3}\]<p>Therefore, the bandwidth is:</p>\[\Delta f = \frac{f_0}{Q} \approx \frac{2(1-r) \cdot f_s}{2\pi} \tag{4}\]<p>The following code visualizes the pole-zero placement.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>scipy</span> <span class=kn>import</span> <span class=n>signal</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># --- Parameters ---</span>
</span></span><span class=line><span class=cl><span class=n>fs</span> <span class=o>=</span> <span class=mi>1000</span>       <span class=c1># Sampling frequency [Hz]</span>
</span></span><span class=line><span class=cl><span class=n>f0</span> <span class=o>=</span> <span class=mi>50</span>         <span class=c1># Notch frequency [Hz]</span>
</span></span><span class=line><span class=cl><span class=n>Q</span> <span class=o>=</span> <span class=mi>30</span>          <span class=c1># Quality factor</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># --- Design notch filter ---</span>
</span></span><span class=line><span class=cl><span class=n>b</span><span class=p>,</span> <span class=n>a</span> <span class=o>=</span> <span class=n>signal</span><span class=o>.</span><span class=n>iirnotch</span><span class=p>(</span><span class=n>f0</span><span class=p>,</span> <span class=n>Q</span><span class=p>,</span> <span class=n>fs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># --- Compute zeros and poles ---</span>
</span></span><span class=line><span class=cl><span class=n>zeros</span><span class=p>,</span> <span class=n>poles</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>signal</span><span class=o>.</span><span class=n>tf2zpk</span><span class=p>(</span><span class=n>b</span><span class=p>,</span> <span class=n>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># --- Pole-zero plot ---</span>
</span></span><span class=line><span class=cl><span class=n>fig</span><span class=p>,</span> <span class=n>ax</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>6</span><span class=p>,</span> <span class=mi>6</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Draw unit circle</span>
</span></span><span class=line><span class=cl><span class=n>theta</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=p>,</span> <span class=mi>200</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>theta</span><span class=p>),</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>theta</span><span class=p>),</span> <span class=s1>&#39;k-&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mf>0.5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Plot zeros and poles</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>zeros</span><span class=o>.</span><span class=n>real</span><span class=p>,</span> <span class=n>zeros</span><span class=o>.</span><span class=n>imag</span><span class=p>,</span> <span class=n>marker</span><span class=o>=</span><span class=s1>&#39;o&#39;</span><span class=p>,</span> <span class=n>s</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>
</span></span><span class=line><span class=cl>           <span class=n>facecolors</span><span class=o>=</span><span class=s1>&#39;none&#39;</span><span class=p>,</span> <span class=n>edgecolors</span><span class=o>=</span><span class=s1>&#39;blue&#39;</span><span class=p>,</span> <span class=n>linewidths</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Zeros&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>poles</span><span class=o>.</span><span class=n>real</span><span class=p>,</span> <span class=n>poles</span><span class=o>.</span><span class=n>imag</span><span class=p>,</span> <span class=n>marker</span><span class=o>=</span><span class=s1>&#39;x&#39;</span><span class=p>,</span> <span class=n>s</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>
</span></span><span class=line><span class=cl>           <span class=n>color</span><span class=o>=</span><span class=s1>&#39;red&#39;</span><span class=p>,</span> <span class=n>linewidths</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Poles&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;Real&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;Imaginary&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;Pole-Zero Plot (f0=</span><span class=si>{</span><span class=n>f0</span><span class=si>}</span><span class=s1> Hz, Q=</span><span class=si>{</span><span class=n>Q</span><span class=si>}</span><span class=s1>)&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>set_aspect</span><span class=p>(</span><span class=s1>&#39;equal&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>legend</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Display pole radius</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Pole radius r = </span><span class=si>{</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>poles</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Zero radius = </span><span class=si>{</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>zeros</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></div><p>In this plot, the zeros (circles) lie on the unit circle while the poles (crosses) are inside it. Both are at nearly the same angle, which ensures the gain remains close to 1 (0 dB) at frequencies away from the notch.</p><h2 id=designing-with-scipysignaliirnotch>Designing with scipy.signal.iirnotch</h2><p>SciPy&rsquo;s <code>scipy.signal.iirnotch</code> provides a concise way to design notch filters.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>scipy.signal</span> <span class=kn>import</span> <span class=n>iirnotch</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Parameters</span>
</span></span><span class=line><span class=cl><span class=n>f0</span> <span class=o>=</span> <span class=mi>50</span>   <span class=c1># Notch frequency [Hz]</span>
</span></span><span class=line><span class=cl><span class=n>Q</span> <span class=o>=</span> <span class=mi>30</span>    <span class=c1># Quality factor</span>
</span></span><span class=line><span class=cl><span class=n>fs</span> <span class=o>=</span> <span class=mi>1000</span> <span class=c1># Sampling frequency [Hz]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Compute filter coefficients</span>
</span></span><span class=line><span class=cl><span class=n>b</span><span class=p>,</span> <span class=n>a</span> <span class=o>=</span> <span class=n>iirnotch</span><span class=p>(</span><span class=n>f0</span><span class=p>,</span> <span class=n>Q</span><span class=p>,</span> <span class=n>fs</span><span class=p>)</span>
</span></span></code></pre></div><ul><li><code>f0</code>: frequency to reject [Hz]</li><li><code>Q</code>: quality factor (larger = narrower notch)</li><li><code>fs</code>: sampling frequency [Hz]</li><li>Returns: numerator coefficients <code>b</code>, denominator coefficients <code>a</code> (2nd-order IIR filter)</li></ul><p>The following code compares the frequency response for different \(Q\) values.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>scipy</span> <span class=kn>import</span> <span class=n>signal</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>fs</span> <span class=o>=</span> <span class=mi>1000</span>
</span></span><span class=line><span class=cl><span class=n>f0</span> <span class=o>=</span> <span class=mi>50</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>fig</span><span class=p>,</span> <span class=n>ax</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>6</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>Q</span> <span class=ow>in</span> <span class=p>[</span><span class=mi>5</span><span class=p>,</span> <span class=mi>15</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>60</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>    <span class=n>b</span><span class=p>,</span> <span class=n>a</span> <span class=o>=</span> <span class=n>signal</span><span class=o>.</span><span class=n>iirnotch</span><span class=p>(</span><span class=n>f0</span><span class=p>,</span> <span class=n>Q</span><span class=p>,</span> <span class=n>fs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>w</span><span class=p>,</span> <span class=n>h</span> <span class=o>=</span> <span class=n>signal</span><span class=o>.</span><span class=n>freqz</span><span class=p>(</span><span class=n>b</span><span class=p>,</span> <span class=n>a</span><span class=p>,</span> <span class=n>worN</span><span class=o>=</span><span class=mi>4096</span><span class=p>,</span> <span class=n>fs</span><span class=o>=</span><span class=n>fs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>ax</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>w</span><span class=p>,</span> <span class=mi>20</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>log10</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>maximum</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>h</span><span class=p>),</span> <span class=mf>1e-12</span><span class=p>)),</span>
</span></span><span class=line><span class=cl>            <span class=n>label</span><span class=o>=</span><span class=sa>f</span><span class=s1>&#39;Q = </span><span class=si>{</span><span class=n>Q</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;Frequency [Hz]&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;Magnitude [dB]&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;Notch Filter Frequency Response (f0 = 50 Hz)&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>set_xlim</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>200</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>set_ylim</span><span class=p>(</span><span class=o>-</span><span class=mi>60</span><span class=p>,</span> <span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>axvline</span><span class=p>(</span><span class=n>f0</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;gray&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;--&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=sa>f</span><span class=s1>&#39;f0 = </span><span class=si>{</span><span class=n>f0</span><span class=si>}</span><span class=s1> Hz&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>legend</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></div><p>A larger \(Q\) produces a narrower and sharper notch, enabling precise removal of only the target frequency.</p><h2 id=practical-implementation-power-line-noise-removal>Practical Implementation: Power Line Noise Removal</h2><p>Here is a complete code example for removing power line noise. In addition to the 50 Hz fundamental, harmonics at 100 Hz and 150 Hz are also removed using cascaded notch filters.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>scipy</span> <span class=kn>import</span> <span class=n>signal</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># --- Generate test signal ---</span>
</span></span><span class=line><span class=cl><span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>fs</span> <span class=o>=</span> <span class=mi>1000</span>           <span class=c1># Sampling frequency [Hz]</span>
</span></span><span class=line><span class=cl><span class=n>T</span> <span class=o>=</span> <span class=mf>2.0</span>             <span class=c1># Signal duration [s]</span>
</span></span><span class=line><span class=cl><span class=n>t</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>T</span><span class=p>,</span> <span class=mi>1</span><span class=o>/</span><span class=n>fs</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>N</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Useful signal: 10 Hz and 30 Hz sine waves</span>
</span></span><span class=line><span class=cl><span class=n>useful_signal</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span> <span class=o>*</span> <span class=mi>10</span> <span class=o>*</span> <span class=n>t</span><span class=p>)</span> <span class=o>+</span> <span class=mf>0.5</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span> <span class=o>*</span> <span class=mi>30</span> <span class=o>*</span> <span class=n>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Power line noise: 50 Hz fundamental + 100 Hz, 150 Hz harmonics</span>
</span></span><span class=line><span class=cl><span class=n>power_noise</span> <span class=o>=</span> <span class=p>(</span><span class=mf>0.8</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span> <span class=o>*</span> <span class=mi>50</span> <span class=o>*</span> <span class=n>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>               <span class=o>+</span> <span class=mf>0.4</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span> <span class=o>*</span> <span class=mi>100</span> <span class=o>*</span> <span class=n>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>               <span class=o>+</span> <span class=mf>0.2</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span> <span class=o>*</span> <span class=mi>150</span> <span class=o>*</span> <span class=n>t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Random noise</span>
</span></span><span class=line><span class=cl><span class=n>random_noise</span> <span class=o>=</span> <span class=mf>0.3</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=n>N</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Observed signal</span>
</span></span><span class=line><span class=cl><span class=n>observed</span> <span class=o>=</span> <span class=n>useful_signal</span> <span class=o>+</span> <span class=n>power_noise</span> <span class=o>+</span> <span class=n>random_noise</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># --- Cascaded notch filter design ---</span>
</span></span><span class=line><span class=cl><span class=n>Q</span> <span class=o>=</span> <span class=mi>30</span>
</span></span><span class=line><span class=cl><span class=n>notch_freqs</span> <span class=o>=</span> <span class=p>[</span><span class=mi>50</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>150</span><span class=p>]</span>  <span class=c1># Fundamental + harmonics</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Combine filter coefficients in SOS form</span>
</span></span><span class=line><span class=cl><span class=n>sos_list</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>f_notch</span> <span class=ow>in</span> <span class=n>notch_freqs</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>b</span><span class=p>,</span> <span class=n>a</span> <span class=o>=</span> <span class=n>signal</span><span class=o>.</span><span class=n>iirnotch</span><span class=p>(</span><span class=n>f_notch</span><span class=p>,</span> <span class=n>Q</span><span class=p>,</span> <span class=n>fs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sos</span> <span class=o>=</span> <span class=n>signal</span><span class=o>.</span><span class=n>tf2sos</span><span class=p>(</span><span class=n>b</span><span class=p>,</span> <span class=n>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sos_list</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>sos</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sos_cascade</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>sos_list</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># --- Apply filter (zero-phase filtering) ---</span>
</span></span><span class=line><span class=cl><span class=n>filtered</span> <span class=o>=</span> <span class=n>signal</span><span class=o>.</span><span class=n>sosfiltfilt</span><span class=p>(</span><span class=n>sos_cascade</span><span class=p>,</span> <span class=n>observed</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># --- Compute frequency spectrum ---</span>
</span></span><span class=line><span class=cl><span class=n>freqs</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>fft</span><span class=o>.</span><span class=n>rfftfreq</span><span class=p>(</span><span class=n>N</span><span class=p>,</span> <span class=mi>1</span><span class=o>/</span><span class=n>fs</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>spectrum_before</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>fft</span><span class=o>.</span><span class=n>rfft</span><span class=p>(</span><span class=n>observed</span><span class=p>))</span> <span class=o>/</span> <span class=n>N</span>
</span></span><span class=line><span class=cl><span class=n>spectrum_after</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>fft</span><span class=o>.</span><span class=n>rfft</span><span class=p>(</span><span class=n>filtered</span><span class=p>))</span> <span class=o>/</span> <span class=n>N</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># --- Plot ---</span>
</span></span><span class=line><span class=cl><span class=n>fig</span><span class=p>,</span> <span class=n>axes</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>10</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># (a) Time domain: before filtering</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>t</span><span class=p>,</span> <span class=n>observed</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.7</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Observed&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>t</span><span class=p>,</span> <span class=n>useful_signal</span><span class=p>,</span> <span class=s1>&#39;k--&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;True signal&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;Time [s]&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;Amplitude&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;Before Notch Filtering&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>set_xlim</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mf>0.5</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>legend</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># (b) Time domain: after filtering</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>t</span><span class=p>,</span> <span class=n>filtered</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.7</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Filtered&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>t</span><span class=p>,</span> <span class=n>useful_signal</span><span class=p>,</span> <span class=s1>&#39;k--&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;True signal&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;Time [s]&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;Amplitude&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;After Notch Filtering (50, 100, 150 Hz)&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>set_xlim</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mf>0.5</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>legend</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># (c) Frequency domain: before vs after</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>freqs</span><span class=p>,</span> <span class=mi>20</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>log10</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>maximum</span><span class=p>(</span><span class=n>spectrum_before</span><span class=p>,</span> <span class=mf>1e-12</span><span class=p>)),</span>
</span></span><span class=line><span class=cl>             <span class=n>alpha</span><span class=o>=</span><span class=mf>0.7</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Before&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>freqs</span><span class=p>,</span> <span class=mi>20</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>log10</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>maximum</span><span class=p>(</span><span class=n>spectrum_after</span><span class=p>,</span> <span class=mf>1e-12</span><span class=p>)),</span>
</span></span><span class=line><span class=cl>             <span class=n>alpha</span><span class=o>=</span><span class=mf>0.7</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;After&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>f_notch</span> <span class=ow>in</span> <span class=n>notch_freqs</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>axes</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=o>.</span><span class=n>axvline</span><span class=p>(</span><span class=n>f_notch</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;red&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;--&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;Frequency [Hz]&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;Magnitude [dB]&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;Frequency Spectrum: Before vs After&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=o>.</span><span class=n>set_xlim</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>200</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=o>.</span><span class=n>legend</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></div><p>In the time domain, the filtered signal closely matches the original useful signal (10 Hz + 30 Hz). In the frequency domain, the peaks at 50 Hz, 100 Hz, and 150 Hz are removed while the 10 Hz and 30 Hz components are preserved.</p><h2 id=design-considerations>Design Considerations</h2><h3 id=choosing-the-quality-factor-q>Choosing the Quality Factor Q</h3><ul><li><strong>Q too large</strong>: The notch becomes extremely narrow and cannot accommodate slight frequency variations. Transient ringing also becomes more pronounced.</li><li><strong>Q too small</strong>: The notch becomes too wide, removing useful signal components near the target frequency.</li></ul><p>In practice, \(Q = 20 \sim 50\) is suitable for power line noise removal.</p><h3 id=zero-phase-vs-causal-filtering>Zero-Phase vs Causal Filtering</h3><ul><li><strong>Offline processing</strong>: Use <code>scipy.signal.sosfiltfilt</code> (zero-phase). Forward and reverse filtering eliminates phase distortion.</li><li><strong>Real-time processing</strong>: Use <code>scipy.signal.sosfilt</code> (causal filter). Phase delay occurs since future data cannot be referenced, but sequential processing is possible.</li></ul><h3 id=stability>Stability</h3><p>An IIR notch filter is always stable when the pole radius \(r &lt; 1\). Filters designed with <code>scipy.signal.iirnotch</code> automatically satisfy this condition, so stability does not need to be verified separately.</p><h2 id=notch-filter-vs-bandstop-filter>Notch Filter vs Bandstop Filter</h2><p>A notch filter is a special case of a band-reject filter, but the two serve different purposes.</p><table><thead><tr><th>Property</th><th>Notch Filter</th><th>Bandstop Filter</th></tr></thead><tbody><tr><td>Rejection band</td><td>Very narrow (single frequency)</td><td>Relatively wide band</td></tr><tr><td>Order</td><td>Achievable with 2nd order</td><td>May require higher order</td></tr><tr><td>Use case</td><td>Power line noise, specific interferers</td><td>Removing an entire frequency band</td></tr><tr><td>Design</td><td><code>iirnotch</code></td><td><code>butter</code> + <code>btype='bandstop'</code></td></tr></tbody></table><p>The following code compares the frequency responses of both approaches.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>scipy</span> <span class=kn>import</span> <span class=n>signal</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>fs</span> <span class=o>=</span> <span class=mi>1000</span>
</span></span><span class=line><span class=cl><span class=n>f0</span> <span class=o>=</span> <span class=mi>50</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Notch filter (Q=30)</span>
</span></span><span class=line><span class=cl><span class=n>b_notch</span><span class=p>,</span> <span class=n>a_notch</span> <span class=o>=</span> <span class=n>signal</span><span class=o>.</span><span class=n>iirnotch</span><span class=p>(</span><span class=n>f0</span><span class=p>,</span> <span class=n>Q</span><span class=o>=</span><span class=mi>30</span><span class=p>,</span> <span class=n>fs</span><span class=o>=</span><span class=n>fs</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>w_notch</span><span class=p>,</span> <span class=n>h_notch</span> <span class=o>=</span> <span class=n>signal</span><span class=o>.</span><span class=n>freqz</span><span class=p>(</span><span class=n>b_notch</span><span class=p>,</span> <span class=n>a_notch</span><span class=p>,</span> <span class=n>worN</span><span class=o>=</span><span class=mi>4096</span><span class=p>,</span> <span class=n>fs</span><span class=o>=</span><span class=n>fs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Bandstop filter (Butterworth 4th order, 40-60 Hz rejection)</span>
</span></span><span class=line><span class=cl><span class=n>sos_bs</span> <span class=o>=</span> <span class=n>signal</span><span class=o>.</span><span class=n>butter</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=p>[</span><span class=mi>40</span><span class=p>,</span> <span class=mi>60</span><span class=p>],</span> <span class=n>btype</span><span class=o>=</span><span class=s1>&#39;bandstop&#39;</span><span class=p>,</span> <span class=n>fs</span><span class=o>=</span><span class=n>fs</span><span class=p>,</span> <span class=n>output</span><span class=o>=</span><span class=s1>&#39;sos&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>w_bs</span><span class=p>,</span> <span class=n>h_bs</span> <span class=o>=</span> <span class=n>signal</span><span class=o>.</span><span class=n>sosfreqz</span><span class=p>(</span><span class=n>sos_bs</span><span class=p>,</span> <span class=n>worN</span><span class=o>=</span><span class=mi>4096</span><span class=p>,</span> <span class=n>fs</span><span class=o>=</span><span class=n>fs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>fig</span><span class=p>,</span> <span class=n>ax</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>6</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>w_notch</span><span class=p>,</span> <span class=mi>20</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>log10</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>maximum</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>h_notch</span><span class=p>),</span> <span class=mf>1e-12</span><span class=p>)),</span>
</span></span><span class=line><span class=cl>        <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Notch (Q=30)&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>w_bs</span><span class=p>,</span> <span class=mi>20</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>log10</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>maximum</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>h_bs</span><span class=p>),</span> <span class=mf>1e-12</span><span class=p>)),</span>
</span></span><span class=line><span class=cl>        <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Bandstop Butterworth (40-60 Hz)&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;Frequency [Hz]&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;Magnitude [dB]&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;Notch Filter vs Bandstop Filter&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>set_xlim</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>200</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>set_ylim</span><span class=p>(</span><span class=o>-</span><span class=mi>60</span><span class=p>,</span> <span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>axvline</span><span class=p>(</span><span class=n>f0</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;gray&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;--&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.5</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>legend</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></div><p>The notch filter removes only 50 Hz precisely, while the bandstop filter suppresses the entire 40-60 Hz band. Use a notch filter when the frequency to remove is well-defined, and a bandstop filter when a broader band needs to be suppressed.</p><h2 id=summary>Summary</h2><ul><li>A <strong>notch filter</strong> is a special case of a band-reject filter that removes only a specific frequency, ideal for power line noise removal</li><li>The 2nd-order IIR transfer function uses <strong>zeros</strong> on the unit circle to achieve perfect rejection at the notch frequency, and <strong>poles</strong> inside the unit circle to control the notch width</li><li>The <strong>quality factor</strong> \(Q\) determines notch sharpness; \(Q = 20 \sim 50\) is practical for power line noise removal</li><li><code>scipy.signal.iirnotch</code> provides a concise design interface, and cascaded connections handle harmonics (100 Hz, 150 Hz, etc.)</li><li>Use <code>sosfiltfilt</code> (zero-phase) for offline processing and <code>sosfilt</code> (causal) for real-time processing</li></ul><h2 id=related-articles>Related Articles</h2><ul><li><a href=https://yuhi-sa.github.io/en/posts/20260225_fft/1/>FFT Algorithm and Python Implementation</a> - Covers the fundamentals for verifying notch filter effects using FFT.</li><li><a href=https://yuhi-sa.github.io/en/posts/20260226_fir_iir/1/>FIR vs IIR Filters</a> - Explains the characteristics of IIR filters, the class to which notch filters belong.</li><li><a href=https://yuhi-sa.github.io/en/posts/20260226_butterworth/1/>Butterworth Filter Design and Python Implementation</a> - Covers lowpass/highpass/bandpass filter design techniques.</li><li><a href=https://yuhi-sa.github.io/en/posts/20220206_ema/1/>Exponential Moving Average (EMA) Filter Frequency Response</a> - Explains the fundamentals of transfer functions and frequency response.</li><li><a href=https://yuhi-sa.github.io/en/posts/20260223_lowpass_filter/1/>Lowpass Filter Design and Comparison</a> - Compares frequency responses of various lowpass filters.</li><li><a href=https://yuhi-sa.github.io/en/posts/20260228_fft_window_psd/1/>Window Functions and Power Spectral Density (PSD)</a> - Covers PSD analysis techniques useful for evaluating notch filter performance.</li></ul><h2 id=references>References</h2><ul><li>Oppenheim, A. V., & Schafer, R. W. (2009). <em>Discrete-Time Signal Processing</em> (3rd ed.). Prentice Hall.</li><li>Haykin, S., & Van Veen, B. (2002). <em>Signals and Systems</em> (2nd ed.). Wiley.</li><li><a href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.iirnotch.html>SciPy signal.iirnotch documentation</a></li><li><a href=https://docs.scipy.org/doc/scipy/reference/signal.html>SciPy Signal Processing documentation</a></li></ul></div><div class="ad-slot in-content my-3"><ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=fluid data-ad-client=ca-pub-9558545098866170></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><footer class=article-footer></footer><meta itemprop=wordCount content="1776"><meta itemprop=url content="https://yuhi-sa.github.io/en/posts/20260228_notch_filter/1/"></article><nav class="post-nav mt-5" aria-label="Post navigation"><a href=/en/posts/20260228_timeseries_anomaly/1/ class="post-nav__item post-nav__item--prev"><span class="post-nav__label text-muted"><i class="fas fa-arrow-left me-1" aria-hidden=true></i>前の記事
</span><span class=post-nav__title>Time-Series Anomaly Detection: From Statistical Methods to Kalman Filter in Python</span>
</a><a href=/en/posts/20260228_self_attention/1/ class="post-nav__item post-nav__item--next"><span class="post-nav__label text-muted">次の記事<i class="fas fa-arrow-right ms-1" aria-hidden=true></i>
</span><span class=post-nav__title>Understanding Self-Attention from Scratch: Math and Python Implementation</span></a></nav><section class="related-posts mt-5" aria-label="Related posts"><h2 class=related-posts__title>関連記事</h2><div class=related-posts__grid><article class=related-posts__item><h3 class=related-posts__item-title><a href=/en/posts/20260228_timeseries_anomaly/1/>Time-Series Anomaly Detection: From Statistical Methods to Kalman Filter in Python</a></h3><div class=card-meta><time datetime=2026-02-28>February 28, 2026</time></div></article><article class=related-posts__item><h3 class=related-posts__item-title><a href=/en/posts/20260226_wiener_filter/1/>Wiener Filter: Optimal Linear Filtering Theory and Python Implementation</a></h3><div class=card-meta><time datetime=2026-02-26>February 26, 2026</time></div></article><article class=related-posts__item><h3 class=related-posts__item-title><a href=/en/posts/20260225_moving_average/1/>Moving Average Filters Compared: SMA, WMA, and EMA in Python</a></h3><div class=card-meta><time datetime=2026-02-25>February 25, 2026</time></div></article></div></section><nav class="article-navigation mt-4" aria-label="Article navigation"><a href=/en/posts/ class="btn btn-outline-secondary btn-sm mb-3"><i class="fas fa-arrow-left me-1" aria-hidden=true></i>
Back to posts</a><nav aria-label="Breadcrumb navigation" class=breadcrumb-nav role=navigation><ol class=breadcrumb itemscope itemtype=https://schema.org/BreadcrumbList><li class=breadcrumb-item itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a href=/en/ itemprop=item aria-label="Navigate to homepage"><i class="fas fa-home" aria-hidden=true></i>
<span itemprop=name>tomato blog</span>
</a><meta itemprop=position content="1"></li><li class=breadcrumb-item itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a href=https://yuhi-sa.github.io/en/ itemprop=item aria-label="Navigate to tomato blog"><span itemprop=name>tomato blog</span>
</a><meta itemprop=position content="2"></li><li class=breadcrumb-item itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a href=https://yuhi-sa.github.io/en/posts/ itemprop=item aria-label="Navigate to Posts"><span itemprop=name>Posts</span>
</a><meta itemprop=position content="3"></li><li class="breadcrumb-item active" aria-current=page itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><span itemprop=name>Notch Filter Design and Python Implementation: Removing Power Line Noise</span>
<meta itemprop=position content="4"></li></ol></nav></nav></div></div></div></main><footer role=contentinfo class=site-footer><div class="container pt-4 pb-3" style="border-top:2px solid var(--accent,#e54d2e)"><div class="row justify-content-center"><div class="col-md-8 text-center"><p class="copyright-text text-muted mb-2">&copy; 2026 yuhi-sa. All rights reserved.</p><p class="theme-attribution text-muted small mt-2 mb-0">Powered by
<a href=https://gohugo.io/ target=_blank rel=noopener class=text-decoration-none>Hugo</a>
with
<a href=https://github.com/yuhi-sa/tomatohugo target=_blank rel=noopener class=text-decoration-none>TomatoHugo</a></p></div></div></div></footer><script src=https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js integrity=sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz crossorigin=anonymous defer></script><script src=/js/dark-mode.min.3e457dc8346f064bee795e6f9b73e1516dcd059e750c521fe4b445f9ea9a7821.js integrity="sha256-PkV9yDRvBkvueV5vm3PhUW3NBZ51DFIf5LRF+eqaeCE=" defer></script><script>window.addEventListener("load",function(){const e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-LN6QP6VVM3",document.head.appendChild(e),e.onload=function(){window.dataLayer=window.dataLayer||[];function e(){dataLayer.push(arguments)}e("js",new Date),e("config","G-LN6QP6VVM3")}})</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"WebPage","name":"Notch Filter Design and Python Implementation: Removing Power Line Noise","url":"https:\/\/yuhi-sa.github.io\/en\/posts\/20260228_notch_filter\/1\/","description":"A practical guide to notch (band-reject) filter design for removing 50\/60 Hz power line noise, with IIR notch filter theory, pole-zero analysis, and Python implementation using scipy.signal.iirnotch.","inLanguage":"en","isPartOf":{"@type":"WebSite","name":"tomato blog","url":"https:\/\/yuhi-sa.github.io\/"}}</script></body></html>