<!doctype html><html lang=en dir=ltr data-theme=light><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=theme-color content="#e74c3c"><meta name=format-detection content="telephone=no"><meta name=robots content="index,follow"><meta name=description content="Implement PID control in Python, simulate with a first-order system, compare P/PI/PID responses, and explore Ziegler-Nichols tuning."><meta name=author content="yuhi-sa"><link rel=canonical href=https://yuhi-sa.github.io/en/posts/20260225_pid_impl/1/><meta property="og:type" content="article"><meta property="og:title" content="PID Control in Python: Simulation and Tuning"><meta property="og:description" content="Implement PID control in Python, simulate with a first-order system, compare P/PI/PID responses, and explore Ziegler-Nichols tuning."><meta property="og:url" content="https://yuhi-sa.github.io/en/posts/20260225_pid_impl/1/"><meta property="og:site_name" content="tomato blog"><meta property="og:locale" content="en"><meta property="og:image" content="https://yuhi-sa.github.io/ogp.jpeg"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta property="article:published_time" content="2026-02-25T13:00:00+09:00"><meta property="article:modified_time" content="2026-02-25T21:50:22+09:00"><meta property="article:tag" content="Control"><meta property="article:tag" content="Python"><meta property="article:tag" content="Simulation"><meta property="article:section" content="posts"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="PID Control in Python: Simulation and Tuning"><meta name=twitter:description content="Implement PID control in Python, simulate with a first-order system, compare P/PI/PID responses, and explore Ziegler-Nichols tuning."><meta name=twitter:image content="https://yuhi-sa.github.io/ogp.jpeg"><title>PID Control in Python: Simulation and Tuning | tomato blog</title><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preconnect href=https://cdn.jsdelivr.net crossorigin><link rel=preconnect href=https://pagead2.googlesyndication.com crossorigin><link rel=dns-prefetch href=https://pagead2.googlesyndication.com><link rel=icon href=https://yuhi-sa.github.io/favicon.ico><link rel=alternate hreflang=ja href=https://yuhi-sa.github.io/posts/20260225_pid_impl/1/><link rel=alternate hreflang=en href=https://yuhi-sa.github.io/en/posts/20260225_pid_impl/1/><link rel=alternate hreflang=x-default href=https://yuhi-sa.github.io/en/posts/20260225_pid_impl/1/><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"PID Control in Python: Simulation and Tuning","description":"Implement PID control in Python, simulate with a first-order system, compare P\/PI\/PID responses, and explore Ziegler-Nichols tuning.","author":{"@type":"Person","name":"yuhi-sa","url":"https:\/\/yuhi-sa.github.io\/"},"publisher":{"@type":"Organization","name":"tomato blog","logo":{"@type":"ImageObject","url":"https:\/\/yuhi-sa.github.io\/ogp.jpeg"},"url":"https:\/\/yuhi-sa.github.io\/"},"datePublished":"2026-02-25T13:00:00\u002b09:00","dateModified":"2026-02-25T21:50:22\u002b09:00","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/yuhi-sa.github.io\/en\/posts\/20260225_pid_impl\/1\/"},"url":"https:\/\/yuhi-sa.github.io\/en\/posts\/20260225_pid_impl\/1\/","wordCount":1491,"keywords":["Control","Python","Simulation"],"articleSection":"Posts","inLanguage":"en","timeRequired":"PT7M"}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"tomato blog","item":"https:\/\/yuhi-sa.github.io\/en\/"},{"@type":"ListItem","position":2,"name":"Posts","item":"https:\/\/yuhi-sa.github.io\/en\/posts\/"},{"@type":"ListItem","position":3,"name":"PID Control in Python: Simulation and Tuning"}]}</script><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin=anonymous referrerpolicy=no-referrer><link href=https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css rel=stylesheet integrity=sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH crossorigin=anonymous><link rel=stylesheet href=/css/variables.min.72a177faa7b12de55dcc39c4ab6b6392116718d5e2735dab0214511354ecb973.css integrity="sha256-cqF3+qexLeVdzDnEq2tjkhFnGNXic12rAhRRE1TsuXM=" crossorigin=anonymous><link rel=stylesheet href=/css/main.min.403a82b29e94ee6e7a39204b5082cdf8b4966cfb44115390da7d8867a5006acd.css integrity="sha256-QDqCsp6U7m56OSBLUILN+LSWbPtEEVOQ2n2IZ6UAas0=" crossorigin=anonymous><link rel=stylesheet href=/css/syntax.min.e379066489e20d5433ca35ac1f468fd9e8859705a62d77a79bb7379ac3613848.css integrity="sha256-43kGZIniDVQzyjWsH0aP2eiFlwWmLXenm7c3msNhOEg=" crossorigin=anonymous><style>body{font-family:-apple-system,BlinkMacSystemFont,inter,segoe ui,Roboto,sans-serif;line-height:1.5;color:#000;background:#fff}[data-theme=dark] body{color:#fff;background:#000}.container{max-width:768px;margin:0 auto;padding:0 1rem}</style><script src=https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js integrity=sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz crossorigin=anonymous defer></script><script src=/js/dark-mode.min.3e457dc8346f064bee795e6f9b73e1516dcd059e750c521fe4b445f9ea9a7821.js integrity="sha256-PkV9yDRvBkvueV5vm3PhUW3NBZ51DFIf5LRF+eqaeCE=" defer></script><script>window.addEventListener("load",function(){const e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-LN6QP6VVM3",document.head.appendChild(e),e.onload=function(){window.dataLayer=window.dataLayer||[];function e(){dataLayer.push(arguments)}e("js",new Date),e("config","G-LN6QP6VVM3")}})</script><script>window.MathJax={tex:{inlineMath:[["\\(","\\)"]],displayMath:[["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre","code"],ignoreHtmlClass:"tex2jax_ignore",processHtmlClass:"tex2jax_process"}}</script><script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js id=mathjax-script async></script></head><body itemscope itemtype=https://schema.org/WebPage class=theme-tomatohugo><a href=#main-content class="skip-link sr-only sr-only-focusable" aria-label="Skip to main content">Skip to main content</a><header role=banner class=site-header><nav class="navbar navbar-expand-lg navbar-light bg-light" role=navigation aria-label="Main navigation"><div class=container><a class=navbar-brand href=https://yuhi-sa.github.io/ aria-label="Return to tomato blog homepage">tomato blog
</a><button class="navbar-toggler d-lg-none" type=button data-bs-toggle=collapse data-bs-target=#navbarNav aria-controls=navbarNav aria-expanded=false aria-label="Toggle navigation menu">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarNav><ul class="navbar-nav ms-auto" role=menubar><li class=nav-item role=none><a class=nav-link href=https://yuhi-sa.github.io/en/ role=menuitem aria-label="Navigate to Blog">Blog</a></li><li class=nav-item role=none><a class=nav-link href=https://yuhi-sa.github.io/en/tags/ role=menuitem aria-label="Navigate to Tags">Tags</a></li><li class=nav-item role=none><a class=nav-link href=https://yuhi-sa.github.io/en/posts/about/ role=menuitem aria-label="Navigate to About">About</a></li><li class=nav-item role=none><a class=nav-link href=https://yuhi-sa.github.io/en/posts/privacy_policy/ role=menuitem aria-label="Navigate to Privacy policy">Privacy policy</a></li><li class=nav-item role=none><button id=darkModeToggle class="nav-link btn btn-link border-0" type=button role=menuitem aria-label="Toggle dark mode" title="Switch between light and dark themes">
<i class="fas fa-moon" id=darkModeIcon aria-hidden=true></i>
<span class="d-lg-none ms-2">ダークモード</span></button></li></ul></div></div></nav><script data-ad-client=ca-pub-9558545098866170 async crossorigin=anonymous src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></header><main id=main-content role=main class=site-main aria-label="Main content"><div class="container mt-4"><div class="row justify-content-center"><div class=col-lg-8><article itemscope itemtype=https://schema.org/Article><header class=article-header><h1 itemprop=headline>PID Control in Python: Simulation and Tuning</h1><p class="lead article-description" itemprop=description>Implement PID control in Python, simulate with a first-order system, compare P/PI/PID responses, and explore Ziegler-Nichols tuning.</p><div class=article-meta><time datetime=2026-02-25T13:00:00+09:00 itemprop=datePublished><i class="far fa-calendar-alt me-1" aria-hidden=true></i>
February 25, 2026
</time><time datetime=2026-02-25T21:50:22+09:00 itemprop=dateModified class=ms-3><i class="far fa-edit me-1" aria-hidden=true></i>
Updated
February 25, 2026
</time><span aria-label="Reading time" class=ms-3><i class="far fa-clock me-1" aria-hidden=true></i>
7 min read</span></div><div class=article-tags role=group aria-label="Article tags"><a href=/en/tags/control/ class="badge badge-custom text-decoration-none me-1" rel=tag itemprop=keywords>Control
</a><a href=/en/tags/python/ class="badge badge-custom text-decoration-none me-1" rel=tag itemprop=keywords>Python
</a><a href=/en/tags/simulation/ class="badge badge-custom text-decoration-none me-1" rel=tag itemprop=keywords>Simulation</a></div></header><div class=article-content itemprop=articleBody><h2 id=introduction>Introduction</h2><p>PID control is the most widely used feedback control method in industry. It appears in temperature control, motor control, process control, and countless other applications.</p><p>For the theoretical foundations of PID control, see <a href=https://yuhi-sa.github.io/en/posts/20210318_pid/1/>Fundamentals of PID Control and the Role of Each Component</a>. In this article, we implement a PID controller in Python, simulate its behavior with a first-order system, compare P/PI/PID step responses, and introduce the classical Ziegler-Nichols tuning method.</p><h2 id=implementing-a-discrete-pid-controller>Implementing a Discrete PID Controller</h2><p>The continuous-time PID control law is expressed as:</p>\[
u(t) = K_P e(t) + K_I \int_0^t e(\tau)d\tau + K_D \frac{de(t)}{dt}
\]<p>where \(e(t) = r(t) - y(t)\) is the error between the setpoint and the output. For computer implementation, we approximate the integral with a cumulative sum and the derivative with a backward difference, yielding the discrete PID control law:</p>\[
u[k] = K_P e[k] + K_I \Delta t \sum_{i=0}^{k} e[i] + K_D \frac{e[k] - e[k-1]}{\Delta t} \tag{1}
\]<p>where \(\Delta t\) is the sampling period.</p><p>The following Python implementation includes output limiting and anti-windup.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>PIDController</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>kp</span><span class=p>,</span> <span class=n>ki</span><span class=p>,</span> <span class=n>kd</span><span class=p>,</span> <span class=n>dt</span><span class=p>,</span> <span class=n>output_limits</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>kp</span> <span class=o>=</span> <span class=n>kp</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>ki</span> <span class=o>=</span> <span class=n>ki</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>kd</span> <span class=o>=</span> <span class=n>kd</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>dt</span> <span class=o>=</span> <span class=n>dt</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>output_limits</span> <span class=o>=</span> <span class=n>output_limits</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>integral</span> <span class=o>=</span> <span class=mf>0.0</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>prev_error</span> <span class=o>=</span> <span class=mf>0.0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>update</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>setpoint</span><span class=p>,</span> <span class=n>measured</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>error</span> <span class=o>=</span> <span class=n>setpoint</span> <span class=o>-</span> <span class=n>measured</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Proportional term</span>
</span></span><span class=line><span class=cl>        <span class=n>p_term</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>kp</span> <span class=o>*</span> <span class=n>error</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Integral term (cumulative sum approximation)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>integral</span> <span class=o>+=</span> <span class=n>error</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>dt</span>
</span></span><span class=line><span class=cl>        <span class=n>i_term</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>ki</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>integral</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Derivative term (backward difference approximation)</span>
</span></span><span class=line><span class=cl>        <span class=n>derivative</span> <span class=o>=</span> <span class=p>(</span><span class=n>error</span> <span class=o>-</span> <span class=bp>self</span><span class=o>.</span><span class=n>prev_error</span><span class=p>)</span> <span class=o>/</span> <span class=bp>self</span><span class=o>.</span><span class=n>dt</span>
</span></span><span class=line><span class=cl>        <span class=n>d_term</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>kd</span> <span class=o>*</span> <span class=n>derivative</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>prev_error</span> <span class=o>=</span> <span class=n>error</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>output</span> <span class=o>=</span> <span class=n>p_term</span> <span class=o>+</span> <span class=n>i_term</span> <span class=o>+</span> <span class=n>d_term</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Output limiting (anti-windup)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>output_limits</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>lo</span><span class=p>,</span> <span class=n>hi</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>output_limits</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>output</span> <span class=o>&gt;</span> <span class=n>hi</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>output</span> <span class=o>=</span> <span class=n>hi</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>integral</span> <span class=o>-=</span> <span class=n>error</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>dt</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>output</span> <span class=o>&lt;</span> <span class=n>lo</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>output</span> <span class=o>=</span> <span class=n>lo</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>integral</span> <span class=o>-=</span> <span class=n>error</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>dt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>output</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>reset</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>integral</span> <span class=o>=</span> <span class=mf>0.0</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>prev_error</span> <span class=o>=</span> <span class=mf>0.0</span>
</span></span></code></pre></div><p>The anti-windup mechanism stops the integral term from accumulating when the output reaches its limits. Without it, the integral value would grow unboundedly during saturation, causing a large overshoot when the constraint is released.</p><h2 id=plant-model>Plant Model</h2><p>We use a first-order system as the plant for simulation. Its transfer function is:</p>\[
G(s) = \frac{K}{1 + Ts} \tag{2}
\]<p>where \(K\) is the process gain and \(T\) is the time constant. Discretizing this differential equation gives the following update rule:</p>\[
y[k+1] = y[k] + \frac{\Delta t}{T}(K \cdot u[k] - y[k]) \tag{3}
\]<p>The Python implementation is as follows.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>FirstOrderSystem</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>gain</span><span class=p>,</span> <span class=n>time_constant</span><span class=p>,</span> <span class=n>dt</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>gain</span> <span class=o>=</span> <span class=n>gain</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>time_constant</span> <span class=o>=</span> <span class=n>time_constant</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>dt</span> <span class=o>=</span> <span class=n>dt</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>y</span> <span class=o>=</span> <span class=mf>0.0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>update</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>u</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>y</span> <span class=o>+=</span> <span class=bp>self</span><span class=o>.</span><span class=n>dt</span> <span class=o>/</span> <span class=bp>self</span><span class=o>.</span><span class=n>time_constant</span> <span class=o>*</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>gain</span> <span class=o>*</span> <span class=n>u</span> <span class=o>-</span> <span class=bp>self</span><span class=o>.</span><span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>y</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>reset</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>y</span> <span class=o>=</span> <span class=mf>0.0</span>
</span></span></code></pre></div><h2 id=comparing-p-pi-and-pid-step-responses>Comparing P, PI, and PID Step Responses</h2><p>We compare the step responses of three controller types. The plant has \(K=1.0\) and \(T=1.0\).</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>dt</span> <span class=o>=</span> <span class=mf>0.01</span>
</span></span><span class=line><span class=cl><span class=n>t_end</span> <span class=o>=</span> <span class=mf>10.0</span>
</span></span><span class=line><span class=cl><span class=n>t</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>t_end</span><span class=p>,</span> <span class=n>dt</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>setpoint</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>ones_like</span><span class=p>(</span><span class=n>t</span><span class=p>)</span>  <span class=c1># Step input</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plant_params</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;gain&#39;</span><span class=p>:</span> <span class=mf>1.0</span><span class=p>,</span> <span class=s1>&#39;time_constant&#39;</span><span class=p>:</span> <span class=mf>1.0</span><span class=p>,</span> <span class=s1>&#39;dt&#39;</span><span class=p>:</span> <span class=n>dt</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>configs</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=s1>&#39;P control (Kp=2.0)&#39;</span><span class=p>,</span> <span class=p>{</span><span class=s1>&#39;kp&#39;</span><span class=p>:</span> <span class=mf>2.0</span><span class=p>,</span> <span class=s1>&#39;ki&#39;</span><span class=p>:</span> <span class=mf>0.0</span><span class=p>,</span> <span class=s1>&#39;kd&#39;</span><span class=p>:</span> <span class=mf>0.0</span><span class=p>}),</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=s1>&#39;PI control (Kp=2.0, Ki=1.0)&#39;</span><span class=p>,</span> <span class=p>{</span><span class=s1>&#39;kp&#39;</span><span class=p>:</span> <span class=mf>2.0</span><span class=p>,</span> <span class=s1>&#39;ki&#39;</span><span class=p>:</span> <span class=mf>1.0</span><span class=p>,</span> <span class=s1>&#39;kd&#39;</span><span class=p>:</span> <span class=mf>0.0</span><span class=p>}),</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=s1>&#39;PID control (Kp=2.0, Ki=1.0, Kd=0.5)&#39;</span><span class=p>,</span> <span class=p>{</span><span class=s1>&#39;kp&#39;</span><span class=p>:</span> <span class=mf>2.0</span><span class=p>,</span> <span class=s1>&#39;ki&#39;</span><span class=p>:</span> <span class=mf>1.0</span><span class=p>,</span> <span class=s1>&#39;kd&#39;</span><span class=p>:</span> <span class=mf>0.5</span><span class=p>}),</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>fig</span><span class=p>,</span> <span class=n>axes</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>8</span><span class=p>),</span> <span class=n>sharex</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>label</span><span class=p>,</span> <span class=n>params</span> <span class=ow>in</span> <span class=n>configs</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>pid</span> <span class=o>=</span> <span class=n>PIDController</span><span class=p>(</span><span class=o>**</span><span class=n>params</span><span class=p>,</span> <span class=n>dt</span><span class=o>=</span><span class=n>dt</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plant</span> <span class=o>=</span> <span class=n>FirstOrderSystem</span><span class=p>(</span><span class=o>**</span><span class=n>plant_params</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>y_hist</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=n>u_hist</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>sp</span> <span class=ow>in</span> <span class=n>setpoint</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>u</span> <span class=o>=</span> <span class=n>pid</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>sp</span><span class=p>,</span> <span class=n>plant</span><span class=o>.</span><span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>y</span> <span class=o>=</span> <span class=n>plant</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>u</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>y_hist</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>u_hist</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>u</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>t</span><span class=p>,</span> <span class=n>y_hist</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=n>label</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>axes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>t</span><span class=p>,</span> <span class=n>u_hist</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=n>label</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>axhline</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;k&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;--&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Setpoint&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;Output y(t)&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;Step Response Comparison&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>legend</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;Control input u(t)&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;Time [s]&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>legend</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></div><p>From the simulation results, the following characteristics can be observed:</p><ul><li><strong>P control</strong>: The response is fast, but a steady-state error remains. With \(K_P = 2.0\), the theoretical steady-state error is \(\frac{1}{1 + K \cdot K_P} = \frac{1}{3} \approx 0.33\).</li><li><strong>PI control</strong>: The integral term eliminates the steady-state error. However, overshoot tends to increase.</li><li><strong>PID control</strong>: The derivative term suppresses overshoot, achieving both the fast response of P control and the steady-state accuracy of PI control.</li></ul><h2 id=effect-of-gain-parameters>Effect of Gain Parameters</h2><p>The setting of each gain parameter significantly affects control performance.</p><h3 id=excessive-proportional-gain>Excessive Proportional Gain \(K_P\)</h3><p>Setting \(K_P\) too large makes the response oscillatory and eventually unstable. For example, with P control at \(K_P = 10.0\), the output oscillates around the setpoint.</p><h3 id=integral-gain--and-windup>Integral Gain \(K_I\) and Windup</h3><p>When \(K_I\) is large or the control output is constrained, the integral term can accumulate excessively, a phenomenon called &ldquo;windup.&rdquo; While the output is saturated, the integral value keeps growing, causing a large overshoot after the constraint is released. The anti-windup mechanism described earlier mitigates this problem.</p><h3 id=derivative-gain--and-noise-sensitivity>Derivative Gain \(K_D\) and Noise Sensitivity</h3><p>Since the derivative term uses the rate of change of the error, it is sensitive to measurement noise. Setting a large \(K_D\) on a noisy signal causes rapid fluctuations in the control output. In practice, a low-pass filter on the derivative input, known as &ldquo;filtered derivative,&rdquo; is commonly used.</p><h3 id=parameter-tuning-guidelines>Parameter Tuning Guidelines</h3><table><thead><tr><th>Parameter</th><th>Effect of Increasing</th><th>Caution</th></tr></thead><tbody><tr><td>\(K_P\)</td><td>Faster response, reduced steady-state error</td><td>Oscillation and instability if too large</td></tr><tr><td>\(K_I\)</td><td>Eliminates steady-state error</td><td>Increased overshoot, windup</td></tr><tr><td>\(K_D\)</td><td>Suppresses overshoot, improves response</td><td>Sensitive to noise</td></tr></tbody></table><h2 id=ziegler-nichols-tuning-method>Ziegler-Nichols Tuning Method</h2><p>The Ziegler-Nichols method is a classical approach for empirically determining PID gains from the plant&rsquo;s step response characteristics. Here we introduce the step response method (open-loop method).</p><h3 id=step-response-method>Step Response Method</h3><p>A step input is applied to the plant, and the following three parameters are read from the response curve:</p><ul><li>\(K\): Process gain (steady-state value / input value)</li><li>\(L\): Dead time (delay before the response begins)</li><li>\(T\): Time constant (time from the inflection point tangent to reaching the steady-state value)</li></ul><p>Based on these parameters, PID gains are calculated using the following table.</p><table><thead><tr><th>Controller</th><th>\(K_P\)</th><th>\(T_I\)</th><th>\(T_D\)</th></tr></thead><tbody><tr><td>P</td><td>\(\frac{T}{KL}\)</td><td>-</td><td>-</td></tr><tr><td>PI</td><td>\(\frac{0.9T}{KL}\)</td><td>\(\frac{L}{0.3}\)</td><td>-</td></tr><tr><td>PID</td><td>\(\frac{1.2T}{KL}\)</td><td>\(2L\)</td><td>\(0.5L\)</td></tr></tbody></table><p>Here, \(T_I\) is the integral time and \(T_D\) is the derivative time, with the relationships \(K_I = K_P / T_I\) and \(K_D = K_P \cdot T_D\).</p><p>The Ziegler-Nichols method tends to produce oscillatory responses as its starting point, so the resulting gains often lead to significant overshoot. In practice, these values are used as initial settings and then fine-tuned manually.</p><h2 id=disturbance-rejection-simulation>Disturbance Rejection Simulation</h2><p>In real control systems, disturbances (unexpected external inputs) affect control performance. Here we add a step disturbance midway through the simulation and compare the disturbance rejection of P control and PID control.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>dt</span> <span class=o>=</span> <span class=mf>0.01</span>
</span></span><span class=line><span class=cl><span class=n>t_end</span> <span class=o>=</span> <span class=mf>20.0</span>
</span></span><span class=line><span class=cl><span class=n>t</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>t_end</span><span class=p>,</span> <span class=n>dt</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>setpoint</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>ones_like</span><span class=p>(</span><span class=n>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Disturbance: step of magnitude 0.5 at t=10s</span>
</span></span><span class=line><span class=cl><span class=n>disturbance</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros_like</span><span class=p>(</span><span class=n>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>disturbance</span><span class=p>[</span><span class=n>t</span> <span class=o>&gt;=</span> <span class=mf>10.0</span><span class=p>]</span> <span class=o>=</span> <span class=mf>0.5</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plant_params</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;gain&#39;</span><span class=p>:</span> <span class=mf>1.0</span><span class=p>,</span> <span class=s1>&#39;time_constant&#39;</span><span class=p>:</span> <span class=mf>1.0</span><span class=p>,</span> <span class=s1>&#39;dt&#39;</span><span class=p>:</span> <span class=n>dt</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>configs</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=s1>&#39;P control (Kp=2.0)&#39;</span><span class=p>,</span> <span class=p>{</span><span class=s1>&#39;kp&#39;</span><span class=p>:</span> <span class=mf>2.0</span><span class=p>,</span> <span class=s1>&#39;ki&#39;</span><span class=p>:</span> <span class=mf>0.0</span><span class=p>,</span> <span class=s1>&#39;kd&#39;</span><span class=p>:</span> <span class=mf>0.0</span><span class=p>}),</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=s1>&#39;PID control (Kp=2.0, Ki=1.0, Kd=0.5)&#39;</span><span class=p>,</span> <span class=p>{</span><span class=s1>&#39;kp&#39;</span><span class=p>:</span> <span class=mf>2.0</span><span class=p>,</span> <span class=s1>&#39;ki&#39;</span><span class=p>:</span> <span class=mf>1.0</span><span class=p>,</span> <span class=s1>&#39;kd&#39;</span><span class=p>:</span> <span class=mf>0.5</span><span class=p>}),</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>fig</span><span class=p>,</span> <span class=n>axes</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>8</span><span class=p>),</span> <span class=n>sharex</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>label</span><span class=p>,</span> <span class=n>params</span> <span class=ow>in</span> <span class=n>configs</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>pid</span> <span class=o>=</span> <span class=n>PIDController</span><span class=p>(</span><span class=o>**</span><span class=n>params</span><span class=p>,</span> <span class=n>dt</span><span class=o>=</span><span class=n>dt</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plant</span> <span class=o>=</span> <span class=n>FirstOrderSystem</span><span class=p>(</span><span class=o>**</span><span class=n>plant_params</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>y_hist</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=n>u_hist</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>sp</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>setpoint</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>u</span> <span class=o>=</span> <span class=n>pid</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>sp</span><span class=p>,</span> <span class=n>plant</span><span class=o>.</span><span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># Add disturbance to plant input</span>
</span></span><span class=line><span class=cl>        <span class=n>y</span> <span class=o>=</span> <span class=n>plant</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>u</span> <span class=o>+</span> <span class=n>disturbance</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=n>y_hist</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>u_hist</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>u</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>t</span><span class=p>,</span> <span class=n>y_hist</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=n>label</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>axes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>t</span><span class=p>,</span> <span class=n>u_hist</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=n>label</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>axhline</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;k&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;--&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Setpoint&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>axvline</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=mf>10.0</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;r&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;:&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Disturbance onset&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;Output y(t)&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;Disturbance Rejection Comparison&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>legend</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;Control input u(t)&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;Time [s]&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>legend</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></div><p>The simulation results show the following:</p><ul><li><strong>P control</strong>: It provides some disturbance suppression, but a steady-state error due to the disturbance remains.</li><li><strong>PID control</strong>: Thanks to the integral term, the output eventually returns to the setpoint even after the disturbance is applied. The derivative term also improves the initial response to the disturbance.</li></ul><h2 id=summary>Summary</h2><p>In this article, we implemented a PID controller in Python and verified its behavior through simulation with a first-order system. By comparing P, PI, and PID step responses, we experimentally confirmed the role and effect of each component.</p><p>PID control is simple in structure yet achieves high control performance with proper tuning. However, for systems with strong nonlinearity or multiple inputs and outputs, more advanced control methods become necessary.</p><h2 id=related-articles>Related Articles</h2><ul><li><a href=https://yuhi-sa.github.io/en/posts/20210318_pid/1/>Fundamentals of PID Control and the Role of Each Component</a> - Explains the mathematical definitions of P, PI, and PID control and the characteristics of each component.</li><li><a href=https://yuhi-sa.github.io/en/posts/20260215_mppi/1/>Mathematics of MPPI (Model Predictive Path Integral)</a> - Introduces model predictive control based on Monte Carlo sampling as an advanced control method beyond PID.</li><li><a href=https://yuhi-sa.github.io/en/posts/20260224_kalman_filter/1/>Kalman Filter: Theory and Python Implementation</a> - Explains state estimation methods used in combination with feedback control.</li><li><a href=https://yuhi-sa.github.io/en/posts/20200901_filter/1/>Fundamentals of Filtering Methods in Signal Processing</a> - Provides an overview of filtering methods used for state estimation in control systems.</li><li><a href=https://yuhi-sa.github.io/en/posts/20260223_matplotlib_tips/1/>Matplotlib Practical Tips: Creating Publication-Quality Plots</a> - Introduces settings for creating higher-quality plots of simulation results.</li></ul><h2 id=references>References</h2><ul><li>Astrom, K. J., & Murray, R. M. (2021). <em>Feedback Systems: An Introduction for Scientists and Engineers</em> (2nd ed.). Princeton University Press.</li><li>Ziegler, J. G., & Nichols, N. B. (1942). &ldquo;Optimum settings for automatic controllers&rdquo;. <em>Transactions of the ASME</em>, 64(11), 759-768.</li></ul></div><div class="ad-slot in-content my-3"><ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=fluid data-ad-client=ca-pub-9558545098866170></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><footer class=article-footer></footer><meta itemprop=wordCount content="1491"><meta itemprop=url content="https://yuhi-sa.github.io/en/posts/20260225_pid_impl/1/"></article><nav class="post-nav mt-5" aria-label="Post navigation"><a href=/en/posts/20260225_rsa/1/ class="post-nav__item post-nav__item--prev"><span class="post-nav__label text-muted"><i class="fas fa-arrow-left me-1" aria-hidden=true></i>前の記事
</span><span class=post-nav__title>RSA Encryption: Theory and Python Implementation</span>
</a><a href=/en/posts/20260226_fir_iir/1/ class="post-nav__item post-nav__item--next"><span class="post-nav__label text-muted">次の記事<i class="fas fa-arrow-right ms-1" aria-hidden=true></i>
</span><span class=post-nav__title>FIR vs IIR Filters: Characteristics, Design, and Python Implementation</span></a></nav><section class="related-posts mt-5" aria-label="Related posts"><h2 class=related-posts__title>関連記事</h2><div class=related-posts__grid><article class=related-posts__item><h3 class=related-posts__item-title><a href=/en/posts/20260215_mppi/1/>MPPI (Model Predictive Path Integral): A Unified View with the Cross-Entropy Method</a></h3><div class=card-meta><time datetime=2026-02-15>February 15, 2026</time></div></article><article class=related-posts__item><h3 class=related-posts__item-title><a href=/en/posts/20260226_svm/1/>Support Vector Machines (SVM): Kernel Methods and Nonlinear Classification with Python</a></h3><div class=card-meta><time datetime=2026-02-26>February 26, 2026</time></div></article><article class=related-posts__item><h3 class=related-posts__item-title><a href=/en/posts/20260226_arima/1/>Time Series Forecasting Fundamentals: ARIMA Theory and Python Implementation</a></h3><div class=card-meta><time datetime=2026-02-26>February 26, 2026</time></div></article></div></section><nav class="article-navigation mt-4" aria-label="Article navigation"><a href=/en/posts/ class="btn btn-outline-secondary btn-sm mb-3"><i class="fas fa-arrow-left me-1" aria-hidden=true></i>
Back to posts</a><nav aria-label="Breadcrumb navigation" class=breadcrumb-nav role=navigation><ol class=breadcrumb itemscope itemtype=https://schema.org/BreadcrumbList><li class=breadcrumb-item itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a href=/en/ itemprop=item aria-label="Navigate to homepage"><i class="fas fa-home" aria-hidden=true></i>
<span itemprop=name>tomato blog</span>
</a><meta itemprop=position content="1"></li><li class=breadcrumb-item itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a href=https://yuhi-sa.github.io/en/ itemprop=item aria-label="Navigate to tomato blog"><span itemprop=name>tomato blog</span>
</a><meta itemprop=position content="2"></li><li class=breadcrumb-item itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a href=https://yuhi-sa.github.io/en/posts/ itemprop=item aria-label="Navigate to Posts"><span itemprop=name>Posts</span>
</a><meta itemprop=position content="3"></li><li class="breadcrumb-item active" aria-current=page itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><span itemprop=name>PID Control in Python: Simulation and Tuning</span>
<meta itemprop=position content="4"></li></ol></nav></nav></div></div></div></main><footer role=contentinfo class=site-footer><div class="container pt-4 pb-3" style="border-top:2px solid var(--accent,#e54d2e)"><div class="row justify-content-center"><div class="col-md-8 text-center"><p class="copyright-text text-muted mb-2">&copy; 2026 yuhi-sa. All rights reserved.</p><p class="theme-attribution text-muted small mt-2 mb-0">Powered by
<a href=https://gohugo.io/ target=_blank rel=noopener class=text-decoration-none>Hugo</a>
with
<a href=https://github.com/yuhi-sa/tomatohugo target=_blank rel=noopener class=text-decoration-none>TomatoHugo</a></p></div></div></div></footer><script src=https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js integrity=sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz crossorigin=anonymous defer></script><script src=/js/dark-mode.min.3e457dc8346f064bee795e6f9b73e1516dcd059e750c521fe4b445f9ea9a7821.js integrity="sha256-PkV9yDRvBkvueV5vm3PhUW3NBZ51DFIf5LRF+eqaeCE=" defer></script><script>window.addEventListener("load",function(){const e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-LN6QP6VVM3",document.head.appendChild(e),e.onload=function(){window.dataLayer=window.dataLayer||[];function e(){dataLayer.push(arguments)}e("js",new Date),e("config","G-LN6QP6VVM3")}})</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"WebPage","name":"PID Control in Python: Simulation and Tuning","url":"https:\/\/yuhi-sa.github.io\/en\/posts\/20260225_pid_impl\/1\/","description":"Implement PID control in Python, simulate with a first-order system, compare P\/PI\/PID responses, and explore Ziegler-Nichols tuning.","inLanguage":"en","isPartOf":{"@type":"WebSite","name":"tomato blog","url":"https:\/\/yuhi-sa.github.io\/"}}</script></body></html>