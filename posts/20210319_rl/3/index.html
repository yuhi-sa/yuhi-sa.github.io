<!DOCTYPE html>
<html lang="ja" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>モデルフリー強化学習 | tomato blog</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM"
      crossorigin="anonymous" rel="stylesheet">



  <link rel="stylesheet" href="/css/main.css">

  <link rel="stylesheet" href="/css/syntax.css">


<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">


<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>


<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>


<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>


<script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']]
    }
  };
</script>


</head>
<body>
  <header>
    
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
      <div class="navbar-brand">tomato blog</div>
      <button class="navbar-toggler ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">  
        <ul class="navbar-nav ml-auto">
      <li class="nav-item">
        <a ZgotmplZ href="http://localhost:1313/" class="nav-link"> Blog </a>
      </li>
      <li class="nav-item">
        <a ZgotmplZ href="http://localhost:1313/tags" class="nav-link"> Tags </a>
      </li>
      <li class="nav-item">
        <a ZgotmplZ href="http://localhost:1313/posts/about" class="nav-link"> About </a>
      </li>
      <li class="nav-item">
        <a ZgotmplZ href="http://localhost:1313/posts/privacy_policy" class="nav-link"> Privacy policy </a>
      </li>
        </ul>
      </div>
    </nav>


  
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-LN6QP6VVM3"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-LN6QP6VVM3');
  </script>



  
  <script data-ad-client="ca-pub-9558545098866170" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>



  </header>
  <main>
    


<h1 id="モデルフリー強化学習">モデルフリー強化学習</h1>
<p>モデルフリーの強化学習では，モデル(遷移関数$T(s&rsquo;|s,a)$・報酬関数$R(s,s&rsquo;)$)が未知であることが前提で，エージェント自らが動くことで経験を蓄積し，その経験から学習を行う．</p>
<h2 id="探索と活用のトレードオフ">探索と活用のトレードオフ</h2>
<p>無限に行動することが可能であれば十分な探索の後に経験をかつようすればよい．しかし，多くの場合行動回数に何かしらの制限がある．
どれくらい調査の行動をして，どのくらい報酬目的の行動をするかを探索と活用のトレードオフとよぶ．トレードオフのバランスを取る手法として，Epsilon-Greedy法が一般的である．</p>
<ul>
<li>Epsilon-Greedy法<br>
Epsilonの確率で探索を行い，それ以外は活用目的の行動を行う．</li>
</ul>
<h2 id="計画の修正を実績で行うか予測で行うか">計画の修正を実績で行うか，予測で行うか</h2>
<p>計画の修正を実績に基づき行う場合と，予測により行う場合のトレードオフも存在する．<br>
前者の手法としてモンテカルロ法，後者の手法としてTD法，両者の間をとる手法としてTD($\lambda$)法がある．</p>
<h3 id="モンテカルロ法時刻tでエピソード修了">モンテカルロ法(時刻Tでエピソード修了)</h3>
<p>エピソードが修了した後に，獲得できた報酬の総和をもとに修正を行うシンプルな方法である．</p>
<p>$$V(s_t) \leftarrow V(s_t)+\alpha((r_{t+1}+\gamma r_{t+2} + \gamma^2 r_{t+3} + ,&hellip;,\gamma^{T-1}r_T )-V(s_t))$$</p>
<p>1エピソードが終了する修正できない．</p>
<h3 id="td法">TD法</h3>
<p>学習する経験は，見積もり$V(s)$と実際$r+V(s&rsquo;)$の誤差である(TD誤差)．経験による修正は，以下のように価値の更新を行うこととなる．</p>
<p>$$V(s_t) \leftarrow V(s_t)+\alpha(r_{t+1}+\gamma V(s_{t+1})-V(s_t))$$</p>
<p>1stepごとに更新を行う手法がTD法となる．
修正期間を1より大きく，$T$より小さい値に設定する手法をMulti-step Learningとよぶ．</p>
<h3 id="tdlambda法">TD($\lambda$)法</h3>
<p>各stepにおける実際の価値を係数$\lambda$を使い合算した結果から，誤差を計算する手法である．</p>
<ul>
<li>1step：$G_t^1=r_{t+1}+\gamma V(s_{t+1})$</li>
<li>2step：$G_t^2=r_{t+1}+\gamma r_{t+2}+\gamma^2 V(s_{t+2})$</li>
<li>$T$step：$G_t^T=r_{t+1}+\gamma r_{t+2}+,&hellip;,+\gamma^{T-1}r_T$</li>
</ul>
<p>$\lambda=1$でモンテカルロ法と等価なる．</p>
<h2 id="価値ベースと方策ベース">価値ベースと方策ベース</h2>
<p>モデルベース強化学習と同様に経験を価値評価の更新に用いるか方策の更新に用いるかで2つに分かれる．行動価値を$Q$で表す．</p>
<h3 id="価値ベースoff-policy">価値ベース(Off-policy)</h3>
<ul>
<li>Q-learning<br>
$$Q(s_t) \leftarrow Q(s_t)+\alpha(r_{t+1}+\gamma \max_a Q(s_{t+1})-Q(s_t))$$</li>
</ul>
<h3 id="方策ベースon-policy">方策ベース(On-policy)</h3>
<ul>
<li>SARSA
$$Q(s_t) \leftarrow Q(s_t)+\alpha(r_{t+1}+\gamma Q(s_{t+1})-Q(s_t))$$</li>
</ul>
<h3 id="actor-critic法">Actor-Critic法</h3>
<p>価値ベースと方策ベースを組み合わせた手法をActor-Critic法とよぶ．方策評価をActor，価値評価をCriticで相互に更新し学習を行う．</p>
<h2 id="参考">参考</h2>
<p>久保隆宏,&quot;<a href="https://amzn.to/3tA1S4W">Pythonで学ぶ強化学習 入門から実践まで</a>&quot;</p>

  <div>
    <div>Tags:</div>
    <ul>
        <li><a href="/tags/python%E3%81%A7%E5%AD%A6%E3%81%B6%E5%BC%B7%E5%8C%96%E5%AD%A6%E7%BF%92/">Pythonで学ぶ強化学習</a></li>
    </ul>
  </div>

<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
      <li class="breadcrumb-item"><a href="/">Home</a></li>
      
        
        
        <li class="breadcrumb-item active" aria-current="page">モデルフリー強化学習</li>
      
    </ol>
  </nav>
  

  </main>
  <footer>
    <p style="text-align: center;">Copyright 2024. All rights reserved.</p>

  </footer>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM"
      crossorigin="anonymous" rel="stylesheet">



  <link rel="stylesheet" href="/css/main.css">

  <link rel="stylesheet" href="/css/syntax.css">

  
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">


<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>


<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>


<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>


<script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']]
    }
  };
</script>

</body>
</html>
