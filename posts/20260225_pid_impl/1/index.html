<!doctype html><html lang=ja dir=ltr data-theme=light><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=theme-color content="#e74c3c"><meta name=format-detection content="telephone=no"><meta name=robots content="index,follow"><meta name=description content="PID制御をPythonで実装し、1次遅れ系のシミュレーションで動作を確認します。P/PI/PIDの応答比較とZiegler-Nicholsチューニング法も紹介します。"><meta name=keywords content="PID制御,Python,シミュレーション,制御工学,Ziegler-Nichols,チューニング,フィードバック制御"><meta name=author content="yuhi-sa"><link rel=canonical href=https://yuhi-sa.github.io/posts/20260225_pid_impl/1/><meta property="og:type" content="article"><meta property="og:title" content="PID制御のPython実装：シミュレーションとチューニング"><meta property="og:description" content="PID制御をPythonで実装し、1次遅れ系のシミュレーションで動作を確認します。P/PI/PIDの応答比較とZiegler-Nicholsチューニング法も紹介します。"><meta property="og:url" content="https://yuhi-sa.github.io/posts/20260225_pid_impl/1/"><meta property="og:site_name" content="tomato blog"><meta property="og:locale" content="ja"><meta property="og:image" content="https://yuhi-sa.github.io/ogp.jpeg"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta property="article:published_time" content="2026-02-25T13:00:00+09:00"><meta property="article:modified_time" content="2026-02-25T21:50:22+09:00"><meta property="article:tag" content="制御"><meta property="article:tag" content="Python"><meta property="article:tag" content="シミュレーション"><meta property="article:section" content="posts"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="PID制御のPython実装：シミュレーションとチューニング"><meta name=twitter:description content="PID制御をPythonで実装し、1次遅れ系のシミュレーションで動作を確認します。P/PI/PIDの応答比較とZiegler-Nicholsチューニング法も紹介します。"><meta name=twitter:image content="https://yuhi-sa.github.io/ogp.jpeg"><title>PID制御のPython実装：シミュレーションとチューニング | tomato blog</title><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preconnect href=https://cdn.jsdelivr.net crossorigin><link rel=preconnect href=https://pagead2.googlesyndication.com crossorigin><link rel=dns-prefetch href=https://pagead2.googlesyndication.com><link rel=icon href=https://yuhi-sa.github.io/favicon.ico><link rel=alternate hreflang=en href=https://yuhi-sa.github.io/en/posts/20260225_pid_impl/1/><link rel=alternate hreflang=ja href=https://yuhi-sa.github.io/posts/20260225_pid_impl/1/><link rel=alternate hreflang=x-default href=https://yuhi-sa.github.io/posts/20260225_pid_impl/1/><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"PID制御のPython実装：シミュレーションとチューニング","description":"PID制御をPythonで実装し、1次遅れ系のシミュレーションで動作を確認します。P\/PI\/PIDの応答比較とZiegler-Nicholsチューニング法も紹介します。","author":{"@type":"Person","name":"yuhi-sa","url":"https:\/\/yuhi-sa.github.io\/"},"publisher":{"@type":"Organization","name":"tomato blog","logo":{"@type":"ImageObject","url":"https:\/\/yuhi-sa.github.io\/ogp.jpeg"},"url":"https:\/\/yuhi-sa.github.io\/"},"datePublished":"2026-02-25T13:00:00\u002b09:00","dateModified":"2026-02-25T21:50:22\u002b09:00","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/yuhi-sa.github.io\/posts\/20260225_pid_impl\/1\/"},"url":"https:\/\/yuhi-sa.github.io\/posts\/20260225_pid_impl\/1\/","wordCount":684,"keywords":["制御","Python","シミュレーション"],"articleSection":"Posts","inLanguage":"ja","timeRequired":"PT4M"}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"tomato blog","item":"https:\/\/yuhi-sa.github.io\/"},{"@type":"ListItem","position":2,"name":"Posts","item":"https:\/\/yuhi-sa.github.io\/posts\/"},{"@type":"ListItem","position":3,"name":"PID制御のPython実装：シミュレーションとチューニング"}]}</script><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin=anonymous referrerpolicy=no-referrer><link href=https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css rel=stylesheet integrity=sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH crossorigin=anonymous><link rel=stylesheet href=/css/variables.min.72a177faa7b12de55dcc39c4ab6b6392116718d5e2735dab0214511354ecb973.css integrity="sha256-cqF3+qexLeVdzDnEq2tjkhFnGNXic12rAhRRE1TsuXM=" crossorigin=anonymous><link rel=stylesheet href=/css/main.min.403a82b29e94ee6e7a39204b5082cdf8b4966cfb44115390da7d8867a5006acd.css integrity="sha256-QDqCsp6U7m56OSBLUILN+LSWbPtEEVOQ2n2IZ6UAas0=" crossorigin=anonymous><link rel=stylesheet href=/css/syntax.min.e379066489e20d5433ca35ac1f468fd9e8859705a62d77a79bb7379ac3613848.css integrity="sha256-43kGZIniDVQzyjWsH0aP2eiFlwWmLXenm7c3msNhOEg=" crossorigin=anonymous><style>body{font-family:-apple-system,BlinkMacSystemFont,inter,segoe ui,Roboto,sans-serif;line-height:1.5;color:#000;background:#fff}[data-theme=dark] body{color:#fff;background:#000}.container{max-width:768px;margin:0 auto;padding:0 1rem}</style><script src=https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js integrity=sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz crossorigin=anonymous defer></script><script src=/js/dark-mode.min.3e457dc8346f064bee795e6f9b73e1516dcd059e750c521fe4b445f9ea9a7821.js integrity="sha256-PkV9yDRvBkvueV5vm3PhUW3NBZ51DFIf5LRF+eqaeCE=" defer></script><script>window.addEventListener("load",function(){const e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-LN6QP6VVM3",document.head.appendChild(e),e.onload=function(){window.dataLayer=window.dataLayer||[];function e(){dataLayer.push(arguments)}e("js",new Date),e("config","G-LN6QP6VVM3")}})</script><script>window.MathJax={tex:{inlineMath:[["\\(","\\)"]],displayMath:[["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre","code"],ignoreHtmlClass:"tex2jax_ignore",processHtmlClass:"tex2jax_process"}}</script><script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js id=mathjax-script async></script></head><body itemscope itemtype=https://schema.org/WebPage class=theme-tomatohugo><a href=#main-content class="skip-link sr-only sr-only-focusable" aria-label="Skip to main content">Skip to main content</a><header role=banner class=site-header><nav class="navbar navbar-expand-lg navbar-light bg-light" role=navigation aria-label="Main navigation"><div class=container><a class=navbar-brand href=https://yuhi-sa.github.io/ aria-label="Return to tomato blog homepage">tomato blog
</a><button class="navbar-toggler d-lg-none" type=button data-bs-toggle=collapse data-bs-target=#navbarNav aria-controls=navbarNav aria-expanded=false aria-label="Toggle navigation menu">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarNav><ul class="navbar-nav ms-auto" role=menubar><li class=nav-item role=none><a class=nav-link href=https://yuhi-sa.github.io/ role=menuitem aria-label="Navigate to Blog">Blog</a></li><li class=nav-item role=none><a class=nav-link href=https://yuhi-sa.github.io/tags/ role=menuitem aria-label="Navigate to Tags">Tags</a></li><li class=nav-item role=none><a class=nav-link href=https://yuhi-sa.github.io/posts/about/ role=menuitem aria-label="Navigate to About">About</a></li><li class=nav-item role=none><a class=nav-link href=https://yuhi-sa.github.io/posts/privacy_policy/ role=menuitem aria-label="Navigate to Privacy policy">Privacy policy</a></li><li class=nav-item role=none><button id=darkModeToggle class="nav-link btn btn-link border-0" type=button role=menuitem aria-label="Toggle dark mode" title="Switch between light and dark themes">
<i class="fas fa-moon" id=darkModeIcon aria-hidden=true></i>
<span class="d-lg-none ms-2">ダークモード</span></button></li></ul></div></div></nav><script data-ad-client=ca-pub-9558545098866170 async crossorigin=anonymous src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></header><main id=main-content role=main class=site-main aria-label="Main content"><div class="container mt-4"><div class="row justify-content-center"><div class=col-lg-8><article itemscope itemtype=https://schema.org/Article><header class=article-header><h1 itemprop=headline>PID制御のPython実装：シミュレーションとチューニング</h1><p class="lead article-description" itemprop=description>PID制御をPythonで実装し、1次遅れ系のシミュレーションで動作を確認します。P/PI/PIDの応答比較とZiegler-Nicholsチューニング法も紹介します。</p><div class=article-meta><time datetime=2026-02-25T13:00:00+09:00 itemprop=datePublished><i class="far fa-calendar-alt me-1" aria-hidden=true></i>
February 25, 2026
</time><time datetime=2026-02-25T21:50:22+09:00 itemprop=dateModified class=ms-3><i class="far fa-edit me-1" aria-hidden=true></i>
Updated
February 25, 2026
</time><span aria-label="Reading time" class=ms-3><i class="far fa-clock me-1" aria-hidden=true></i>
4 min read</span></div><div class=article-tags role=group aria-label="Article tags"><a href=/tags/%E5%88%B6%E5%BE%A1/ class="badge badge-custom text-decoration-none me-1" rel=tag itemprop=keywords>制御
</a><a href=/tags/python/ class="badge badge-custom text-decoration-none me-1" rel=tag itemprop=keywords>Python
</a><a href=/tags/%E3%82%B7%E3%83%9F%E3%83%A5%E3%83%AC%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3/ class="badge badge-custom text-decoration-none me-1" rel=tag itemprop=keywords>シミュレーション</a></div></header><div class=article-content itemprop=articleBody><h2 id=はじめに>はじめに</h2><p>PID制御は、産業用途で最も広く使われるフィードバック制御手法です。温度制御、モータ制御、プロセス制御など、あらゆる分野で用いられています。</p><p>PID制御の基礎理論については<a href=https://yuhi-sa.github.io/posts/20210318_pid/1/>PID制御の基礎理論と各要素の役割</a>を参照してください。本記事では、PID制御器をPythonで実装し、1次遅れ系に対するシミュレーションを通じて、P制御・PI制御・PID制御の応答特性を比較します。さらに、古典的なチューニング手法であるZiegler-Nichols法についても紹介します。</p><h2 id=離散pid制御器の実装>離散PID制御器の実装</h2><p>連続時間のPID制御則は以下のように表されます。</p>\[
u(t) = K_P e(t) + K_I \int_0^t e(\tau)d\tau + K_D \frac{de(t)}{dt}
\]<p>ここで、\(e(t) = r(t) - y(t)\) は目標値と出力の偏差です。計算機上で実装するためには、積分と微分を離散近似する必要があります。積分は累積和、微分は後退差分で近似すると、離散PID制御則は次のようになります。</p>\[
u[k] = K_P e[k] + K_I \Delta t \sum_{i=0}^{k} e[i] + K_D \frac{e[k] - e[k-1]}{\Delta t} \tag{1}
\]<p>ここで、\(\Delta t\) はサンプリング周期です。</p><p>以下にPythonでの実装を示します。出力制限とアンチワインドアップ機構を含んでいます。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>PIDController</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>kp</span><span class=p>,</span> <span class=n>ki</span><span class=p>,</span> <span class=n>kd</span><span class=p>,</span> <span class=n>dt</span><span class=p>,</span> <span class=n>output_limits</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>kp</span> <span class=o>=</span> <span class=n>kp</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>ki</span> <span class=o>=</span> <span class=n>ki</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>kd</span> <span class=o>=</span> <span class=n>kd</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>dt</span> <span class=o>=</span> <span class=n>dt</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>output_limits</span> <span class=o>=</span> <span class=n>output_limits</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>integral</span> <span class=o>=</span> <span class=mf>0.0</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>prev_error</span> <span class=o>=</span> <span class=mf>0.0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>update</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>setpoint</span><span class=p>,</span> <span class=n>measured</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>error</span> <span class=o>=</span> <span class=n>setpoint</span> <span class=o>-</span> <span class=n>measured</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># 比例項</span>
</span></span><span class=line><span class=cl>        <span class=n>p_term</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>kp</span> <span class=o>*</span> <span class=n>error</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># 積分項（累積和による近似）</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>integral</span> <span class=o>+=</span> <span class=n>error</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>dt</span>
</span></span><span class=line><span class=cl>        <span class=n>i_term</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>ki</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>integral</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># 微分項（後退差分による近似）</span>
</span></span><span class=line><span class=cl>        <span class=n>derivative</span> <span class=o>=</span> <span class=p>(</span><span class=n>error</span> <span class=o>-</span> <span class=bp>self</span><span class=o>.</span><span class=n>prev_error</span><span class=p>)</span> <span class=o>/</span> <span class=bp>self</span><span class=o>.</span><span class=n>dt</span>
</span></span><span class=line><span class=cl>        <span class=n>d_term</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>kd</span> <span class=o>*</span> <span class=n>derivative</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>prev_error</span> <span class=o>=</span> <span class=n>error</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>output</span> <span class=o>=</span> <span class=n>p_term</span> <span class=o>+</span> <span class=n>i_term</span> <span class=o>+</span> <span class=n>d_term</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># 出力制限（アンチワインドアップ）</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>output_limits</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>lo</span><span class=p>,</span> <span class=n>hi</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>output_limits</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>output</span> <span class=o>&gt;</span> <span class=n>hi</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>output</span> <span class=o>=</span> <span class=n>hi</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>integral</span> <span class=o>-=</span> <span class=n>error</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>dt</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>output</span> <span class=o>&lt;</span> <span class=n>lo</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>output</span> <span class=o>=</span> <span class=n>lo</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>integral</span> <span class=o>-=</span> <span class=n>error</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>dt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>output</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>reset</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>integral</span> <span class=o>=</span> <span class=mf>0.0</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>prev_error</span> <span class=o>=</span> <span class=mf>0.0</span>
</span></span></code></pre></div><p>アンチワインドアップは、操作量が上下限に達した場合に積分項の蓄積を停止する仕組みです。これがないと、制約下で積分値が際限なく増大し、制約解除後に大きなオーバーシュートを引き起こします。</p><h2 id=制御対象のモデル>制御対象のモデル</h2><p>シミュレーションの制御対象として、1次遅れ系を用います。伝達関数は以下の通りです。</p>\[
G(s) = \frac{K}{1 + Ts} \tag{2}
\]<p>ここで、\(K\) はプロセスゲイン、\(T\) は時定数です。この微分方程式を離散化すると、次の更新式が得られます。</p>\[
y[k+1] = y[k] + \frac{\Delta t}{T}(K \cdot u[k] - y[k]) \tag{3}
\]<p>Pythonでの実装は以下の通りです。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>FirstOrderSystem</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>gain</span><span class=p>,</span> <span class=n>time_constant</span><span class=p>,</span> <span class=n>dt</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>gain</span> <span class=o>=</span> <span class=n>gain</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>time_constant</span> <span class=o>=</span> <span class=n>time_constant</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>dt</span> <span class=o>=</span> <span class=n>dt</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>y</span> <span class=o>=</span> <span class=mf>0.0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>update</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>u</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>y</span> <span class=o>+=</span> <span class=bp>self</span><span class=o>.</span><span class=n>dt</span> <span class=o>/</span> <span class=bp>self</span><span class=o>.</span><span class=n>time_constant</span> <span class=o>*</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>gain</span> <span class=o>*</span> <span class=n>u</span> <span class=o>-</span> <span class=bp>self</span><span class=o>.</span><span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>y</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>reset</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>y</span> <span class=o>=</span> <span class=mf>0.0</span>
</span></span></code></pre></div><h2 id=p制御pi制御pid制御の応答比較>P制御・PI制御・PID制御の応答比較</h2><p>3種類の制御器でステップ応答を比較します。制御対象は \(K=1.0\)、\(T=1.0\) の1次遅れ系です。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>dt</span> <span class=o>=</span> <span class=mf>0.01</span>
</span></span><span class=line><span class=cl><span class=n>t_end</span> <span class=o>=</span> <span class=mf>10.0</span>
</span></span><span class=line><span class=cl><span class=n>t</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>t_end</span><span class=p>,</span> <span class=n>dt</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>setpoint</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>ones_like</span><span class=p>(</span><span class=n>t</span><span class=p>)</span>  <span class=c1># ステップ入力</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plant_params</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;gain&#39;</span><span class=p>:</span> <span class=mf>1.0</span><span class=p>,</span> <span class=s1>&#39;time_constant&#39;</span><span class=p>:</span> <span class=mf>1.0</span><span class=p>,</span> <span class=s1>&#39;dt&#39;</span><span class=p>:</span> <span class=n>dt</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>configs</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=s1>&#39;P control (Kp=2.0)&#39;</span><span class=p>,</span> <span class=p>{</span><span class=s1>&#39;kp&#39;</span><span class=p>:</span> <span class=mf>2.0</span><span class=p>,</span> <span class=s1>&#39;ki&#39;</span><span class=p>:</span> <span class=mf>0.0</span><span class=p>,</span> <span class=s1>&#39;kd&#39;</span><span class=p>:</span> <span class=mf>0.0</span><span class=p>}),</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=s1>&#39;PI control (Kp=2.0, Ki=1.0)&#39;</span><span class=p>,</span> <span class=p>{</span><span class=s1>&#39;kp&#39;</span><span class=p>:</span> <span class=mf>2.0</span><span class=p>,</span> <span class=s1>&#39;ki&#39;</span><span class=p>:</span> <span class=mf>1.0</span><span class=p>,</span> <span class=s1>&#39;kd&#39;</span><span class=p>:</span> <span class=mf>0.0</span><span class=p>}),</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=s1>&#39;PID control (Kp=2.0, Ki=1.0, Kd=0.5)&#39;</span><span class=p>,</span> <span class=p>{</span><span class=s1>&#39;kp&#39;</span><span class=p>:</span> <span class=mf>2.0</span><span class=p>,</span> <span class=s1>&#39;ki&#39;</span><span class=p>:</span> <span class=mf>1.0</span><span class=p>,</span> <span class=s1>&#39;kd&#39;</span><span class=p>:</span> <span class=mf>0.5</span><span class=p>}),</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>fig</span><span class=p>,</span> <span class=n>axes</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>8</span><span class=p>),</span> <span class=n>sharex</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>label</span><span class=p>,</span> <span class=n>params</span> <span class=ow>in</span> <span class=n>configs</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>pid</span> <span class=o>=</span> <span class=n>PIDController</span><span class=p>(</span><span class=o>**</span><span class=n>params</span><span class=p>,</span> <span class=n>dt</span><span class=o>=</span><span class=n>dt</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plant</span> <span class=o>=</span> <span class=n>FirstOrderSystem</span><span class=p>(</span><span class=o>**</span><span class=n>plant_params</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>y_hist</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=n>u_hist</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>sp</span> <span class=ow>in</span> <span class=n>setpoint</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>u</span> <span class=o>=</span> <span class=n>pid</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>sp</span><span class=p>,</span> <span class=n>plant</span><span class=o>.</span><span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>y</span> <span class=o>=</span> <span class=n>plant</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>u</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>y_hist</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>u_hist</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>u</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>t</span><span class=p>,</span> <span class=n>y_hist</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=n>label</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>axes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>t</span><span class=p>,</span> <span class=n>u_hist</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=n>label</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>axhline</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;k&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;--&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Setpoint&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;Output y(t)&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;Step Response Comparison&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>legend</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;Control input u(t)&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;Time [s]&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>legend</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></div><p>シミュレーション結果から、以下の特性が確認できます。</p><ul><li><strong>P制御</strong>: 応答は速いものの、定常偏差が残ります。\(K_P = 2.0\) のとき、理論的な定常偏差は \(\frac{1}{1 + K \cdot K_P} = \frac{1}{3} \approx 0.33\) です。</li><li><strong>PI制御</strong>: 積分項の効果により定常偏差が解消されます。ただし、オーバーシュートが発生しやすくなります。</li><li><strong>PID制御</strong>: 微分項によりオーバーシュートが抑制され、P制御の速応性とPI制御の定常特性を両立できます。</li></ul><h2 id=ゲインパラメータの影響>ゲインパラメータの影響</h2><p>各ゲインパラメータの設定は制御性能に大きく影響します。</p><h3 id=比例ゲイン--が大きすぎる場合>比例ゲイン \(K_P\) が大きすぎる場合</h3><p>\(K_P\) を過大に設定すると、応答が振動的になり、最終的には不安定になります。例えば、P制御で \(K_P = 10.0\) とした場合、出力は目標値の周りで振動します。</p><h3 id=積分ゲイン--とワインドアップ>積分ゲイン \(K_I\) とワインドアップ</h3><p>\(K_I\) が大きい場合、または操作量に制限がある場合、積分項が過度に蓄積する「ワインドアップ」が発生します。操作量が飽和している間も積分値が増え続けるため、飽和から復帰した後に大きなオーバーシュートを引き起こします。前述のアンチワインドアップ機構はこの問題を軽減します。</p><h3 id=微分ゲイン--とノイズ感度>微分ゲイン \(K_D\) とノイズ感度</h3><p>微分項は偏差の変化率を使うため、測定ノイズに敏感です。ノイズが含まれる信号に対して大きな \(K_D\) を設定すると、操作量が激しく変動します。実用上は、微分項の入力にローパスフィルタを適用する「不完全微分」がよく用いられます。</p><h3 id=パラメータ調整の指針>パラメータ調整の指針</h3><table><thead><tr><th>パラメータ</th><th>増加させると</th><th>注意点</th></tr></thead><tbody><tr><td>\(K_P\)</td><td>応答が速くなる、定常偏差が減少</td><td>大きすぎると振動・不安定</td></tr><tr><td>\(K_I\)</td><td>定常偏差が解消される</td><td>オーバーシュート増加、ワインドアップ</td></tr><tr><td>\(K_D\)</td><td>オーバーシュート抑制、応答改善</td><td>ノイズに敏感</td></tr></tbody></table><h2 id=ziegler-nicholsチューニング法>Ziegler-Nicholsチューニング法</h2><p>Ziegler-Nichols法は、制御対象のステップ応答特性から経験的にPIDゲインを決定する古典的な手法です。ここでは、ステップ応答法（開ループ法）を紹介します。</p><h3 id=ステップ応答法>ステップ応答法</h3><p>制御対象にステップ入力を加え、応答曲線から以下の3つのパラメータを読み取ります。</p><ul><li>\(K\): プロセスゲイン（定常値/入力値）</li><li>\(L\): むだ時間（応答が始まるまでの遅れ）</li><li>\(T\): 時定数（応答の変曲点における接線が定常値に達するまでの時間）</li></ul><p>これらのパラメータから、以下の表に基づいてPIDゲインを計算します。</p><table><thead><tr><th>制御器</th><th>\(K_P\)</th><th>\(T_I\)</th><th>\(T_D\)</th></tr></thead><tbody><tr><td>P</td><td>\(\frac{T}{KL}\)</td><td>-</td><td>-</td></tr><tr><td>PI</td><td>\(\frac{0.9T}{KL}\)</td><td>\(\frac{L}{0.3}\)</td><td>-</td></tr><tr><td>PID</td><td>\(\frac{1.2T}{KL}\)</td><td>\(2L\)</td><td>\(0.5L\)</td></tr></tbody></table><p>ここで、\(T_I\) は積分時間、\(T_D\) は微分時間であり、\(K_I = K_P / T_I\)、\(K_D = K_P \cdot T_D\) の関係があります。</p><p>Ziegler-Nichols法は振動的な応答を出発点として設計されるため、そのままではオーバーシュートが大きくなる傾向があります。実用上は、この値を初期値として手動で微調整を行うことが一般的です。</p><h2 id=外乱応答のシミュレーション>外乱応答のシミュレーション</h2><p>実際の制御系では、外乱（外部からの想定外の入力）が制御性能に影響を与えます。ここでは、シミュレーションの途中でステップ状の外乱を加え、P制御とPID制御の外乱抑制性能を比較します。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>dt</span> <span class=o>=</span> <span class=mf>0.01</span>
</span></span><span class=line><span class=cl><span class=n>t_end</span> <span class=o>=</span> <span class=mf>20.0</span>
</span></span><span class=line><span class=cl><span class=n>t</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>t_end</span><span class=p>,</span> <span class=n>dt</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>setpoint</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>ones_like</span><span class=p>(</span><span class=n>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 外乱：t=10sで大きさ0.5のステップ外乱</span>
</span></span><span class=line><span class=cl><span class=n>disturbance</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros_like</span><span class=p>(</span><span class=n>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>disturbance</span><span class=p>[</span><span class=n>t</span> <span class=o>&gt;=</span> <span class=mf>10.0</span><span class=p>]</span> <span class=o>=</span> <span class=mf>0.5</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plant_params</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;gain&#39;</span><span class=p>:</span> <span class=mf>1.0</span><span class=p>,</span> <span class=s1>&#39;time_constant&#39;</span><span class=p>:</span> <span class=mf>1.0</span><span class=p>,</span> <span class=s1>&#39;dt&#39;</span><span class=p>:</span> <span class=n>dt</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>configs</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=s1>&#39;P control (Kp=2.0)&#39;</span><span class=p>,</span> <span class=p>{</span><span class=s1>&#39;kp&#39;</span><span class=p>:</span> <span class=mf>2.0</span><span class=p>,</span> <span class=s1>&#39;ki&#39;</span><span class=p>:</span> <span class=mf>0.0</span><span class=p>,</span> <span class=s1>&#39;kd&#39;</span><span class=p>:</span> <span class=mf>0.0</span><span class=p>}),</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=s1>&#39;PID control (Kp=2.0, Ki=1.0, Kd=0.5)&#39;</span><span class=p>,</span> <span class=p>{</span><span class=s1>&#39;kp&#39;</span><span class=p>:</span> <span class=mf>2.0</span><span class=p>,</span> <span class=s1>&#39;ki&#39;</span><span class=p>:</span> <span class=mf>1.0</span><span class=p>,</span> <span class=s1>&#39;kd&#39;</span><span class=p>:</span> <span class=mf>0.5</span><span class=p>}),</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>fig</span><span class=p>,</span> <span class=n>axes</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>8</span><span class=p>),</span> <span class=n>sharex</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>label</span><span class=p>,</span> <span class=n>params</span> <span class=ow>in</span> <span class=n>configs</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>pid</span> <span class=o>=</span> <span class=n>PIDController</span><span class=p>(</span><span class=o>**</span><span class=n>params</span><span class=p>,</span> <span class=n>dt</span><span class=o>=</span><span class=n>dt</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plant</span> <span class=o>=</span> <span class=n>FirstOrderSystem</span><span class=p>(</span><span class=o>**</span><span class=n>plant_params</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>y_hist</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=n>u_hist</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>sp</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>setpoint</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>u</span> <span class=o>=</span> <span class=n>pid</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>sp</span><span class=p>,</span> <span class=n>plant</span><span class=o>.</span><span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># 外乱をプラントの入力に加算</span>
</span></span><span class=line><span class=cl>        <span class=n>y</span> <span class=o>=</span> <span class=n>plant</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>u</span> <span class=o>+</span> <span class=n>disturbance</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=n>y_hist</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>u_hist</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>u</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>t</span><span class=p>,</span> <span class=n>y_hist</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=n>label</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>axes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>t</span><span class=p>,</span> <span class=n>u_hist</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=n>label</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>axhline</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;k&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;--&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Setpoint&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>axvline</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=mf>10.0</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;r&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;:&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Disturbance onset&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;Output y(t)&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;Disturbance Rejection Comparison&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>legend</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;Control input u(t)&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;Time [s]&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>legend</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>axes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></div><p>シミュレーション結果から、以下のことがわかります。</p><ul><li><strong>P制御</strong>: 外乱に対して一定の抑制効果はありますが、外乱による定常偏差が残ります。</li><li><strong>PID制御</strong>: 積分項の効果により、外乱が加わっても最終的に出力は目標値に復帰します。微分項により、外乱に対する初期応答も改善されます。</li></ul><h2 id=まとめ>まとめ</h2><p>本記事では、PID制御器をPythonで実装し、1次遅れ系に対するシミュレーションを通じて動作を確認しました。P制御・PI制御・PID制御の応答比較により、各要素の役割と効果を実験的に確認できました。</p><p>PID制御は構造がシンプルでありながら、適切なチューニングによって高い制御性能を実現できます。一方で、非線形性が強いシステムや多入力多出力系では、より高度な制御手法が必要になります。</p><h2 id=関連記事>関連記事</h2><ul><li><a href=https://yuhi-sa.github.io/posts/20210318_pid/1/>PID制御の基礎理論と各要素の役割</a> - P制御・PI制御・PID制御の数学的定義と各要素の特性を解説しています。</li><li><a href=https://yuhi-sa.github.io/posts/20260215_mppi/1/>MPPI（Model Predictive Path Integral）の数理</a> - PID制御を超える高度な制御手法として、モンテカルロサンプリングに基づくモデル予測制御を解説しています。</li><li><a href=https://yuhi-sa.github.io/posts/20260224_kalman_filter/1/>カルマンフィルタの理論とPython実装</a> - フィードバック制御と組み合わせて使われる状態推定手法を解説しています。</li><li><a href=https://yuhi-sa.github.io/posts/20200901_filter/1/>信号処理におけるフィルタリング手法の基礎</a> - 制御系の状態推定に使われるフィルタリング手法の概要を解説しています。</li><li><a href=https://yuhi-sa.github.io/posts/20260223_matplotlib_tips/1/>Matplotlib実践Tips：論文品質のグラフを作る</a> - シミュレーション結果のグラフをさらに高品質に仕上げるための設定を紹介しています。</li></ul><h2 id=参考文献>参考文献</h2><ul><li>Astrom, K. J., & Murray, R. M. (2021). <em>Feedback Systems: An Introduction for Scientists and Engineers</em> (2nd ed.). Princeton University Press.</li><li>Ziegler, J. G., & Nichols, N. B. (1942). &ldquo;Optimum settings for automatic controllers&rdquo;. <em>Transactions of the ASME</em>, 64(11), 759-768.</li></ul></div><div class="ad-slot in-content my-3"><ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=fluid data-ad-client=ca-pub-9558545098866170></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><footer class=article-footer></footer><meta itemprop=wordCount content="684"><meta itemprop=url content="https://yuhi-sa.github.io/posts/20260225_pid_impl/1/"></article><nav class="post-nav mt-5" aria-label="Post navigation"><a href=/posts/20260225_rsa/1/ class="post-nav__item post-nav__item--prev"><span class="post-nav__label text-muted"><i class="fas fa-arrow-left me-1" aria-hidden=true></i>前の記事
</span><span class=post-nav__title>RSA暗号の原理とPythonによる実装</span>
</a><a href=/posts/20260226_fir_iir/1/ class="post-nav__item post-nav__item--next"><span class="post-nav__label text-muted">次の記事<i class="fas fa-arrow-right ms-1" aria-hidden=true></i>
</span><span class=post-nav__title>FIRフィルタとIIRフィルタの比較：特性・設計・Python実装</span></a></nav><section class="related-posts mt-5" aria-label="Related posts"><h2 class=related-posts__title>関連記事</h2><div class=related-posts__grid><article class=related-posts__item><h3 class=related-posts__item-title><a href=/posts/20260215_mppi/1/>MPPI（Model Predictive Path Integral）の数理：クロスエントロピー法との統一的理解</a></h3><div class=card-meta><time datetime=2026-02-15>February 15, 2026</time></div></article><article class=related-posts__item><h3 class=related-posts__item-title><a href=/posts/20260226_svm/1/>サポートベクターマシン（SVM）：カーネル法と非線形分類のPython実装</a></h3><div class=card-meta><time datetime=2026-02-26>February 26, 2026</time></div></article><article class=related-posts__item><h3 class=related-posts__item-title><a href=/posts/20260226_arima/1/>時系列予測の基礎：ARIMAモデルの理論とPython実装</a></h3><div class=card-meta><time datetime=2026-02-26>February 26, 2026</time></div></article></div></section><nav class="article-navigation mt-4" aria-label="Article navigation"><a href=/posts/ class="btn btn-outline-secondary btn-sm mb-3"><i class="fas fa-arrow-left me-1" aria-hidden=true></i>
Back to posts</a><nav aria-label="Breadcrumb navigation" class=breadcrumb-nav role=navigation><ol class=breadcrumb itemscope itemtype=https://schema.org/BreadcrumbList><li class=breadcrumb-item itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a href=/ itemprop=item aria-label="Navigate to homepage"><i class="fas fa-home" aria-hidden=true></i>
<span itemprop=name>tomato blog</span>
</a><meta itemprop=position content="1"></li><li class=breadcrumb-item itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a href=https://yuhi-sa.github.io/ itemprop=item aria-label="Navigate to tomato blog"><span itemprop=name>tomato blog</span>
</a><meta itemprop=position content="2"></li><li class=breadcrumb-item itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a href=https://yuhi-sa.github.io/posts/ itemprop=item aria-label="Navigate to Posts"><span itemprop=name>Posts</span>
</a><meta itemprop=position content="3"></li><li class="breadcrumb-item active" aria-current=page itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><span itemprop=name>PID制御のPython実装：シミュレーションとチューニング</span>
<meta itemprop=position content="4"></li></ol></nav></nav></div></div></div></main><footer role=contentinfo class=site-footer><div class="container pt-4 pb-3" style="border-top:2px solid var(--accent,#e54d2e)"><div class="row justify-content-center"><div class="col-md-8 text-center"><p class="copyright-text text-muted mb-2">&copy; 2026 yuhi-sa. All rights reserved.</p><p class="theme-attribution text-muted small mt-2 mb-0">Powered by
<a href=https://gohugo.io/ target=_blank rel=noopener class=text-decoration-none>Hugo</a>
with
<a href=https://github.com/yuhi-sa/tomatohugo target=_blank rel=noopener class=text-decoration-none>TomatoHugo</a></p></div></div></div></footer><script src=https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js integrity=sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz crossorigin=anonymous defer></script><script src=/js/dark-mode.min.3e457dc8346f064bee795e6f9b73e1516dcd059e750c521fe4b445f9ea9a7821.js integrity="sha256-PkV9yDRvBkvueV5vm3PhUW3NBZ51DFIf5LRF+eqaeCE=" defer></script><script>window.addEventListener("load",function(){const e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-LN6QP6VVM3",document.head.appendChild(e),e.onload=function(){window.dataLayer=window.dataLayer||[];function e(){dataLayer.push(arguments)}e("js",new Date),e("config","G-LN6QP6VVM3")}})</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"WebPage","name":"PID制御のPython実装：シミュレーションとチューニング","url":"https:\/\/yuhi-sa.github.io\/posts\/20260225_pid_impl\/1\/","description":"PID制御をPythonで実装し、1次遅れ系のシミュレーションで動作を確認します。P\/PI\/PIDの応答比較とZiegler-Nicholsチューニング法も紹介します。","inLanguage":"ja","isPartOf":{"@type":"WebSite","name":"tomato blog","url":"https:\/\/yuhi-sa.github.io\/"}}</script></body></html>