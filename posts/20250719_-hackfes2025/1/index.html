<!doctype html><html lang=ja dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width"><meta name=robots content="index,follow"><meta property="og:title" content="Hackfes2025参加メモ | tomato blog"><meta property="og:description" content="勉強したことなどをメモしています"><meta property="og:image" content="https://yuhi-sa.github.io/ogp.jpeg"><meta property="og:url" content="https://yuhi-sa.github.io/posts/20250719_-hackfes2025/1/"><meta name=twitter:card content="summary_large_image"><title>Hackfes2025参加メモ | tomato blog</title><link href=https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css rel=stylesheet><link rel=stylesheet href=/css/main.min.cbcf0adf3096d54322591302ca01248346902aa2474afcbd71c3a1b999e09ad9.css integrity="sha256-y88K3zCW1UMiWRMCygEkg0aQKqJHSvy9ccOhuZngmtk=" crossorigin=anonymous><link rel=stylesheet href=/css/syntax.min.aa0332253f313dc48905008b4ab314155e5a13302588d25bcf4949f7c1abdde0.css integrity="sha256-qgMyJT8xPcSJBQCLSrMUFV5aEzAliNJbz0lJ98Gr3eA=" crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js></script><script src=https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.min.js></script><script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]]}}</script></head><body><header><nav class="navbar navbar-expand-lg navbar-light bg-light"><div class=navbar-brand style=padding-left:10px>tomato blog</div><button class="navbar-toggler ml-auto" type=button data-bs-toggle=collapse data-bs-target=#navbarNav aria-controls=navbarNav aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarNav><ul class="navbar-nav ml-auto"><li class=nav-item><a zgotmplz href=https://yuhi-sa.github.io/ class=nav-link>Blog</a></li><li class=nav-item><a zgotmplz href=https://yuhi-sa.github.io/tags class=nav-link>Tags</a></li><li class=nav-item><a zgotmplz href=https://yuhi-sa.github.io/posts/about class=nav-link>About</a></li><li class=nav-item><a zgotmplz href=https://yuhi-sa.github.io/posts/privacy_policy class=nav-link>Privacy policy</a></li></ul></div></nav><script async src="https://www.googletagmanager.com/gtag/js?id=G-LN6QP6VVM3"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-LN6QP6VVM3")</script><script data-ad-client=ca-pub-9558545098866170 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></header><main><div style="max-width:80%;margin:0 auto"><h1 id=hackfes2025参加メモ>Hackfes2025参加メモ</h1><h2 id=イベント概要>イベント概要</h2><ul><li>日時: 2025年7月19日(土)</li><li><a href=https://hackfes2025.hacker.or.jp>https://hackfes2025.hacker.or.jp</a></li></ul><h2 id=webアプリケーションspa脆弱性診断入門徳丸-浩>「Webアプリケーション（SPA）脆弱性診断入門」徳丸 浩</h2><p>10:10 - 11:40</p><p>Burp Suiteを用いてSPA（Single Page Application）に対する脆弱性診断を実践。
対象は、HTMLとJavaScriptで構成された動的コンテンツ生成型のシンプルなSPAサーバー。</p><h3 id=corscross-origin-resource-sharingの認可不備>CORS（Cross-Origin Resource Sharing）の認可不備</h3><p>ログインAPIへのプリフライトリクエスト（OPTIONSメソッド）は、CORS（Cross-Origin Resource Sharing）によって処理される。</p><p>プリフライトリクエスト</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>OPTIONS /api/v1/login HTTP/1.1
</span></span><span class=line><span class=cl>Host: api.example.jp
</span></span><span class=line><span class=cl>Accept: */*
</span></span><span class=line><span class=cl>Access-Control-Request-Method: POST
</span></span><span class=line><span class=cl>Access-Control-Request-Headers: content-type
</span></span><span class=line><span class=cl>Origin: http://spa.example.jp
</span></span><span class=line><span class=cl>User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
</span></span><span class=line><span class=cl>Sec-Fetch-Mode: cors
</span></span><span class=line><span class=cl>Sec-Fetch-Site: cross-site
</span></span><span class=line><span class=cl>Sec-Fetch-Dest: empty
</span></span><span class=line><span class=cl>Referer: http://spa.example.jp/
</span></span><span class=line><span class=cl>Accept-Encoding: gzip, deflate, br
</span></span><span class=line><span class=cl>Accept-Language: ja,en-US;q=0.9,en;q=0.8
</span></span><span class=line><span class=cl>Priority: u=1, i
</span></span><span class=line><span class=cl>Connection: keep-alive
</span></span></code></pre></div><p>レスポンス</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>HTTP/1.1 204 No Content
</span></span><span class=line><span class=cl>X-Powered-By: Express
</span></span><span class=line><span class=cl>Access-Control-Allow-Origin: http://spa.example.jp
</span></span><span class=line><span class=cl>Vary: Origin, Access-Control-Request-Headers
</span></span><span class=line><span class=cl>Access-Control-Allow-Credentials: true
</span></span><span class=line><span class=cl>Access-Control-Allow-Methods: GET,HEAD,PUT,PATCH,POST,DELETE
</span></span><span class=line><span class=cl>Access-Control-Allow-Headers: content-type
</span></span><span class=line><span class=cl>Access-Control-Max-Age: 300
</span></span><span class=line><span class=cl>Content-Length: 0
</span></span><span class=line><span class=cl>Date: Sat, 19 Jul 2025 01:31:57 GMT
</span></span></code></pre></div><p>Burp Repeaterを使ってOriginヘッダーを悪意あるドメインに書き換えたリクエストを送信すると、本来許可されるべきでないオリジンに対してもレスポンスが返ってくることがわかる。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>HTTP/1.1 204 No Content
</span></span><span class=line><span class=cl>X-Powered-By: Express
</span></span><span class=line><span class=cl>Access-Control-Allow-Origin: http://trap.example.jp
</span></span><span class=line><span class=cl>Vary: Origin, Access-Control-Request-Headers
</span></span><span class=line><span class=cl>Access-Control-Allow-Credentials: true
</span></span><span class=line><span class=cl>Access-Control-Allow-Methods: GET,HEAD,PUT,PATCH,POST,DELETE
</span></span><span class=line><span class=cl>Access-Control-Allow-Headers: content-type
</span></span><span class=line><span class=cl>Access-Control-Max-Age: 300
</span></span><span class=line><span class=cl>Content-Length: 0
</span></span><span class=line><span class=cl>Date: Sat, 19 Jul 2025 01:34:06 GMT
</span></span></code></pre></div><p>悪意のあるドメイン（例: trap.example.jp）からでもAPIが操作可能になる。</p><h3 id=パスワード変更時の現在パスワードチェック不備>パスワード変更時の現在パスワードチェック不備</h3><p>再認証とパスワード変更が別々のAPIに分かれているため、セッションが有効な状態であれば再認証を省略して直接パスワード変更APIを呼び出すことが可能。</p><h3 id=jwtに対するalgnoneの攻撃>JWTに対するalg=noneの攻撃</h3><p>JWTはbase64でエンコードされているjsonなのでデコード可能。
以下のサイトなどでJWTのデコード・エンコードができる。</p><ul><li><a href=https://jwt.io/ja>https://jwt.io/ja</a></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6InFrQTZJVVRXVE1LWXRpbTRGSXFOOFFNY2x3ODd1Tm0yMHU5Nk9rcTh0XzAifQ.eyJzdWIiOjY4LCJ1c2VyaWQiOiJzcGEtdGVzdC0wMzEwIiwiZW1haWwiOiJzcGEtdGVzdC0wMzEwQGdtYWlsLmNvbSIsImljb24iOiJkdW1teS1pY29uLnBuZyIsImlzX3N1cGVyIjowLCJpYXQiOjE3NTI4ODg0NTAsImV4cCI6MTc1Mzc1MjQ1MH0.xGjjwXjql18iSQE2RPQG4qUwqh2y19kY0NjRL7OsWOKYurKmKVLdVfarHf7pA_2_ScFxX4QVfT_dj6Np8M7hM7Tz2LBWuz9OmeD2g2RGlhbWOg0GB5UHik7Dtdx4NYNuZSeIc9WbsQ-MGWNieUKuvMWrw34rs_C5E1SDxn-8LDZ7hnmGd907TtxD4SyJN8z50-fWSqimOS93rHah4GONxfK4erPlndh0qjE_6JgvhiVMkb_qFzG6pi83ETh-rmwOwq97gVc-IRimLmHWOzGaf1S9HXtXbeG6OMkREZI7409CoCYPt2JW5Qp-x4Aq3ulF628iyDgEvJsAV2oiidDs9A
</span></span></code></pre></div><p>デコードされたヘッダー</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>{
</span></span><span class=line><span class=cl>  &#34;typ&#34;: &#34;JWT&#34;,
</span></span><span class=line><span class=cl>  &#34;alg&#34;: &#34;RS256&#34;,
</span></span><span class=line><span class=cl>  &#34;kid&#34;: &#34;qkA6IUTWTMKYtim4FIqN8QMclw87uNm20u96Okq8t_0&#34;
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><p>デコードされたペイロード</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>{
</span></span><span class=line><span class=cl>  &#34;sub&#34;: 68,
</span></span><span class=line><span class=cl>  &#34;userid&#34;: &#34;spa-test-0310&#34;,
</span></span><span class=line><span class=cl>  &#34;email&#34;: &#34;spa-test-0310@gmail.com&#34;,
</span></span><span class=line><span class=cl>  &#34;icon&#34;: &#34;dummy-icon.png&#34;,
</span></span><span class=line><span class=cl>  &#34;is_super&#34;: 0,
</span></span><span class=line><span class=cl>  &#34;iat&#34;: 1752888450,
</span></span><span class=line><span class=cl>  &#34;exp&#34;: 1753752450
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><p>JWTの署名部はバイナリ形式の署名をBase64エンコードしたものであり、JSON形式ではない。そのため、署名が無効または存在しない場合はペイロードの改ざんが容易になる。</p><p>RS256をnoneに書き換える</p><p>攻撃者はalgを"none"に変更し、さらにペイロード内の"sub"を1（管理者）に書き換えることで、不正なトークンを生成する。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>{
</span></span><span class=line><span class=cl>  &#34;typ&#34;: &#34;JWT&#34;,
</span></span><span class=line><span class=cl>  &#34;alg&#34;: &#34;none&#34;,
</span></span><span class=line><span class=cl>  &#34;kid&#34;: &#34;qkA6IUTWTMKYtim4FIqN8QMclw87uNm20u96Okq8t_0&#34;
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>{
</span></span><span class=line><span class=cl>  &#34;sub&#34;: 1,
</span></span><span class=line><span class=cl>  &#34;userid&#34;: &#34;spa-test-0310&#34;,
</span></span><span class=line><span class=cl>  &#34;email&#34;: &#34;spa-test-0310@gmail.com&#34;,
</span></span><span class=line><span class=cl>  &#34;icon&#34;: &#34;dummy-icon.png&#34;,
</span></span><span class=line><span class=cl>  &#34;is_super&#34;: 0,
</span></span><span class=line><span class=cl>  &#34;iat&#34;: 1752888450,
</span></span><span class=line><span class=cl>  &#34;exp&#34;: 1753752450
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><p>再度デコードする</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIiwia2lkIjoicWtBNklVVFdUTUtZdGltNEZJcU44UU1jbHc4N3VObTIwdTk2T2txOHRfMCJ9.eyJzdWIiOjEsInVzZXJpZCI6InNwYS10ZXN0LTAzMTAiLCJlbWFpbCI6InNwYS10ZXN0LTAzMTBAZ21haWwuY29tIiwiaWNvbiI6ImR1bW15LWljb24ucG5nIiwiaXNfc3VwZXIiOjAsImlhdCI6MTc1Mjg4ODQ1MCwiZXhwIjoxNzUzNzUyNDUwfQ.
</span></span></code></pre></div><p>開発者ツール>アプリケーション>Cookieを選択し、Cookieの値を上記で上書きする。</p><p>サーバー側の実装によっては、存在しないkidを指定された場合に署名検証をスキップしてしまう場合があり、結果としてalg=noneかつ署名なしのトークンがそのまま通ってしまうことがある。</p><ul><li><a href=https://qiita.com/ockeghem/items/cc0b8ab74f46834d055b>https://qiita.com/ockeghem/items/cc0b8ab74f46834d055b</a></li></ul><h2 id=オブジェクトレベルの認可不備bola>オブジェクトレベルの認可不備(BOLA)</h2><p>OWASP API Security Top 10の中でも取り上げられているように、APIにおける認可不備は非常に重大な問題とされている。</p><p>パラメータやURL中のID値を別のユーザーのものに変更することで、他人の情報を取得できてしまう。</p><h3 id=オブジェクトプロパティレベルの認可不備>オブジェクトプロパティレベルの認可不備</h3><p>API側でリクエスト内の特定のプロパティに対して適切な認可チェックが行われていない場合、本来変更できないプロパティ（例：<code>userId</code>や<code>role</code>など）を意図的に書き換えることで、管理対象のオブジェクトを不正に操作することが可能になる。</p><h2 id=機能レベルの認可不備blfa>機能レベルの認可不備(BLFA)</h2><p>権限チェックが不十分な場合、一般ユーザーであっても管理者向けのAPI（例：ユーザー削除や設定変更など）を実行できてしまう。</p><h3 id=xss>XSS</h3><p>XSSは一般的に「蓄積型」「反射型」「DOM-Based型」の3つに分類されるが、DOM-Based型も蓄積型・反射型にまたがる特性を持つことがあるため、厳密には分類が重複するケースが存在する。</p><p>XSS攻撃では、改行コードや文字エンコーディングによってサニタイズ処理を回避される可能性があるため、出力処理の設計に注意が必要。
Cookieは盗めなくても、apiを任意に呼び出せるのがXSSの怖さ。</p><h3 id=ssrf>SSRF</h3><p>攻撃者は外部からアクセス可能なサーバーを踏み台にして、社内ネットワークやクラウド環境内の非公開サーバーへリクエストを送信できる。</p><p>SSRFの攻撃対象例：</p><ul><li><code>file:///etc/hosts</code>：ローカルファイルを読み取る試み</li><li><code>http://169.254.169.254/</code>：AWS等のクラウド環境におけるメタデータサービス（IMDS）へのアクセス</li><li><code>http://localhost:NNNN/</code>：アプリケーションが内部で利用しているローカルサービスへのアクセス（NNNNはポート番号）</li></ul><h2 id=バグバウンティ入門-バグハンターへの道のり森岡-優太>「バグバウンティ入門 〜バグハンターへの道のり〜」森岡 優太</h2><p>12:40 - 14:10
写真撮影禁止だったので詳細なハンズオン内容は割愛。</p><p>バグハンターと導入企業の仲介役としてバグバウンティプラットフォームが存在する。</p><h3 id=バグバウンティプラットフォームの例>バグバウンティプラットフォームの例</h3><p>3大バグバウンティプラットフォーム</p><ul><li>hackerone(アメリカ)</li><li>bugcrowd(アメリカ)</li><li>intigity(ベルギー)</li></ul><p>日本のバグバウンティプラットフォーム</p><ul><li>issuehunt(日本)</li></ul><p>プログラムの種類</p><ul><li>BBP：報奨金が支払われるプログラム</li><li>VDP：脆弱性報告窓口として機能するプログラム。報奨金は支払われない。</li></ul><p>よく使われるツールまとめ</p><ul><li><a href=https://www.lopseg.com.br/osint>https://www.lopseg.com.br/osint</a></li><li><a href=https://github.com/vavkamil/awesome-bugbounty-tools>https://github.com/vavkamil/awesome-bugbounty-tools</a></li></ul><h2 id=llm-を活用したソースコードにおける脆弱性の検出蔀-綾人>「LLM を活用したソースコードにおける脆弱性の検出」蔀 綾人</h2><p>16:00-16:45</p><p>静的診断：ASTを用いたコード解析
動的診断：パラメーターのファジング</p><h3 id=llmを用いた脆弱性発見の手法>LLMを用いた脆弱性発見の手法</h3><ol><li>Ajax関数の特定</li><li>Ajaxで呼び出される関数の木構造を作成する</li><li>呼び出される一覧の作成</li><li>LLMによる汚染解析/従来の汚染解析</li><li>結果とPoCの作成</li></ol><h2 id=サイバーセキュリティ概念のバーチャルからリアルへの応用-対ロシア対北朝鮮の脅威への対処法yulii_smirnov>「サイバーセキュリティ概念のバーチャルからリアルへの応用 <del>対ロシア、対北朝鮮の脅威への対処法</del>」Yulii_Smirnov</h2><p>16:45 - 17:30</p><p>バーチャルなサイバー攻撃が、どう現実世界に影響を与えるかに焦点を当てた講演。</p><h3 id=国際電話型の特殊詐欺>国際電話型の特殊詐欺</h3><ul><li>末尾0110の番号で警察署を騙る</li><li>大量の携帯・SIM-BOX・偽基地局などを使い発信元を偽装</li><li>詐欺と通信技術が結びついている</li></ul><h3 id=自動車盗難デバイスgameboycode-grabber>自動車盗難デバイス「GameBoy（Code Grabber）」</h3><ul><li>日本車の中古需要が高いロシアで普及</li><li>リモコンキーの信号をクローンして解錠</li><li>背後にはFSBやSVR関連のフロント企業の関与も</li></ul><h3 id=違法無線と北朝鮮>違法無線と北朝鮮</h3><ul><li>Glocom（マレーシアにある北朝鮮系フロント企業）</li><li>違法無線機器の製造と販売、制裁逃れ</li></ul><h3 id=ロシアのサイバー攻撃の戦略>ロシアのサイバー攻撃の戦略</h3><ul><li>ハイブリッド戦の一環としてサイバー攻撃を活用</li><li>デジタル攻撃は入口、目的はリアル世界への影響</li><li>「マスキロフカ」（偽装戦術）との関連性も</li></ul><h3 id=osint組織の紹介>OSINT組織の紹介</h3><ul><li><a href=https://roles.rcast.u-tokyo.ac.jp>https://roles.rcast.u-tokyo.ac.jp</a></li><li><a href=https://deepdive.or.jp>https://deepdive.or.jp</a></li><li>オープン情報から脅威を検出・分析する取り組み</li></ul></div><div><div>Tags:</div><ul><li><a href=/tags/%E3%82%BB%E3%82%AD%E3%83%A5%E3%83%AA%E3%83%86%E3%82%A3/>セキュリティ</a></li></ul></div><nav aria-label=breadcrumb><ol class=breadcrumb><li class=breadcrumb-item><a href=/>Home</a></li><li class="breadcrumb-item active" aria-current=page>Hackfes2025参加メモ</li></ol></nav></main><footer><p style=text-align:center>Copyright 2025. All rights reserved.</p></footer><link href=https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css rel=stylesheet><link rel=stylesheet href=/css/main.min.cbcf0adf3096d54322591302ca01248346902aa2474afcbd71c3a1b999e09ad9.css integrity="sha256-y88K3zCW1UMiWRMCygEkg0aQKqJHSvy9ccOhuZngmtk=" crossorigin=anonymous><link rel=stylesheet href=/css/syntax.min.aa0332253f313dc48905008b4ab314155e5a13302588d25bcf4949f7c1abdde0.css integrity="sha256-qgMyJT8xPcSJBQCLSrMUFV5aEzAliNJbz0lJ98Gr3eA=" crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js></script><script src=https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.min.js></script><script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]]}}</script></body></html>